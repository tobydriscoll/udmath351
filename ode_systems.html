<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notes for Math 351 @ UD - 6&nbsp; Systems of ODEs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eigen.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ode_systems.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Systems of ODEs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Notes for Math 351 @ UD</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_first_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First-order IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_second_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Second-order linear IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_algebra_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear algebraic systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matrix algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eigen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Eigenvalues</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ode_systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Systems of ODEs</span></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright 2023 by Toby Driscoll</p>
</div></div></nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-systems" id="toc-introduction-to-systems" class="nav-link active" data-scroll-target="#introduction-to-systems"><span class="header-section-number">6.1</span> Introduction to systems</a>
  <ul class="collapse">
  <li><a href="#conversion-of-higher-order-odes" id="toc-conversion-of-higher-order-odes" class="nav-link" data-scroll-target="#conversion-of-higher-order-odes"><span class="header-section-number">6.1.1</span> Conversion of higher-order ODEs</a></li>
  </ul></li>
  <li><a href="#linear-ode-systems" id="toc-linear-ode-systems" class="nav-link" data-scroll-target="#linear-ode-systems"><span class="header-section-number">6.2</span> Linear ODE systems</a></li>
  <li><a href="#general-solutions" id="toc-general-solutions" class="nav-link" data-scroll-target="#general-solutions"><span class="header-section-number">6.3</span> General solutions</a></li>
  <li><a href="#homogeneous-equations" id="toc-homogeneous-equations" class="nav-link" data-scroll-target="#homogeneous-equations"><span class="header-section-number">6.4</span> Homogeneous equations</a>
  <ul class="collapse">
  <li><a href="#fundamental-matrix" id="toc-fundamental-matrix" class="nav-link" data-scroll-target="#fundamental-matrix"><span class="header-section-number">6.4.1</span> Fundamental matrix</a></li>
  <li><a href="#wronskian" id="toc-wronskian" class="nav-link" data-scroll-target="#wronskian"><span class="header-section-number">6.4.2</span> Wronskian</a></li>
  </ul></li>
  <li><a href="#constant-coefficient-problems" id="toc-constant-coefficient-problems" class="nav-link" data-scroll-target="#constant-coefficient-problems"><span class="header-section-number">6.5</span> Constant-coefficient problems</a>
  <ul class="collapse">
  <li><a href="#distinct-real-eigenvalues" id="toc-distinct-real-eigenvalues" class="nav-link" data-scroll-target="#distinct-real-eigenvalues"><span class="header-section-number">6.5.1</span> Distinct real eigenvalues</a></li>
  <li><a href="#repeated-eigenvalue" id="toc-repeated-eigenvalue" class="nav-link" data-scroll-target="#repeated-eigenvalue"><span class="header-section-number">6.5.2</span> Repeated eigenvalue</a></li>
  <li><a href="#complex-eigenvalues" id="toc-complex-eigenvalues" class="nav-link" data-scroll-target="#complex-eigenvalues"><span class="header-section-number">6.5.3</span> Complex eigenvalues</a></li>
  <li><a href="#the-oscillator-reloaded" id="toc-the-oscillator-reloaded" class="nav-link" data-scroll-target="#the-oscillator-reloaded"><span class="header-section-number">6.5.4</span> The oscillator reloaded</a></li>
  </ul></li>
  <li><a href="#stability-and-the-phase-plane" id="toc-stability-and-the-phase-plane" class="nav-link" data-scroll-target="#stability-and-the-phase-plane"><span class="header-section-number">6.6</span> Stability and the phase plane</a>
  <ul class="collapse">
  <li><a href="#stability" id="toc-stability" class="nav-link" data-scroll-target="#stability"><span class="header-section-number">6.6.1</span> Stability</a></li>
  <li><a href="#phase-plane" id="toc-phase-plane" class="nav-link" data-scroll-target="#phase-plane"><span class="header-section-number">6.6.2</span> Phase plane</a></li>
  <li><a href="#tracedeterminant" id="toc-tracedeterminant" class="nav-link" data-scroll-target="#tracedeterminant"><span class="header-section-number">6.6.3</span> Trace/determinant</a></li>
  </ul></li>
  <li><a href="#the-matrix-exponential" id="toc-the-matrix-exponential" class="nav-link" data-scroll-target="#the-matrix-exponential"><span class="header-section-number">6.7</span> The matrix exponential</a>
  <ul class="collapse">
  <li><a href="#diagonalization" id="toc-diagonalization" class="nav-link" data-scroll-target="#diagonalization"><span class="header-section-number">6.7.1</span> Diagonalization</a></li>
  <li><a href="#power-series" id="toc-power-series" class="nav-link" data-scroll-target="#power-series"><span class="header-section-number">6.7.2</span> Power series</a></li>
  <li><a href="#computation" id="toc-computation" class="nav-link" data-scroll-target="#computation"><span class="header-section-number">6.7.3</span> Computation</a></li>
  </ul></li>
  <li><a href="#nonhomogeneous-problem" id="toc-nonhomogeneous-problem" class="nav-link" data-scroll-target="#nonhomogeneous-problem"><span class="header-section-number">6.8</span> Nonhomogeneous problem</a></li>
  <li><a href="#linearization" id="toc-linearization" class="nav-link" data-scroll-target="#linearization"><span class="header-section-number">6.9</span> Linearization</a>
  <ul class="collapse">
  <li><a href="#stability-1" id="toc-stability-1" class="nav-link" data-scroll-target="#stability-1"><span class="header-section-number">6.9.1</span> Stability</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Systems of ODEs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfb}{\mathbf{b}}
    \newcommand{\bfc}{\mathbf{c}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bff}{\mathbf{f}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfB}{\mathbf{B}}
    \newcommand{\bfD}{\mathbf{D}}
    \newcommand{\bfE}{\mathbf{E}}
    \newcommand{\bfP}{\mathbf{P}}
    \newcommand{\bfV}{\mathbf{V}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\fundm}{\boldsymbol{\Phi}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\opA}{\mathcal{A}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\cmn}[2]{\mathbb{C}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diagm}[3]{\begin{bmatrix} #1 &amp; &amp; &amp; \\ &amp; #2 &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; #3 \end{bmatrix}}
    \newcommand{\twovec}[2]{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}
    \newcommand{\threevec}[3]{\begin{bmatrix} #1 \\ #2 \\ #3 \end{bmatrix}}
    \newcommand{\twomat}[4]{\begin{bmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{bmatrix}}
    \newcommand{\twodet}[4]{\begin{vmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{vmatrix}}
    \newcommand{\eye}[1]{\mathbf{e}_#1}
    \newcommand{\meye}{\mathbf{I}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\vec}{\operatorname{vec}}
    \newcommand{\unvec}{\operatorname{unvec}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\rank}{\operatorname{rank}}
    \newcommand{\span}{\operatorname{span}}
    \newcommand{\nullsp}{\operatorname{nullsp}}
    \newcommand{\nullity}{\operatorname{nullity}}
    \newcommand{\rowsp}{\operatorname{rowsp}}
    \newcommand{\colsp}{\operatorname{colsp}}
    % \newcommand{\dimen}{\operatorname{dim}}
    \newcommand{\augmat}[2]{\left[ #1 \;\middle|\; #2 \right]}
\]</span></p>
</div>
<div id="5f1fd818" class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span>, <span class="bu">LinearAlgebra</span>, <span class="bu">Printf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are finally ready to fuse together the two major themes of the course: dynamics and multiple variables.</p>
<section id="introduction-to-systems" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introduction-to-systems"><span class="header-section-number">6.1</span> Introduction to systems</h2>
<p>A <strong>vector-valued ODE</strong> is an equation in the form</p>
<p><span id="eq-intro-vector-ode"><span class="math display">\[
\frac{d \bfx}{dt} = \bff(t,\bfx),
\tag{6.1}\]</span></span></p>
<p>where <span class="math inline">\(\bfx\)</span> is an <span class="math inline">\(n\)</span>-dimensional vector. An equivalent point of view is to write <a href="#eq-intro-vector-ode" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> as a coupled system of scalar ODEs:</p>
<p><span id="eq-intro-system"><span class="math display">\[
\begin{split}
\frac{dx_1}{dt} &amp;= f_1(t,x_1,\ldots,x_n),\\
&amp; \vdots \\
\frac{dx_n}{dt} &amp;= f_n(t,x_1,\ldots,x_n).
\end{split}
\tag{6.2}\]</span></span></p>
<div id="exm-odesys-lorenz" class="theorem example" data-chapter="6" data-description="Lorenz system">
<p><span class="theorem-title"><strong>Example 6.1 </strong></span>A famous system of three ODEs is the <strong>Lorenz system</strong>,</p>
<p><span class="math display">\[
\begin{split}
\dot{x} &amp; = \sigma(y-x), \\
\dot{y} &amp; = \rho x - y - x z, \\
\dot{z} &amp; = -\beta z + x y,
\end{split}
\]</span></p>
<p>where the dots indicate time derivatives and <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\rho\)</span>, and <span class="math inline">\(\beta\)</span> are constant parameters. Conversion to the system notation follows from the definitions <span class="math inline">\(x_1=x\)</span>, <span class="math inline">\(x_2=y\)</span>, and <span class="math inline">\(x_3=z\)</span>, though of course the ordering is arbitrary.</p>
<p>This system is famous for its chaotic behavior and helped inspire the term <em>butterfly effect</em>. The <a href="https://en.wikipedia.org/wiki/Lorenz_system">Wikipedia page</a> has a nice <a href="https://en.wikipedia.org/wiki/File:Lorenz_attractor_in_Julia.gif">animation</a> of a solution.</p>
</div>
<p>To define an initial-value problem, we supplement <a href="#eq-intro-vector-ode" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> with the initial condition</p>
<p><span class="math display">\[
\bfx(0) = \bfx_0.
\]</span></p>
<p>We will shortly be limiting our attention to systems in which the dependence in <a href="#eq-intro-system" class="quarto-xref">Equation&nbsp;<span>6.2</span></a> of each <span class="math inline">\(f_i\)</span> on each <span class="math inline">\(x_j\)</span> is linear. First, though, we mention an important connection between first-order systems and higher-order problems.</p>
<section id="conversion-of-higher-order-odes" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="conversion-of-higher-order-odes"><span class="header-section-number">6.1.1</span> Conversion of higher-order ODEs</h3>
<p>The restriction to first-order ODEs in <a href="#eq-intro-vector-ode" class="quarto-xref">Equation&nbsp;<span>6.1</span></a> actually turns out to be no limitation at all. Any higher-order equation, or system of higher-order equations, can be converted to a first-order system by increasing the dimension.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each order of a derivative beyond the first can be exchanged for a dimension.</p>
</div>
</div>
<div id="exm-intro-pendulum" class="theorem example" data-chapter="6" data-description="Nonlinear pendulum">
<p><span class="theorem-title"><strong>Example 6.2 </strong></span>The nonlinear pendulum equation</p>
<p><span class="math display">\[
\theta'' + \frac{g}{L} \sin(\theta) = f(t)
\]</span></p>
<p>can be transformed by the change of variables <span class="math inline">\(x_1=\theta\)</span>, <span class="math inline">\(x_2=\theta'\)</span> into</p>
<p><span class="math display">\[
\begin{split}
x_1' &amp;= x_2 \\
x_2' &amp;= f(t) - \frac{g}{L}\sin(x_1),    
\end{split}
\]</span></p>
<p>which is of the form <a href="#eq-intro-vector-ode" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>.</p>
</div>
<p>The transformation in <a href="#exm-intro-pendulum" class="quarto-xref">Example&nbsp;<span>6.2</span></a> has the physical interpretation of using position and angular momentum as the dependent unknowns; together these are the <strong>state</strong> of the system. The technique is straightforward to generalize to any problem or system having ODEs of order greater than one. We will encounter just one more significant example.</p>
<div id="exm-odesys-sho" class="theorem example" data-chapter="6" data-description="Simple harmonic oscillator, as system">
<p><span class="theorem-title"><strong>Example 6.3 </strong></span>The simple harmonic oscillator</p>
<p><span class="math display">\[
x'' + 2 \zeta \omega_0 x' + \omega_0^2 x = f(t)
\]</span></p>
<p>can be converted to an equivalent first-order system using the definitions</p>
<p><span class="math display">\[
u_1 = x, \quad u_2 = x'.
\]</span></p>
<p>We can easily derive an ODE for <span class="math inline">\(\bfu\)</span> without reference to <span class="math inline">\(x\)</span>. First, by definition, <span class="math inline">\(u_1'=u_2\)</span>. Next, <span class="math inline">\(u_2' = x''\)</span>, and we can isolate <span class="math inline">\(x''\)</span> in the original equation to get</p>
<p><span class="math display">\[
u_2' = f - 2 \zeta \omega_0 x' - \omega_0^2 x = f - 2 \omega_0\zeta  u_2 - \omega_0^2 u_1.
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
\begin{split}
u_1' &amp;= u_2,\\
u_2' &amp;= f - 2 \omega_0 \zeta  u_2 - \omega_0^2 u_1.
\end{split}
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While every high-order problem can be converted to a first-order system, the converse is not true. That is, there are first-order systems that are not equivalent to any higher-order problem.</p>
</div>
</div>
<!-- The formal procedure is a bit complicated to describe but fully automatic; there are no decisions to make. The key is to *include a component for each of the lower-order derivatives of each variable*, whether or not those terms appear explicitly in the original problem. Everything else flows from these definitions.

::::{#exm-}
Two pendulums hanging from a bar and swinging in parallel planes are coupled through torsion on the bar, obeying

\begin{align*}
\theta_1''+ b\theta_1' + \frac{g}{L}\sin(\theta_1) + \kappa(\theta_1-\theta_2) & = 0 \\
\theta_2''+ b\theta_2' + \frac{g}{L}\sin(\theta_2) + \kappa(\theta_2-\theta_1) & = 0 \\
\end{align*}

Express this as a first-order system.

:::{.solution}
We define 

$$
u_1 = \theta_1, \quad u_2 = \theta_1', \quad u_3 = \theta_2, \quad u_4 = \theta_2'.
$$

Two differential equations, $u_1'=u_2$ and $u_3'=u_4$, follow immediately from these definitions. The remaining two come from substituting into the original ODEs: 

\begin{align*}
    u_2' = \theta_1'' & = - b u_2 - \frac{g}{L}\sin(u_1) - \kappa(u_1-u_3)\\
    u_4' = \theta_2'' & = - b u_4 - \frac{g}{L}\sin(u_3) - \kappa(u_3-u_1)\\
\end{align*}

The result is a four-dimensional, first-order system $\mathbf{u}'=\mathbf{f}(t,\mathbf{u})$.
:::
:::: -->
</section>
</section>
<section id="linear-ode-systems" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="linear-ode-systems"><span class="header-section-number">6.2</span> Linear ODE systems</h2>
<p>Rather than the fully general system <a href="#eq-intro-vector-ode" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>, we will focus on linear problems.</p>
<div id="def-linear-ODE-system" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.1 (Linear system of ODEs) </strong></span>A <strong>linear ODE system</strong> is an equation of the form</p>
<p><span id="eq-structure-vector-linear"><span class="math display">\[
\mathbf{x}'(t) = \mathbf{A}(t)\mathbf{x}(t) + \bff(t),
\tag{6.3}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{x}(t)\)</span> is an <span class="math inline">\(n\)</span>-dimensional vector-valued function, <span class="math inline">\(\mathbf{A}(t)\)</span> is an <span class="math inline">\(n\times n\)</span> <strong>coefficient matrix</strong>, and <span class="math inline">\(\bff(t)\)</span> is an <span class="math inline">\(n\)</span>-dimensional <strong>forcing function</strong>. If the coefficient matrix does not depend on time, the system is said to be <strong>constant-coefficient</strong>.</p>
<p>An <strong>initial condition</strong> for the system is a time <span class="math inline">\(t_0\)</span> and vector <span class="math inline">\(\mathbf{x}_0\)</span> such that <span class="math inline">\(\mathbf{x}(t_0)=\mathbf{x}_0\)</span>.</p>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The matrix in <a href="#eq-structure-vector-linear" class="quarto-xref">Equation&nbsp;<span>6.3</span></a> must be square.</p>
</div>
</div>
<div id="exm-odesys-sho-vector" class="theorem example" data-chapter="6" data-description="Simple harmonic oscillator, vector form">
<p><span class="theorem-title"><strong>Example 6.4 </strong></span>The simple harmonic oscillator system in <a href="#exm-odesys-sho" class="quarto-xref">Example&nbsp;<span>6.3</span></a> is equivalent to</p>
<p><span class="math display">\[
\bfu' = \twomat{0}{1}{-\omega_0^2}{-2 \omega_0 \zeta} \bfu + \twovec{0}{f},
\]</span></p>
<p>where <span class="math inline">\(u_1 = x\)</span>, <span class="math inline">\(u_2 = x'\)</span> is the state vector.</p>
</div>
<div id="exm-intro-twotanks" class="theorem example" data-chapter="6" data-description="Connected tanks">
<p><span class="theorem-title"><strong>Example 6.5 </strong></span>Suppose two connected tanks hold brine. Tank 1 holds 100 L, has an input of 4 L/hr of brine of concentration 3 kg/L, and an output of 6 L/hr. Tank 2 holds 200 L, has an input of 7 L/hr of brine of concentration 5 kg/L, and an output of 5 L/hr. Tank 1 pumps 1 L/hr into tank 2, and tank 2 pumps 3 L/hr into tank 1.</p>
<p>Let <span class="math inline">\(x_i(t)\)</span> be the mass of salt in tank <span class="math inline">\(i\)</span>. The statements above imply</p>
<p><span class="math display">\[
\begin{split}
\dd{x_1}{t} &amp; = 4\cdot 3 - 6\cdot \frac{x_1}{100} - 1\cdot \frac{x_1}{100} + 3 \cdot \frac{x_2}{200}  \\
\dd{x_2}{t} &amp; = 7\cdot 5 - 5\cdot \frac{x_2}{200} - 3\cdot \frac{x_2}{200} +  1\cdot \frac{x_1}{100}\\
\end{split}.
\]</span></p>
<p>This is neatly expressed using linear algebra:</p>
<p><span class="math display">\[
\dd{}{t} \twovec{x_1}{x_2} = \frac{1}{200}\twomat{-14}{3}{2}{-8} \twovec{x_1}{x_2} + \twovec{12}{35}.
\]</span></p>
</div>
<div id="exm-intro-heating" class="theorem example" data-chapter="6" data-description="Heating a house">
<p><span class="theorem-title"><strong>Example 6.6 </strong></span>Here is a basic model for heating in a house. Let <span class="math inline">\(b(t)\)</span> be the temperature of the basement, <span class="math inline">\(m(t)\)</span> be the temperature of the main living area, and <span class="math inline">\(a(t)\)</span> be the temperature of the attic. Suppose the ground is at a constant 10 degrees C. We use a Newtonian model to describe how the temperature of the basement evolves due to interactions with the earth and the main floor:</p>
<p><span class="math display">\[
\frac{db}{dt} = -k_b (b - 10) - k_{mb} (b-m).
\]</span></p>
<p>Similarly, the attic interacts with the air, which we will hold at 2 degrees, and the main floor:</p>
<p><span class="math display">\[
\frac{da}{dt} = -k_a (a - 2) - k_{ma} (a-m).
\]</span></p>
<p>Finally, suppose the main area interacts mostly with the other levels and experiences input from a heater:</p>
<p><span class="math display">\[
\frac{dm}{dt} = -k_{mb} (m - b) - k_{ma} (m - a) + h(t).
\]</span></p>
<p>To write the system in vector form, we define <span class="math inline">\(x_1=b\)</span>, <span class="math inline">\(x_2=m\)</span>, and <span class="math inline">\(x_3=a\)</span>. Then</p>
<p><span class="math display">\[
\frac{d\bfx}{dt} = \threevec{(-k_b - k_{mb}) x_1  +k_{mb} x_2}{ k_{mb}x_1 -(k_{mb}+k_{ma})x_2 + k_{ma}x_3}{k_{ma}x_2  -(k_{ma}+k_a)x_3} + \threevec{10k_b}{h(t)}{2k_a}.
\]</span></p>
<p>Observe that on the right side, the terms depending on <span class="math inline">\(\bfx\)</span> have been separated from the others. Hence</p>
<p><span class="math display">\[
\bfx' = \begin{bmatrix} -k_b-k_{mb} &amp; k_{mb} &amp; 0 \\ k_{mb} &amp; -k_{mb}-k_{ma} &amp; k_{ma} \\  0 &amp; k_{ma} &amp; -k_{ma}-k_a \end{bmatrix}  \bfx + \threevec{10k_b}{h(t)}{2k_a}.
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You need to read and write carefully when in vector-land. In particular, note that <span class="math inline">\(\mathbf{x}_1\)</span> refers to the first vector of a collection, while <span class="math inline">\(x_1\)</span> means the first component of a vector <span class="math inline">\(\mathbf{x}\)</span>.</p>
</div>
</div>
</section>
<section id="general-solutions" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="general-solutions"><span class="header-section-number">6.3</span> General solutions</h2>
<p>Virtually all of the theoretical statements we made about the scalar linear problem <span class="math inline">\(x'=a(t)x+f(t)\)</span> can be remade with boldface/capital letters for the linear system <span class="math inline">\(\mathbf{x}'=\mathbf{A}(t)\mathbf{x}+\bff(t)\)</span>. Those statements relied mainly on linearity. Most notably:</p>
<div id="thm-intro-general-system" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.1 (General solution of ODE linear system) </strong></span>Every solution of</p>
<p><span class="math display">\[
\mathbf{x}'=\mathbf{A}(t)\mathbf{x}+\bff(t)
\]</span></p>
<p>can be written in the form</p>
<p><span class="math display">\[
\mathbf{x}=\mathbf{x}_h+\mathbf{x}_p,
\]</span></p>
<p>where <span class="math inline">\(\mathbf{x}_h\)</span> is the general solution of <span class="math inline">\(\mathbf{x}'=\mathbf{A}(t)\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{x}_p\)</span> is any solution of <span class="math inline">\(\mathbf{x}'=\mathbf{A}(t)\mathbf{x}+\bff(t)\)</span>.</p>
</div>
<p>Once again, then, we look first at the homogeneous system with no forcing term.</p>
</section>
<section id="homogeneous-equations" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="homogeneous-equations"><span class="header-section-number">6.4</span> Homogeneous equations</h2>
<p>Given <span id="eq-structure-homog"><span class="math display">\[
\mathbf{x}' = \mathbf{A}(t)\mathbf{x},
\tag{6.4}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{x}\in\mathbb{R}^{n}\)</span> and <span class="math inline">\(\mathbf{A}\in\mathbb{R}^{n\times n}\)</span>, we can easily show in the usual way that any linear combination of solutions is also a solution. In fact, we have a new way of stating this result.</p>
<div id="def-structure-space" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.2 (Solution space) </strong></span>The set of all solutions of a homogeneous equation <span class="math inline">\(\mathbf{x}' = \mathbf{A}(t)\mathbf{x}\)</span> is a subspace of vector-valued functions called the <strong>solution space</strong>.</p>
</div>
<p>Our first major goal is to find a basis for the solution space.</p>
<section id="fundamental-matrix" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="fundamental-matrix"><span class="header-section-number">6.4.1</span> Fundamental matrix</h3>
<p>Suppose <span class="math inline">\(\mathbf{x}_1,\ldots,\mathbf{x}_m\)</span> are homogeneous solutions of <a href="#eq-structure-homog" class="quarto-xref">Equation&nbsp;<span>6.4</span></a>, and that we use a linear combination of them to satisfy an initial condition <span class="math inline">\(\mathbf{x}(0)=\mathbf{x}_0\)</span>:</p>
<p><span class="math display">\[
    c_1 \mathbf{x}_1(0) + \cdots + c_m \mathbf{x}_m(0) = \mathbf{x}_0.
\]</span></p>
<p>Using the equivalence of linear combination with matrix-vector multiplication, we define the <span class="math inline">\(n\times m\)</span> matrix</p>
<p><span id="eq-structure-fundamental"><span class="math display">\[
\fundm(t) = \bigl[ \mathbf{x}_1(t) \; \mathbf{x}_2(t) \; \cdots \; \mathbf{x}_m(t)  \bigr],
\tag{6.5}\]</span></span></p>
<p>so that</p>
<p><span id="eq-structure-fundamental-init"><span class="math display">\[
\fundm(0) \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_m \end{bmatrix} = \mathbf{x}_0.
\tag{6.6}\]</span></span></p>
<p>This is a linear algebraic system for the coefficients <span class="math inline">\(c_i\)</span>. We can expect a unique solution if and only if <span class="math inline">\(m=n\)</span> and <span class="math inline">\(\bfX(0)\)</span> is invertible.</p>
<div id="def-structure-fundamental" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.3 (Fundamental matrix) </strong></span>The <span class="math inline">\(n\times n\)</span> matrix <span class="math inline">\(\fundm(t)\)</span> is a <strong>fundamental matrix</strong> of the homogeneous system <span class="math inline">\(\mathbf{x}' = \mathbf{A}(t)\mathbf{x}\)</span> if its columns satisfy</p>
<p><span id="eq-structure-columns"><span class="math display">\[
\mathbf{x}_j'=\mathbf{A}\mathbf{x}_j, \quad j=1,\ldots,n,
\tag{6.7}\]</span></span></p>
<p>and <span class="math inline">\(\fundm(t)\)</span> is invertible at all times in an open interval <span class="math inline">\(I\)</span> where <span class="math inline">\(\bfA\)</span> is continuous. In this situation, we refer to the columns of <span class="math inline">\(\fundm\)</span> as a <strong>fundamental set of solutions</strong>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because <a href="#def-structure-fundamental" class="quarto-xref">Definition&nbsp;<span>6.3</span></a> says nothing about an initial condition, a homogeneous ODE has infinitely many fundamental matrices.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>A condition equivalent to <a href="#eq-structure-columns" class="quarto-xref">Equation&nbsp;<span>6.7</span></a> is that <span class="math inline">\(\fundm\)</span> satisfies the matrix ODE</p>
<p><span class="math display">\[
\fundm'=\bfA\fundm.
\]</span></p>
</div>
</div>
</section>
<section id="wronskian" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="wronskian"><span class="header-section-number">6.4.2</span> Wronskian</h3>
<p>Since invertibility is required for a fundamental matrix, we should not be surprised to see its determinant popping up.</p>
<div id="def-structure-wronskian" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.4 (Wronskian) </strong></span>Let <span class="math inline">\(\mathbf{x}_1,\ldots,\mathbf{x}_n\)</span> be a collection of vector-valued functions where each <span class="math inline">\(\bfx_i\)</span> is <span class="math inline">\(n\)</span>-dimensional. Their <strong>Wronskian</strong> is a function of <span class="math inline">\(t\)</span> defined by</p>
<p><span class="math display">\[
W(\bfx_1,\ldots,\bfx_n) = \det\Bigl( \bigl[ \mathbf{x}_1(t) \: \cdots \: \mathbf{x}_n(t)  \bigr] \Bigr).
\]</span></p>
</div>
<div id="thm-structure-wronskian" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.2 </strong></span>Suppose that <span class="math inline">\(\mathbf{x}_1,\ldots,\mathbf{x}_n\)</span> are solutions of <a href="#eq-structure-homog" class="quarto-xref">Equation&nbsp;<span>6.4</span></a>, and <span class="math inline">\(I\)</span> is an interval where <span class="math inline">\(\bfA(t)\)</span> is continuous. The following are equivalent statements:</p>
<ol type="1">
<li><span class="math inline">\(\mathbf{x}_1,\ldots,\mathbf{x}_n\)</span> are linearly independent in <span class="math inline">\(I\)</span>.</li>
<li><span class="math inline">\(\mathbf{x}_1,\ldots,\mathbf{x}_n\)</span> are a fundamental set of solutions.</li>
<li>The Wronksian <span class="math inline">\(W(\mathbf{x}_1,\ldots,\mathbf{x}_n)\)</span> is nonzero at all <span class="math inline">\(t\in I\)</span>.</li>
</ol>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The third item in <a href="#thm-structure-wronskian" class="quarto-xref">Theorem&nbsp;<span>6.2</span></a> is the most interesting. It implies that the Wronskian is either always zero or never zero, so it’s sufficient to check the Wronskian at any single value of <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<div id="exm-odesys-wronskian" class="theorem example" data-chapter="6" data-description="Wronskian of an ODE system">
<p><span class="theorem-title"><strong>Example 6.7 </strong></span>Given the two solutions</p>
<p><span class="math display">\[
\mathbf{x}_1(t)=e^{2 t}\twovec{3}{-1}, \quad \mathbf{x}_2(t)=e^{-3 t}\twovec{2}{2},
\]</span></p>
<p>show that they are fundamental.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We calculate</p>
<p><span class="math display">\[
W(\bfx_1,\ldots,\bfx_n) = \det\bigl(\bigl[ \bfx_1 \: \bfx_2\bigr]\bigr) = \twodet{3 e^{2 t}}{2 e^{-3 t}}{-e^{2 t}}{2 e^{-3 t}} = 8 e^{-t}.
\]</span></p>
<p>The exponential function is never zero, so we know the Wronskian is never zero. Hence the two solutions are fundamental.</p>
<p>We could have made the process even easier by first setting <span class="math inline">\(t=0\)</span> in both solutions. Then we would have</p>
<p><span class="math display">\[
W(\bfx_1,\ldots,\bfx_n; t=0) = \twodet{3}{2}{-1}{2} = 8.
\]</span></p>
<p>Say <span class="math inline">\(\mathbf{v}_1=[a,\,c]\)</span> and <span class="math inline">\(\mathbf{v}_2=[b,\,d]\)</span>. Then</p>
</div>
</div>
<p>A fundamental matrix gives everything we need to construct the general homogeneous solution.</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.3 </strong></span>If <span class="math inline">\(\fundm\)</span> is a fundamental matrix for <span class="math inline">\(\bfx'=\bfA(t)\bfx\)</span>, then the general solution of this system is</p>
<p><span class="math display">\[
\bfx_h = \mathbf{x}(t)=\fundm(t)\mathbf{c},
\]</span></p>
<p>for an arbitrary constant vector <span class="math inline">\(\mathbf{c}\)</span>.</p>
</div>
<div id="exm-odesys-fundamental" class="theorem example" data-chapter="6" data-description="Fundamental matrix from solutions">
<p><span class="theorem-title"><strong>Example 6.8 </strong></span>Given that the following are solutions of <span class="math inline">\(\bfx' = \bfA \bfx\)</span> over <span class="math inline">\((-\infty, \infty)\)</span>:</p>
<p><span class="math display">\[
\bfx_1 = \threevec{2}{-1}{0} + t \threevec{1}{3}{1}, \quad \bfx_2 = \threevec{0}{1}{2},  \quad \bfx_3 = \threevec{0}{0}{-3} + t \threevec{1}{1}{2},
\]</span></p>
<p>find a general solution of the homogeneous system.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We first want to show that these solutions are fundamental. Setting <span class="math inline">\(t=0\)</span>, the Wronskian is</p>
<p><span class="math display">\[
\begin{vmatrix}
2 &amp; 0 &amp; 0 \\
-1 &amp; 1 &amp; 0 \\
0 &amp; 2 &amp; -3
\end{vmatrix} = -6.
\]</span></p>
<p>Hence we have the fundamental matrix</p>
<p><span class="math display">\[
\fundm(t) = \begin{bmatrix} 2+t &amp; 0 &amp; t \\ -1+3t &amp; 1 &amp; t \\ t &amp; 2 &amp; -3+2t \end{bmatrix},
\]</span></p>
<p>and the general solution is <span class="math inline">\(\bfx = \fundm(t) \mathbf{c}\)</span> for an arbitrary constant vector <span class="math inline">\(\mathbf{c}\)</span>.</p>
</div>
</div>
</section>
</section>
<section id="constant-coefficient-problems" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="constant-coefficient-problems"><span class="header-section-number">6.5</span> Constant-coefficient problems</h2>
<p>While the theory of homogeneous linear ODE systems is a fairly painless extension of our scalar adventures, the good news for the general case pretty much ends there. But there is a very important special case in which we can say a lot more: when the coefficient matrix is constant. So we home in on the homogeneous, constant-coefficient problem</p>
<p><span id="eq-system-constcoeff"><span class="math display">\[
\bfx' = \bfA \bfx,
\tag{6.8}\]</span></span></p>
<p>where <span class="math inline">\(\bfA\)</span> is an <span class="math inline">\(n\times n\)</span> <em>constant</em> matrix.</p>
<p>We are finally ready to see one major benefit of eigenvalues. Suppose that</p>
<p><span class="math display">\[
\mathbf{A} \mathbf{v} = \lambda \mathbf{v}.
\]</span></p>
<p>Let’s define</p>
<p><span id="eq-system-eigvec-solution"><span class="math display">\[
\bfx(t) = e^{\lambda t} \bfv.
\tag{6.9}\]</span></span></p>
<p>We find that</p>
<p><span class="math display">\[
\bfx'(t) = \lambda e^{\lambda t} \bfv = e^{\lambda t} (\lambda \bfv) = e^{\lambda t} (\bfA \bfv)  = \bfA (e^{\lambda t} \bfv).
\]</span></p>
<p>That is:</p>
<div id="thm-odesys-eigvec-solution" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.4 </strong></span>If <span class="math inline">\(\mathbf{A} \mathbf{v} = \lambda \mathbf{v}\)</span>, then <a href="#eq-system-eigvec-solution" class="quarto-xref">Equation&nbsp;<span>6.9</span></a> is a solution of <a href="#eq-system-constcoeff" class="quarto-xref">Equation&nbsp;<span>6.8</span></a>.</p>
</div>
<section id="distinct-real-eigenvalues" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="distinct-real-eigenvalues"><span class="header-section-number">6.5.1</span> Distinct real eigenvalues</h3>
<p>Counting algebraic multiplicities, we know that <span class="math inline">\(\mathbf{A}\)</span> has eigenvalues <span class="math inline">\(\lambda_1,\ldots,\lambda_n\)</span>. Say that we have eigenvectors <span class="math inline">\(\mathbf{v}_1,\ldots,\mathbf{v}_n\)</span> to go with them. Then we have <span class="math inline">\(n\)</span> homogeneous solutions</p>
<p><span class="math display">\[
\mathbf{x}_j(t) = e^{t \lambda_j} \mathbf{v}_j, \quad j=1,\ldots,n.
\]</span></p>
<p>Our next move is to determine whether</p>
<p><span class="math display">\[
\bigl[ \mathbf{x}_1(t) \; \mathbf{x}_2(t) \; \cdots \; \mathbf{x}_n(t)  \bigr]
\]</span></p>
<p>is a fundamental matrix. According to <a href="#thm-structure-wronskian" class="quarto-xref">Theorem&nbsp;<span>6.2</span></a>, we can ask that question at any value of <span class="math inline">\(t\)</span>, including <span class="math inline">\(t=0\)</span>. So the key issue is whether</p>
<p><span id="eq-eigenmat"><span class="math display">\[
\bfV = \bigl[ \mathbf{v}_1 \; \mathbf{v}_2 \; \cdots \; \mathbf{v}_n  \bigr]
\tag{6.10}\]</span></span></p>
<p>is invertible. If so, then we have the ingredients of the general homogeneous solution. But we have already named that situation as diagonalizability.</p>
<div id="thm-cc-eigensolution" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.5 (Solution by eigenvectors) </strong></span>Let <span class="math inline">\(\mathbf{A}\)</span> have eigenvalues <span class="math inline">\(\lambda_1,\ldots,\lambda_n\)</span> and corresponding eigenvectors <span class="math inline">\(\mathbf{v}_1,\ldots,\mathbf{v}_n\)</span>. If <span class="math inline">\(\bfA\)</span> is diagonalizable, then</p>
<p><span id="eq-fs-eq-eigenfundamental"><span class="math display">\[
\fundm(t) = \begin{bmatrix}
e^{t \lambda_1} \mathbf{v}_1 &amp; \cdots &amp; e^{t \lambda_n} \mathbf{v}_n
\end{bmatrix}
\tag{6.11}\]</span></span></p>
<p>is a fundamental matrix for <span class="math inline">\(\mathbf{x}'=\mathbf{A}\mathbf{x}\)</span>, and the general solution can be expressed as</p>
<p><span id="eq-cc-eigengeneral"><span class="math display">\[
\mathbf{x}(t) = \fundm(t)\mathbf{c} = c_1 e^{t \lambda_1} \mathbf{v}_1 + \cdots + c_n e^{t \lambda_n} \mathbf{v}_n.
\tag{6.12}\]</span></span></p>
<p>In particular, <a href="#eq-fs-eq-eigenfundamental" class="quarto-xref">Equation&nbsp;<span>6.11</span></a> and <a href="#eq-cc-eigengeneral" class="quarto-xref">Equation&nbsp;<span>6.12</span></a> hold if the eigenvalues of <span class="math inline">\(\bfA\)</span> are distinct (i. e., all of them are simple).</p>
</div>
<div id="exm-odesys-eigen-real" class="theorem example" data-chapter="6" data-description="ODE system with real eigenvalues">
<p><span class="theorem-title"><strong>Example 6.9 </strong></span>Given that</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 1 &amp; 1 \\ 4 &amp; 1 \end{bmatrix}
\]</span></p>
<p>has eigenpairs</p>
<p><span class="math display">\[
\lambda_1=3,\: \mathbf{v}_1 = \twovec{1}{2}, \quad \lambda_2=-1,\: \mathbf{v}_2=\twovec{1}{-2},
\]</span></p>
<p>find the general solution of <span class="math inline">\(\bfx'=\bfA\bfx\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>With the eigenvalues and eigenvectors provided, the general solution is formulaic:</p>
<p><span class="math display">\[
\mathbf{x}(t) =  c_1 e^{3t} \twovec{1}{2} + c_2 e^{-t} \twovec{1}{-2}
= \twovec{ c_1 e^{3t} + c_2 e^{-t}}{2c_1 e^{3t} - 2 c_2e^{-t}}.
\]</span></p>
<p>(For the record, the determinant of</p>
<p><span class="math display">\[
\bfV = \twomat{1}{1}{2}{-2}
\]</span></p>
<p>is <span class="math inline">\(-4\)</span>, so this matrix is not singular, as guaranteed by <a href="#thm-cc-eigensolution" class="quarto-xref">Theorem&nbsp;<span>6.5</span></a>.)</p>
</div>
</div>
</section>
<section id="repeated-eigenvalue" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="repeated-eigenvalue"><span class="header-section-number">6.5.2</span> Repeated eigenvalue</h3>
<p>If <span class="math inline">\(\bfA\)</span> has a repeated nondefective eigenvalue, then we can still use <a href="#thm-cc-eigensolution" class="quarto-xref">Theorem&nbsp;<span>6.5</span></a>.</p>
<p>If the matrix <span class="math inline">\(\bfA\)</span> is not diagonalizable, though, we can’t use the eigenvectors alone to find a fundamental matrix. There is a fairly straightforward workaround, although it’s painful to do by hand for more than a double eigenvalue.</p>
<p>Suppose <span class="math inline">\(\lambda\)</span> has algebraic multiplicity 2, eigenvector <span class="math inline">\(\bfv\)</span>, and geometric multiplicity 1. One solution is again</p>
<p><span class="math display">\[
\bfx_1 = e^{\lambda t}\, \bfv .
\]</span></p>
<p>It turns out that there is a second solution of the form</p>
<p><span id="eq-odesys-defective-solution"><span class="math display">\[
\bfx_2 = t e^{ \lambda t}\, \bfv + e^{\lambda t}\, \bfw,
\tag{6.13}\]</span></span></p>
<p>where <span class="math inline">\(\bfw\)</span> is a constant vector to be determined. Then</p>
<p><span class="math display">\[
\bfx_2' = (e^{\lambda t} + \lambda t e^{\lambda t})\,  \bfv + \lambda e^{\lambda t}\, \bfw,
\]</span></p>
<p>and, since <span class="math inline">\(\bfv\)</span> is an eigenvector,</p>
<p><span class="math display">\[
\bfA \bfx_2 = t e^{\lambda t} (\lambda \bfv) + e^{\lambda t} \bfA \bfw.
\]</span></p>
<p>We get <span class="math inline">\(\bfx_2\)</span> to be a solution by making these last two lines equal each other, i. .e,</p>
<p><span class="math display">\[
e^{\lambda t}\, \bfv + \lambda t e^{\lambda t}\,\bfv + \lambda e^{\lambda t}\, \bfw = t e^{\lambda t} (\lambda \bfv) + e^{\lambda t}\, \bfA \bfw
\]</span></p>
<p>After cancelling some things, this boils down to just</p>
<p><span id="eq-generalized-eigenvector"><span class="math display">\[
(\bfA - \lambda \meye) \bfw = \bfv,
\tag{6.14}\]</span></span></p>
<p>which is just a linear system to solve for <span class="math inline">\(\bfw\)</span>!</p>
<div id="exm-odesys-eigen-defective" class="theorem example" data-chapter="6" data-description="ODE system with defective matrix">
<p><span class="theorem-title"><strong>Example 6.10 </strong></span>The matrix</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} -2 &amp; 1 \\ 0 &amp; -2 \end{bmatrix}
\]</span></p>
<p>has the single eigenvalue <span class="math inline">\(\lambda_1=-2\)</span> with eigenspace spanned by <span class="math inline">\(\mathbf{v}_1=[1,\,0]\)</span>. Find the general solution of <span class="math inline">\(\bfx'=\bfA\bfx\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>One solution is</p>
<p><span class="math display">\[
\bfx_1 = e^{-2t} \twovec{1}{0}.
\]</span></p>
<p>We can find a second solution by solving <a href="#eq-generalized-eigenvector" class="quarto-xref">Equation&nbsp;<span>6.14</span></a> with <span class="math inline">\(\lambda=-2\)</span>:</p>
<p><span class="math display">\[
\twomat{0}{1}{0}{0} \bfw = \twovec{1}{0}.
\]</span></p>
<p>The solution is <span class="math inline">\(\bfw=\twovec{0}{1}\)</span>. Then we use <a href="#eq-odesys-defective-solution" class="quarto-xref">Equation&nbsp;<span>6.13</span></a> to get a second solution,</p>
<p><span class="math display">\[
\bfx_2 = t e^{-2t} \twovec{1}{0} + e^{-2t} \twovec{0}{1} = \twovec{t e^{-2t}}{e^{-2t}}.
\]</span></p>
<p>Hence, a fundamental matrix is</p>
<p><span class="math display">\[
\fundm(t) = \twomat{e^{-2t}}{t e^{-2t}}{0}{e^{-2t}},
\]</span></p>
<p>and the general solution is <span class="math inline">\(\bfx(t) = \fundm(t) \mathbf{c}\)</span> for an arbitrary constant vector <span class="math inline">\(\mathbf{c}\)</span>.</p>
</div>
</div>
</section>
<section id="complex-eigenvalues" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="complex-eigenvalues"><span class="header-section-number">6.5.3</span> Complex eigenvalues</h3>
<p><a href="#thm-cc-eigensolution" class="quarto-xref">Theorem&nbsp;<span>6.5</span></a> works fine if the eigenvalues and eigenvectors are complex. However, a purely real-number alternative form is also available.</p>
<p>Suppose that</p>
<p><span class="math display">\[
\lambda = r + i\omega, \qquad \bfv = \bfu_1 + i\, \bfu_2.
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
e^{\lambda t} \bfv = e^{rt} (\cos(\omega t) + i\sin(\omega t) )\, (\bfu_1 + i\, \bfu_2).
\]</span></p>
<p>The real and imaginary parts of the above product form the basis of the real solution. Specifically,</p>
<p><span id="eq-sys-complex-real-form"><span class="math display">\[
\bfx(t) = a_1 e^{rt} \Bigl( \cos(\omega t)\,\bfu_1 - \sin(\omega t) \,\bfu_2(t) \Bigr) + a_2 e^{rt} \Bigl( \cos(\omega t)\,\bfu_2 + \sin(\omega t) \,\bfu_1(t) \Bigr),
\tag{6.15}\]</span></span></p>
<p>for arbitrary real <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_2\)</span>. However, it may be easier to simply apply Euler’s formula for complex exponentials, as shown in the next example, than to apply <a href="#eq-sys-complex-real-form" class="quarto-xref">Equation&nbsp;<span>6.15</span></a>.</p>
<div id="exm-odesys-eigen-complex" class="theorem example" data-chapter="6" data-description="ODE system with complex eigenvalues">
<p><span class="theorem-title"><strong>Example 6.11 </strong></span>Find the general solution of</p>
<p><span class="math display">\[
\bfx' = \twomat{1}{1}{-1}{1} \bfx.
\]</span></p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The eigenvalues are <span class="math inline">\(1\pm i\)</span> with corresponding eigenvectors <span class="math inline">\(\twovec{1}{i}\)</span> and <span class="math inline">\(\twovec{1}{-i}\)</span>. This leads to the solution</p>
<p><span class="math display">\[
\bfx(t) = c_1 e^{(1+i)t} \twovec{1}{i} + c_2 e^{(1-i)t} \twovec{1}{-i}.
\]</span></p>
<p>This is valid, but possibly inconvenient. If we started with real initial conditions, the solution should remain real at all times.</p>
<p>We can use Euler’s formula to write out one of the terms above:</p>
<p><span class="math display">\[
e^{(1+i)t} \twovec{1}{i} = e^t \twovec{\cos t + i \sin t}{i\cos t - \sin t}
= e^t \twovec{\cos t}{-\sin t} + i\, e^t \twovec{\sin t}{\cos t}.
\]</span></p>
<p>Then, we can use the real and imaginary parts of the last line as independent real solutions. Thus,</p>
<p><span class="math display">\[
\bfx(t) = a_1 e^t \twovec{\cos t}{-\sin t} + a_2 e^t \twovec{\sin t}{\cos t}
\]</span></p>
<p>for arbitrary real <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_2\)</span>.</p>
</div>
</div>
</section>
<section id="the-oscillator-reloaded" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="the-oscillator-reloaded"><span class="header-section-number">6.5.4</span> The oscillator reloaded</h3>
<p>Earlier we showed that the harmonic oscillator</p>
<p><span class="math display">\[
x'' + 2 Z \omega_0 x' + \omega_0^2 x = 0
\]</span></p>
<p>can be converted to the constant-coefficient system</p>
<p><span class="math display">\[
\bfu' = \twomat{0}{1}{-\omega_0^2}{-2Z\omega_0} \bfu.
\]</span></p>
<p>via <span class="math inline">\(u_1=x\)</span>, <span class="math inline">\(u_2=x'\)</span>. The eigenvalues of the coefficient matrix are the roots of the characteristic polynomial</p>
<p><span class="math display">\[
\twodet{-z}{1}{-\omega_0^2}{-2 \zeta \omega_0-z} = z^2 + 2 \zeta \omega_0 z + \omega_0^2.
\]</span></p>
<p>This is identical to what we called the characteristic polynomial of the oscillator ODE!</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The characteristic values of the simple harmonic oscillator are the eigenvalues of the coefficient matrix of the equivalent first-order system.</p>
</div>
</div>
<p>In the underdamped case <span class="math inline">\(\zeta &lt; 1\)</span>, for instance, the eigenvalues are complex: <span class="math inline">\(\lambda = -\zeta \omega_0 \pm i \omega_d\)</span>, where <span class="math inline">\(\omega_d=\omega_0 \sqrt{1-\zeta^2}\)</span>. The first eigenvalue <span class="math inline">\(\lambda_1\)</span> has eigenvector</p>
<p><span class="math display">\[
\twovec{1}{\lambda_1}.
\]</span></p>
<p>If we want the general solution of just the original <span class="math inline">\(x\)</span> variable, then we only need the first component of the eigenvector, and the general solution combines the real and imaginary parts of <span class="math inline">\(e^{\lambda_1 t}\)</span>:</p>
<p><span class="math display">\[
x(t) = u_1(t) = a_1 e^{-\zeta \omega_0t} \cos(\omega_d t) + a_2 e^{-\zeta \omega_0t} \sin(\omega_d t).
\]</span></p>
<p>It’s worth repeating: the second-order problem is fully covered by the equivalent first-order system.</p>
</section>
</section>
<section id="stability-and-the-phase-plane" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="stability-and-the-phase-plane"><span class="header-section-number">6.6</span> Stability and the phase plane</h2>
<div id="def-system-equilibrium" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.5 </strong></span>Any constant solution of the homogeneous system <span class="math inline">\(\mathbf{x}'=\mathbf{A}\mathbf{x}\)</span> is an <strong>equilibrium solution</strong> or steady-state solution.</p>
</div>
<p>Clearly, <span class="math inline">\(\mathbf{x}(t)\equiv \bfzero\)</span> is always an equilibrium solution.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(\mathbf{A}\)</span> is singular, then there are nonzero equilibrium solutions of the homogeneous system <span class="math inline">\(\mathbf{x}'=\mathbf{A}\mathbf{x}\)</span> as well, but we will not pursue those.</p>
</div>
</div>
<section id="stability" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="stability"><span class="header-section-number">6.6.1</span> Stability</h3>
<p>Just as with scalar first-order ODEs, stability is a crucial property of an equilibrium solution. Suppose we start <span class="math inline">\(\mathbf{x}'=\mathbf{A}\mathbf{x}\)</span> at infinitesimally small initial conditions. If the state always approaches zero as <span class="math inline">\(t\to\infty\)</span>, we say that the equilibrium at zero is <strong>asymptotically stable</strong>. This is what happens, for instance, to a damped linear oscillator. If, on the other hand, the system has infinitesimal initial states that grow without bound, then the equilibrium is <strong>unstable</strong>.</p>
<p>The stability properties depend on the eigenvalues of <span class="math inline">\(\mathbf{A}\)</span>. This is most easily summarized in the special case of a <span class="math inline">\(2\times 2\)</span> real matrix with eigenvalues <span class="math inline">\(\lambda_1,\lambda_2\)</span>. The major cases to be considered, leaving out some pesky edge cases, are summarized in <a href="#tbl-phase_plane-stability" class="quarto-xref">Table&nbsp;<span>6.1</span></a>. (The third column of that table is to be explained next.)</p>
<div id="tbl-phase_plane-stability" class="anchored">
<table class="table">
<caption>Table&nbsp;6.1: Eigenvalues and stability</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Eigenvalues</th>
<th style="text-align: center;">Stability</th>
<th style="text-align: center;">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\lambda_1 &lt; \lambda_2 &lt; 0\)</span></td>
<td style="text-align: center;">asymptotically stable</td>
<td style="text-align: center;">node</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda_1 &lt; 0 &lt; \lambda_2\)</span></td>
<td style="text-align: center;">unstable</td>
<td style="text-align: center;">saddle</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(0 &lt; \lambda_1 &lt; \lambda_2\)</span></td>
<td style="text-align: center;">unstable</td>
<td style="text-align: center;">node</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda = r\pm i \omega,\: r&lt; 0\)</span></td>
<td style="text-align: center;">asymptotically stable</td>
<td style="text-align: center;">spiral</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\lambda = \pm i \omega\)</span></td>
<td style="text-align: center;">stable, not asymptotically stable</td>
<td style="text-align: center;">center</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\lambda = r\pm i \omega,\: r&gt; 0\)</span></td>
<td style="text-align: center;">unstable</td>
<td style="text-align: center;">spiral</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="phase-plane" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="phase-plane"><span class="header-section-number">6.6.2</span> Phase plane</h3>
<p>In the two-dimensional case, the solutions of <span class="math inline">\(\mathbf{x}'=\mathbf{A}\mathbf{x}\)</span> can be plotted as trajectories parameterized by time in the <span class="math inline">\((x_1,x_2)\)</span> plane, often called the <strong>phase plane</strong>. Each of the cases in <a href="#tbl-phase_plane-stability" class="quarto-xref">Table&nbsp;<span>6.1</span></a> has a characteristic type of phase plane portrait that illustrates major aspects of solution behaviors.</p>
<section id="node" class="level4" data-number="6.6.2.1">
<h4 data-number="6.6.2.1" class="anchored" data-anchor-id="node"><span class="header-section-number">6.6.2.1</span> Node</h4>
<p>When the eigenvalues are real and have the same sign, the steady state is called a <strong>node</strong>. If the sign is negative, all trajectories head into the steady state and it is stable; conversely, in the positive case it is unstable.</p>
<p>Here is a phase plane plot for <span class="math inline">\(\mathbf{A}=\twomat{-4}{-1}{-2}{-5}\)</span>, which has eigenvalues <span class="math inline">\(-3\)</span> and <span class="math inline">\(-6\)</span>.</p>
<div id="fd69f478" class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="op">-</span><span class="fl">4</span> <span class="op">-</span><span class="fl">1</span>; <span class="op">-</span><span class="fl">2</span> <span class="op">-</span><span class="fl">5</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>λ, V <span class="op">=</span> <span class="fu">eigen</span>(A)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot eigenvectors</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fu">Point2</span>.(<span class="fu">eachcol</span>(V))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>fig, ax, scat <span class="op">=</span> <span class="fu">lines</span>([<span class="op">-</span><span class="fl">5</span>P[<span class="fl">1</span>], <span class="fl">5</span>P[<span class="fl">1</span>], <span class="fu">Point2</span>([<span class="cn">NaN</span>, <span class="cn">NaN</span>]), <span class="op">-</span><span class="fl">5</span>P[<span class="fl">2</span>], <span class="fl">5</span>P[<span class="fl">2</span>]], </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=:</span>black, linewidth<span class="op">=</span><span class="fl">3</span>, axis <span class="op">=</span> (xlabel <span class="op">=</span> <span class="st">"x₁"</span>, ylabel <span class="op">=</span> <span class="st">"x₂"</span>) )</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>colr <span class="op">=</span> <span class="fu">cgrad</span>(<span class="op">:</span>seaborn_colorblind)[<span class="fl">1</span><span class="op">:</span><span class="fl">8</span>]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8</span>,<span class="fl">300</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">2</span>,<span class="fl">300</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>xa <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>da <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ab <span class="op">=</span> <span class="fl">20</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> theta <span class="kw">in</span> <span class="fl">2</span><span class="fu">pi*</span>(<span class="fl">0.5</span><span class="op">:</span><span class="fl">23.5</span>)<span class="op">/</span><span class="fl">24</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(t)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="fu">exp</span>(t[j]<span class="op">*</span>A);</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        x[<span class="op">:</span>,j] <span class="op">=</span> X<span class="op">*</span>[ <span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta) ];</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(x[<span class="fl">1</span>,<span class="op">:</span>], x[<span class="fl">2</span>,<span class="op">:</span>], color<span class="op">=</span>colr[<span class="fl">1</span>])</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(xa, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab]))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(da, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[<span class="op">:</span>,ab]))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows!</span>(xa,<span class="fl">1</span>da,linecolor<span class="op">=</span>colr[<span class="fl">1</span>],arrowsize<span class="op">=</span><span class="fl">12</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>([<span class="fl">0</span>],[<span class="fl">0</span>],markersize<span class="op">=</span><span class="fl">10</span>,color<span class="op">=:</span>red)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">limits!</span>(<span class="fl">1.1</span><span class="op">*</span>[<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>]<span class="op">...</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>ax.title <span class="op">=</span> (<span class="st">"stable node"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>ax.aspect <span class="op">=</span> <span class="fu">DataAspect</span>()</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<p><img src="ode_systems_files/figure-html/cell-3-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>The black lines show the directions of the eigenvectors. An initial state on one of those lines stays on it forever. Other initial conditions follow a path tending to become parallel to eigenvector <span class="math inline">\(\mathbf{v}_1\)</span>, since the other component decays out more quickly. The plot for <span class="math inline">\(-\mathbf{A}\)</span> would just reverse all of the arrows and show an unstable steady state.</p>
</section>
<section id="saddle" class="level4" data-number="6.6.2.2">
<h4 data-number="6.6.2.2" class="anchored" data-anchor-id="saddle"><span class="header-section-number">6.6.2.2</span> Saddle</h4>
<p>When the eigenvalues are real and of different signs, the steady state is called a <strong>saddle</strong>. A saddle point is always unstable. The part of the solution along the negative eigenvector decays away, but the contribution from the positive eigenvector grows with time.</p>
<p>Here is a phase plane plot for <span class="math inline">\(\mathbf{A}=\twomat{-2}{-3}{-6}{-5}\)</span>, which has eigenvalues <span class="math inline">\(1\)</span> and <span class="math inline">\(-8\)</span>.</p>
<div id="fe1daf2a" class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="op">-</span><span class="fl">2</span> <span class="op">-</span><span class="fl">3</span>; <span class="op">-</span><span class="fl">6</span> <span class="op">-</span><span class="fl">5</span>]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>λ, V <span class="op">=</span> <span class="fu">eigen</span>(A)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot eigenvectors</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fu">Point2</span>.(<span class="fu">eachcol</span>(V))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>fig,ax,scat <span class="op">=</span> <span class="fu">lines</span>([<span class="op">-</span><span class="fl">5</span>P[<span class="fl">1</span>], <span class="fl">5</span>P[<span class="fl">1</span>], <span class="fu">Point2</span>([<span class="cn">NaN</span>, <span class="cn">NaN</span>]), <span class="op">-</span><span class="fl">5</span>P[<span class="fl">2</span>], <span class="fl">5</span>P[<span class="fl">2</span>]],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=:</span>black, linewidth<span class="op">=</span><span class="fl">3</span>, axis <span class="op">=</span> (xlabel <span class="op">=</span> <span class="st">"x₁"</span>, ylabel <span class="op">=</span> <span class="st">"x₂"</span>) )</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>colr <span class="op">=</span> <span class="fu">cgrad</span>(<span class="op">:</span>seaborn_colorblind)[<span class="fl">1</span><span class="op">:</span><span class="fl">8</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8</span>,<span class="fl">300</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">2</span>,<span class="fl">300</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>xa <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>da <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>ab <span class="op">=</span> <span class="fl">20</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> theta <span class="kw">in</span> <span class="fl">2</span><span class="fu">pi*</span>(<span class="fl">0.5</span><span class="op">:</span><span class="fl">23.5</span>)<span class="op">/</span><span class="fl">24</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(t)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="fu">exp</span>(t[j]<span class="op">*</span>A);</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        x[<span class="op">:</span>,j] <span class="op">=</span> X<span class="op">*</span>[ <span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta) ];</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(x[<span class="fl">1</span>,<span class="op">:</span>], x[<span class="fl">2</span>,<span class="op">:</span>], color<span class="op">=</span>colr[<span class="fl">1</span>])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(xa, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab]))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(da, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[<span class="op">:</span>,ab]))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows!</span>(xa, <span class="fl">1</span>da, linecolor<span class="op">=</span>colr[<span class="fl">1</span>], arrowsize<span class="op">=</span><span class="fl">12</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>([<span class="fl">0</span>],[<span class="fl">0</span>], markersize<span class="op">=</span><span class="fl">10</span>, color<span class="op">=:</span>red)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">limits!</span>(<span class="fl">1.1</span><span class="op">*</span>[<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>]<span class="op">...</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>ax.title <span class="op">=</span> (<span class="st">"saddle"</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>ax.aspect <span class="op">=</span> <span class="fu">DataAspect</span>()</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<p><img src="ode_systems_files/figure-html/cell-4-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>An initial condition exactly on the stable black line (eigenvector) will approach the origin, but anything else ends up shooting away more or less in the direction of the unstable eigenvector.</p>
</section>
<section id="sec-fs-pp-center" class="level4" data-number="6.6.2.3">
<h4 data-number="6.6.2.3" class="anchored" data-anchor-id="sec-fs-pp-center"><span class="header-section-number">6.6.2.3</span> Spiral</h4>
<p>When the eigenvalues are complex conjugates with nonzero real part, the steady state is called a <strong>spiral</strong>. If the eigenvalues are <span class="math inline">\(a \pm i b\)</span>, then all solutions contain <span class="math inline">\(e^{at}e^{\pm i b t}\)</span>, or equivalently, <span class="math inline">\(e^{at}\cos{b t}\)</span> and <span class="math inline">\(e^{at}\sin{b t}\)</span>. The real part causes growth and instability if <span class="math inline">\(a&gt; 0\)</span>, or decay and stability if <span class="math inline">\(a &lt; 0\)</span>. The imaginary part determines the angular speed of the spiral.</p>
<p>Here is a phase plane plot for <span class="math inline">\(\mathbf{A}=\twomat{1}{-2}{4}{-3}\)</span>, which has eigenvalues <span class="math inline">\(-1\pm 2i\)</span>.</p>
<div id="37acad7a" class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="fl">1</span> <span class="op">-</span><span class="fl">2</span>; <span class="fl">4</span> <span class="op">-</span><span class="fl">3</span>];</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>λ, V <span class="op">=</span> <span class="fu">eigen</span>(A)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot eigenvectors</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fu">Point2</span>.(<span class="fu">eachcol</span>(V))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig, ax, scat <span class="op">=</span> <span class="fu">lines</span>([<span class="cn">NaN</span>], [<span class="cn">NaN</span>], color<span class="op">=:</span>black, linewidth<span class="op">=</span><span class="fl">3</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    axis <span class="op">=</span> (xlabel <span class="op">=</span> <span class="st">"x₁"</span>,ylabel <span class="op">=</span> <span class="st">"x₂"</span>) )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>colr <span class="op">=</span> <span class="fu">cgrad</span>(<span class="op">:</span>seaborn_colorblind)[<span class="fl">1</span><span class="op">:</span><span class="fl">8</span>]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">300</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">2</span>,<span class="fl">300</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>xa <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>da <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>ab <span class="op">=</span> <span class="fl">50</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> theta <span class="kw">in</span> <span class="fl">2</span><span class="fu">pi*</span>(<span class="fl">0.5</span><span class="op">:</span><span class="fl">6.5</span>)<span class="op">/</span><span class="fl">7</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(t)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="fu">exp</span>(t[j]<span class="op">*</span>A);</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        x[<span class="op">:</span>,j] <span class="op">=</span> X<span class="op">*</span>[ <span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta) ];</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(x[<span class="fl">1</span>,<span class="op">:</span>], x[<span class="fl">2</span>,<span class="op">:</span>], color<span class="op">=</span>colr[<span class="fl">1</span>])</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(xa, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab]))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">push!</span>(da, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[<span class="op">:</span>,ab]))</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows!</span>(xa, <span class="fl">1</span>da, linecolor<span class="op">=</span>colr[<span class="fl">1</span>], arrowsize<span class="op">=</span><span class="fl">12</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>([<span class="fl">0</span>], [<span class="fl">0</span>], markersize<span class="op">=</span><span class="fl">10</span>, color<span class="op">=:</span>red)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">limits!</span>(<span class="fl">1.1</span><span class="op">*</span>[<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>]<span class="op">...</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ax.title <span class="op">=</span> (<span class="st">"spiral"</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>ax.aspect <span class="op">=</span> <span class="fu">DataAspect</span>()</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<p><img src="ode_systems_files/figure-html/cell-5-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>The eigenvectors are complex and don’t show up on the plot; there are no purely linear trajectories as in the other cases.</p>
<p>If the eigenvalues are complex with positive real part, then the trajectories spiral outward instead of inward.</p>
</section>
<section id="center" class="level4" data-number="6.6.2.4">
<h4 data-number="6.6.2.4" class="anchored" data-anchor-id="center"><span class="header-section-number">6.6.2.4</span> Center</h4>
<p>The special case of imaginary eigenvalues, <span class="math inline">\(\lambda=\pm i b\)</span>, is called a <strong>center</strong>. You can think of the trajectories as spirals that are perfectly neutral — that is, circles or ellipses. These equilibria are often associated with conservation principles, such as conservation of energy.</p>
<p>Here is a phase plane plot for <span class="math inline">\(\mathbf{A}=\twomat{0}{-1}{4}{0}\)</span>, which has eigenvalues <span class="math inline">\(\pm 2i\)</span>.</p>
<div id="a4934ac9" class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [<span class="fl">0</span> <span class="op">-</span><span class="fl">1</span>; <span class="fl">4</span> <span class="fl">0</span>];</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>λ, V <span class="op">=</span> <span class="fu">eigen</span>(A)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot eigenvectors</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="fu">Point2</span>.(<span class="fu">eachcol</span>(V))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fig, ax, scat <span class="op">=</span> <span class="fu">lines</span>([<span class="cn">NaN</span>], [<span class="cn">NaN</span>],</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=:</span>black, linewidth<span class="op">=</span><span class="fl">3</span>, axis <span class="op">=</span> (xlabel <span class="op">=</span> <span class="st">"x₁"</span>, ylabel <span class="op">=</span> <span class="st">"x₂"</span>) )</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>colr <span class="op">=</span> <span class="fu">cgrad</span>(<span class="op">:</span>seaborn_colorblind)[<span class="fl">1</span><span class="op">:</span><span class="fl">8</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0</span>,<span class="fl">7</span>,<span class="fl">300</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">2</span>,<span class="fl">300</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>xa <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>da <span class="op">=</span> Point2{<span class="dt">Float64</span>}[]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>ab <span class="op">=</span> <span class="fl">5</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> r <span class="op">=</span> <span class="fl">0.15</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">0.55</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(t)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> <span class="fu">exp</span>(t[j]<span class="op">*</span>A);</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        x[<span class="op">:</span>,j] <span class="op">=</span> X<span class="op">*</span>[r; <span class="fl">0</span>];</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines!</span>(x[<span class="fl">1</span>,<span class="op">:</span>], x[<span class="fl">2</span>,<span class="op">:</span>], color<span class="op">=</span>colr[<span class="fl">1</span>])</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(xa, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab]))</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(da, <span class="fu">Point2</span>(x[<span class="op">:</span>,ab<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> x[<span class="op">:</span>,ab]))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows!</span>(xa, <span class="fl">1</span>da, linecolor<span class="op">=</span>colr[<span class="fl">1</span>], arrowsize<span class="op">=</span><span class="fl">12</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>([<span class="fl">0</span>], [<span class="fl">0</span>], markersize<span class="op">=</span><span class="fl">10</span>, color<span class="op">=:</span>red)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">limits!</span>(<span class="fl">1.2</span><span class="op">*</span>[<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>]<span class="op">...</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>ax.title <span class="op">=</span> (<span class="st">"center"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>ax.aspect <span class="op">=</span> <span class="fu">DataAspect</span>()</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<p><img src="ode_systems_files/figure-html/cell-6-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>A center is on a knife edge between asymptotically stable and unstable: small perturbations do not decay away, but they also can grow only by a bounded amount. This situation might be called <em>weakly stable</em>, <em>neutrally stable</em>, or simply <strong>stable</strong> but not asymptotically stable.</p>
</section>
</section>
<section id="tracedeterminant" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="tracedeterminant"><span class="header-section-number">6.6.3</span> Trace/determinant</h3>
<div id="def-odesys-trace" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.6 (Trace of a matrix) </strong></span>The <strong>trace</strong> of a square matrix is the sum of its diagonal entries.</p>
</div>
<p>In the <span class="math inline">\(2\times 2\)</span> case, the trace <span class="math inline">\(\tau\)</span> and determinant <span class="math inline">\(\Delta\)</span> completely determine the eigenvalues, and therefore they determine the nature of the phase portrait, as shown in <a href="#fig-phase_plane-TD" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>.</p>
<div id="fig-phase_plane-TD" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="TD-phase.png" class="img-fluid figure-img" alt="Figure from Zill's book."></p>
<figcaption class="figure-caption">Figure&nbsp;6.1: Phase portrait type based on trace <span class="math inline">\(\tau\)</span> and determinant <span class="math inline">\(\Delta\)</span> of a <span class="math inline">\(2\times 2\)</span> matrix.</figcaption>
</figure>
</div>
<p>(You can ignore the degenerate cases along <span class="math inline">\(\tau=4\Delta^2\)</span>.) One easy takeaway is that the fixed point is stable if <span class="math inline">\(\tau \le 0\)</span> ans <span class="math inline">\(\Delta \ge 0\)</span>, and unstable otherwise.</p>
<div id="exm-odesys-tracedet" class="theorem example" data-chapter="6" data-description="Trace and determinant for stability">
<p><span class="theorem-title"><strong>Example 6.12 </strong></span>Consider <span class="math inline">\(\mathbf{A}=\twomat{1}{-2}{4}{-3}\)</span>, which has trace <span class="math inline">\(\tau=-2\)</span> and determinant <span class="math inline">\(\Delta=5\)</span>. These place us in the second quadrant in <a href="#fig-phase_plane-TD" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>. Since</p>
<p><span class="math display">\[
4\Delta = 20 &gt; 4 = \tau^2 ,
\]</span></p>
<p>we are above the parabola in that figure, so the origin is a stable spiral.</p>
</div>
</section>
</section>
<section id="the-matrix-exponential" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="the-matrix-exponential"><span class="header-section-number">6.7</span> The matrix exponential</h2>
<p>As we well know by now, the solution of the scalar linear IVP <span class="math inline">\(x'=ax\)</span>, <span class="math inline">\(x(0)=x_0\)</span> is</p>
<p><span class="math display">\[
x(t) = e^{at} x_0.
\]</span></p>
<p>Wouldn’t it be interesting if in the vector case <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x}\)</span>, <span class="math inline">\(\bfx(0)=\bfx_0\)</span>, we could write</p>
<p><span class="math display">\[
\bfx(t) \stackrel{?}{=} e^{\bfA t} \bfx_0
\]</span></p>
<p>Funny you should ask.</p>
<section id="diagonalization" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="diagonalization"><span class="header-section-number">6.7.1</span> Diagonalization</h3>
<p>Let’s review the process of solving <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x}\)</span> using <a href="#thm-cc-eigensolution" class="quarto-xref">Theorem&nbsp;<span>6.5</span></a>. If <span class="math inline">\(\bfA\)</span> has a diagonalization <span class="math inline">\(\bfA=\bfV \mathbf{D}\bfV^{-1}\)</span>, where <span class="math inline">\(\bfV\)</span> has eigenvector columns and <span class="math inline">\(\mathbf{D}\)</span> is a diagonal matrix of the eigenvalues, then the general solution is</p>
<p><span class="math display">\[
\bfx(t) = c_1 e^{t \lambda_1} \mathbf{v}_1 + \cdots + c_n e^{t \lambda_n} \mathbf{v}_n = \bfV \bfE(t) \bfc,
\]</span></p>
<p>for a constant vector <span class="math inline">\(\bfc\)</span>, where</p>
<p><span id="eq-odesys-diagexp"><span class="math display">\[
\bfE(t) = \begin{bmatrix} e^{t \lambda_1} &amp; &amp; &amp; \\ &amp; e^{t \lambda_2} &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; e^{t \lambda_n} \end{bmatrix}.
\tag{6.16}\]</span></span></p>
<p>If we also have an initial condition <span class="math inline">\(\bfx(0)=\bfx_0\)</span>, then</p>
<p><span class="math display">\[
\bfx_0 = \bfx(0) = \bfV \bfE(0) \bfc = \bfV \bfc,
\]</span></p>
<p>so that <span class="math inline">\(\bfc = \bfV^{-1} \bfx_0\)</span>. We summarize this as follows.</p>
<div id="thm-odesys-diagonalization" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.6 </strong></span>If the constant matrix <span class="math inline">\(\bfA\)</span> has a diagonalization <span class="math inline">\(\bfA=\bfV \mathbf{D}\bfV^{-1}\)</span>, then the homogeneous IVP <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x}\)</span>, <span class="math inline">\(\bfx(0)=\bfx_0\)</span> has the solution</p>
<p><span class="math display">\[
\bfx(t) = \bfV \bfE(t) \bfV^{-1} \bfx_0,
\]</span></p>
<p>with <span class="math inline">\(\bfE(t)\)</span> as in <a href="#eq-odesys-diagexp" class="quarto-xref">Equation&nbsp;<span>6.16</span></a>.</p>
</div>
<p>The matrix <span class="math inline">\(\bfV \bfE(t) \bfV^{-1}\)</span> is essentially a special fundamental matrix <span class="math inline">\(\fundm\)</span> for which <span class="math inline">\(\fundm(0)=\meye\)</span>. That extra property makes it convenient for solving an IVP.</p>
<!-- 
### Change of basis

Given the diagonalization $\bfA=\bfV \mathbf{D}\bfV^{-1}$, we can rewrite the ODE $\bfx'=\bfA\bfx$ as 

$$
\bfx'=\bfV \mathbf{D}\bfV^{-1} \bfx.
$$

We multiply by $\bfV^{-1}$ on the left and, observing that $\bfV$ and its inverse are constant with respect to time, we get

$$
(\bfV^{-1} \bfx)'= \mathbf{D} (\bfV^{-1} \bfx) \quad \Rightarrow \quad  \bfy' = \mathbf{D} \bfy,
$$

where we defined

$$
\bfy = \bfV^{-1}\bfx.
$$

Note that $\bfy$ is simply the coordinate vector for $\bfx$ in the basis of eigenvectors. The diagonal system $\bfy' = \mathbf{D} \bfy$ completely decouples into $n$ scalar equations

$$
y_i' = \lambda_i y_i, \quad i=1,\ldots,n.
$$

These are trivial to solve:

$$
y_i(t) = e^{\lambda_i t}y_i(0), \quad i=1,\ldots,n, \Longrightarrow \bfy = \bfE(t) \bfy(0).
$$

Changing back to standard coordinates returns us again to 

$$
\bfx(t) = \bfV \bfE(t) \bfV^{-1} \bfx(0).
$$ 
-->
</section>
<section id="power-series" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="power-series"><span class="header-section-number">6.7.2</span> Power series</h3>
<p>The matrix <span class="math inline">\(\bfE(t)\)</span> has a nice structure:</p>
<p><span class="math display">\[
\begin{split}
\bfE(t) &amp;= \diagm{1 + (\lambda_1 t) + \frac{1}{2!} (\lambda_1 t)^2 + \cdots }{1 + (\lambda_2 t) + \frac{1}{2!} (\lambda_2 t)^2 + \cdots }{1 + (\lambda_n t) + \frac{1}{2!} (\lambda_n t)^2 + \cdots }\\
&amp;= \diagm{1}{1}{1} + t \diagm{\lambda_1}{\lambda_2}{\lambda_n} + \frac{t^2}{2!} \diagm{\lambda_1^2}{\lambda_2^2}{\lambda_n^2} + \cdots.
\end{split}
\]</span></p>
<p>The simplicity of the diagonal matrix <span class="math inline">\(\bfD\)</span> lets us write</p>
<p><span class="math display">\[
\bfE(t) = \meye + t\bfD + \frac{t^2}{2!}\bfD^2 + \cdots.
\]</span></p>
<p>This strongly hints at the definition</p>
<p><span id="eq-matrix_exp-series"><span class="math display">\[
e^{t\mathbf{A}} = \mathbf{I} + t\mathbf{A} + \frac{1}{2!}t^2 \mathbf{A}^2 + \frac{1}{3!} t^3 \mathbf{A}^3 + \cdots
\tag{6.17}\]</span></span></p>
<p>for a square matrix <span class="math inline">\(\bfA\)</span>, so that <span class="math inline">\(\bfE(t) = e^{t\bfD}\)</span>. Let’s not worry too much about whether this series converges (it does). What are its properties?</p>
<div id="thm-matrixexp" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.7 (Matrix exponential) </strong></span>Let <span class="math inline">\(\mathbf{A},\mathbf{B}\)</span> be <span class="math inline">\(n\times n\)</span> matrices. Then</p>
<ol type="1">
<li><span class="math inline">\(e^{t\mathbf{A}}=\mathbf{I}\)</span> if <span class="math inline">\(t=0\)</span>,</li>
<li><span class="math inline">\(\displaystyle \dd{}{t}e^{t\mathbf{A}} = \mathbf{A} e^{t\mathbf{A}} = e^{t\mathbf{A}}\mathbf{A}\)</span>,</li>
<li><span class="math inline">\([e^{t\mathbf{A}}]^{-1} = e^{-t\mathbf{A}}\)</span>,</li>
<li><span class="math inline">\(e^{(s+t)\mathbf{A}} = e^{s\bfA} \cdot e^{t\bfA} = e^{t\bfA} \cdot e^{s\bfA}\)</span></li>
<li>If <span class="math inline">\(\mathbf{A}\mathbf{B}=\mathbf{B}\mathbf{A}\)</span>, then <span class="math inline">\(e^{t(\mathbf{A}+\mathbf{B})} = e^{t\mathbf{A}}\cdot e^{t\mathbf{B}} = e^{t\mathbf{B}}\cdot e^{t\mathbf{A}}\)</span>.</li>
</ol>
</div>
<p>These conclusions follow pretty easily from the series definition <a href="#eq-matrix_exp-series" class="quarto-xref">Equation&nbsp;<span>6.17</span></a>. They are all essential to what we normally expect from an exponential function, although in the last case we have a new restriction specific to matrices.</p>
<p>From these properties we can make the connection to the IVP.</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.8 </strong></span>If <span class="math inline">\(\bfA\)</span> is a constant square matrix, then</p>
<p><span class="math display">\[
\bfx(t) = e^{t \bfA} \bfx_0
\]</span></p>
<p>solves the initial-value problem <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x}\)</span>, with <span class="math inline">\(\bfx(0)=\bfx_0\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>With <span class="math inline">\(\bfx\)</span> as defined in the theorem statement, we calculate</p>
<p><span class="math display">\[
\dd{}{t} \bfx(t) = \Bigl( \dd{}{t}e^{t \bfA} \Bigr) \bfx_0 =  \mathbf{A} e^{t\mathbf{A}} \bfx_0 = \bfA \bfx(t),
\]</span></p>
<p>using property 2 above. Furthermore,</p>
<p><span class="math display">\[
\bfx(0) = e^{0 \bfA} \bfx_0 = \meye \bfx_0 = \bfx_0,
\]</span></p>
<p>using property 1 above.</p>
</div>
</section>
<section id="computation" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="computation"><span class="header-section-number">6.7.3</span> Computation</h3>
<p>While the matrix exponential completely solves the initial-value problem for a constant-coefficient homogeneous system, it usually not easy to compute. One exception are diagonal matrices. As seen in <a href="#eq-odesys-diagexp" class="quarto-xref">Equation&nbsp;<span>6.16</span></a>, if <span class="math inline">\(\bfD\)</span> is diagonal with <span class="math inline">\(\lambda_1,\ldots,\lambda_n\)</span> on the diagonal, then <span class="math inline">\(e^{t\bfD}\)</span> is diagonal with <span class="math inline">\(e^{t\lambda_1},\ldots,e^{t\lambda_n}\)</span> on the diagonal.</p>
<p>A diagonalization can be used to compute the matrix exponential, but that route is no easier than finding a fundamental matrix like we did earlier. Summing the infinite series of matrices in <a href="#eq-matrix_exp-series" class="quarto-xref">Equation&nbsp;<span>6.17</span></a> seems unlikely to be helpful in general. Fortunately, there is an alternative. Thanks to a result known as the Cayley–Hamilton theorem, the following is true.</p>
<div id="thm-matrix_exp-poly" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.9 (Matrix exponential by polynomial) </strong></span>If <span class="math inline">\(\bfA\)</span> has eigenvalues <span class="math inline">\(\lambda_1,\ldots,\lambda_n\)</span>, then there exist functions <span class="math inline">\(c_0(t),\ldots,c_{n-1}(t)\)</span> such that if we define</p>
<p><span class="math display">\[
f(t,z) = c_0(t) + c_1(t) z + \cdots + c_{n-1}(t) z,
\]</span></p>
<p>then</p>
<p><span class="math display">\[
f(t,\lambda_k) = e^{t\lambda_k}, \qquad k=1,\ldots,n,
\]</span></p>
<p>and</p>
<p><span class="math display">\[
e^{t\bfA} = f(t,\bfA) = c_0(t)\meye + c_1(t)\bfA + \cdots + c_{n-1}(t)\bfA^{n-1}.
\]</span></p>
</div>
<p>The main appeal of these formulas is that the eigenvectors aren’t needed. We will write out the implications just for the <span class="math inline">\(2\times 2\)</span> case:</p>
<div id="thm-matrix_exp-2by2" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.10 (Matrix exponential for <span class="math inline">\(2\times 2\)</span>) </strong></span>If <span class="math inline">\(\bfA\)</span> is <span class="math inline">\(2\times 2\)</span>, then</p>
<p><span id="eq-matrixexp-polymat"><span class="math display">\[
\begin{split}
e^{t\bfA} &amp;= c_0(t)\,\meye + c_1(t)\,\bfA.
\end{split}
\tag{6.18}\]</span></span></p>
<p>If the eigenvalues of <span class="math inline">\(\bfA\)</span> are real and distinct, then <span class="math inline">\(c_0\)</span> and <span class="math inline">\(c_1\)</span> are solutions of the system</p>
<p><span id="eq-matrixexp-2by2real"><span class="math display">\[
\begin{split}
e^{t\lambda_1} &amp;= c_0(t) + \lambda_1 c_1(t), \\
e^{t\lambda_2} &amp;= c_0(t) + \lambda_2 c_1(t).
\end{split}
\tag{6.19}\]</span></span></p>
<p>If <span class="math inline">\(\lambda_1 = \lambda_2\)</span>, then</p>
<p><span id="eq-matrixexp-2by2repeat"><span class="math display">\[
\begin{split}
e^{t\lambda_1} &amp;= c_0(t) + \lambda_1 c_1(t), \\
c_1(t) &amp;=  t e^{t\lambda_1}.
\end{split}
\tag{6.20}\]</span></span></p>
<p>If <span class="math inline">\(\lambda_{1,2} = r \pm i\omega\)</span>, then</p>
<p><span id="eq-matrixexp-2by2complex"><span class="math display">\[
\begin{split}
e^{rt} \cos(\omega t) &amp;= c_0(t) + rc_1(t), \\
e^{rt} \sin(\omega t) &amp;= \omega c_1(t).
\end{split}
\tag{6.21}\]</span></span></p>
</div>
<div id="exm-odesys-exp-distinct" class="theorem example" data-chapter="6" data-description="Matrix exp w/distinct eigenvalues">
<p><span class="theorem-title"><strong>Example 6.13 </strong></span>Given that</p>
<p><span class="math display">\[
\mathbf{A} = \twomat{1}{1}{4}{1}
\]</span></p>
<p>has eigenvalues <span class="math inline">\(\lambda_1=3\)</span> and <span class="math inline">\(\lambda_2=-1\)</span>, find <span class="math inline">\(e^{t\bfA}\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We write out <a href="#eq-matrixexp-2by2real" class="quarto-xref">Equation&nbsp;<span>6.19</span></a>:</p>
<p><span class="math display">\[
\begin{split}
c_0 + 3c_1 &amp;= e^{3t}   \\
c_0 - c_1 &amp;= e^{-t}.
\end{split}
\]</span></p>
<p>Cramer’s rule leads to</p>
<p><span class="math display">\[
c_0 = \frac{-e^{3t}-3e^{-t}}{-4}, \qquad c_1 = \frac{e^{-t}-e^{3t}}{-4}.
\]</span></p>
<p>Inserting these into <a href="#eq-matrixexp-polymat" class="quarto-xref">Equation&nbsp;<span>6.18</span></a> gives</p>
<p><span class="math display">\[
\begin{split}
e^{t\bfA} &amp;= \frac{e^{3t}+3e^{-t}}{4}\, \meye + \frac{e^{3t}-e^{-t}}{4} \, \bfA \\
&amp;= \frac{1}{4}\twomat{2(e^{3t}+e^{-t})}{e^{3t}-e^{-t}}{4(e^{3t}-e^{-t})}{2(e^{3t}+e^{-t})}.
\end{split}
\]</span></p>
</div>
</div>
<div id="exm-odesys-exp-complex" class="theorem example" data-chapter="6" data-description="Matrix exp w/complex eigenvalues">
<p><span class="theorem-title"><strong>Example 6.14 </strong></span>Given that</p>
<p><span class="math display">\[
\mathbf{A} = \twomat{1}{-1}{5}{-3}
\]</span></p>
<p>has eigenvalues <span class="math inline">\(-1\pm i\)</span>, find <span class="math inline">\(e^{t\bfA}\)</span> and the solution of the IVP <span class="math inline">\(\bfx'=\mathbf{A}\bfx\)</span> having <span class="math inline">\(\bfx(0)=\twovec{2}{1}\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Writing out <a href="#eq-matrixexp-2by2complex" class="quarto-xref">Equation&nbsp;<span>6.21</span></a> with <span class="math inline">\(r=-1\)</span> and <span class="math inline">\(\omega=1\)</span> yields</p>
<p><span class="math display">\[
\begin{split}
e^{-t} \cos(t) &amp;= c_0(t) - c_1(t), \\
e^{-t} \sin(t) &amp;= c_1(t).
\end{split}
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
\begin{split}
e^{t\bfA} &amp;= [e^{-t} \cos(t) + e^{-t} \sin(t)]\, \meye + e^{-t} \sin(t)\, \bfA \\
&amp; = e^{-t}\,\twomat{\cos(t)+\sin(t)}{0}{0}{\cos(t)+\sin(t)} + e^{-t}\,\twomat{\sin(t)}{-\sin(t)}{5\sin(t)}{-3\sin(t)} \\
&amp;= e^{-t}\, \twomat{\cos(t)+2\sin(t)}{-\sin(t)}{5\sin(t)}{\cos(t)-2\sin(t)}.
\end{split}
\]</span></p>
<p>The solution of the IVP is then</p>
<p><span class="math display">\[
\bfx(t) = e^{t\bfA} \bfx(0) = e^{-t}\twomat{\cos(t)+2\sin(t)}{-\sin(t)}{5\sin(t)}{\cos(t)-2\sin(t)} \twovec{2}{1} = e^{-t} \twovec{2\cos(t)+2\sin(t)}{\cos(t)+8\sin(t)}.
\]</span></p>
</div>
</div>
<div id="exm-odesys-exp-repeat" class="theorem example" data-chapter="6" data-description="Matrix exp w/repeated eigenvalue">
<p><span class="theorem-title"><strong>Example 6.15 </strong></span>Given that</p>
<p><span class="math display">\[
\mathbf{A} = \twomat{4}{1}{-1}{2}
\]</span></p>
<p>has eigenvalue <span class="math inline">\(\lambda_1=\lambda_2=3\)</span>, find <span class="math inline">\(e^{t\bfA}\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Writing out <a href="#eq-matrixexp-2by2repeat" class="quarto-xref">Equation&nbsp;<span>6.20</span></a> with <span class="math inline">\(\lambda_1=3\)</span> yields</p>
<p><span class="math display">\[
\begin{split}
e^{3t} &amp;= c_0(t) + 3c_1(t), \\
c_1(t) &amp;=  t e^{3t}.
\end{split}
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
\begin{split}
e^{t\bfA} &amp;= [e^{3t} -3 t e^{3t}]\, \meye + t e^{3t}\, \bfA \\
&amp;=  e^{3t}\,\twomat{1-3t}{0}{0}{1-3t} + e^{3t}\,\twomat{4t}{t}{-t}{2t} \\
&amp; = e^{3t}\,\twomat{1+t}{t}{-t}{1-t}.
\end{split}
\]</span></p>
</div>
</div>
</section>
</section>
<section id="nonhomogeneous-problem" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="nonhomogeneous-problem"><span class="header-section-number">6.8</span> Nonhomogeneous problem</h2>
<p>The nonhomogeneous system <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x} + \mathbf{f}(t)\)</span> has general solution</p>
<p><span class="math display">\[
\bfx(t) = \bfx_h(t) + \bfx_p(t),
\]</span></p>
<p>where <span class="math inline">\(\bfx_h\)</span> is the general solution of the homogeneous problem <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x}\)</span> and <span class="math inline">\(\bfx_p\)</span> is a particular solution of the nonhomogeneous problem. If <span class="math inline">\(\bfA\)</span> has constant coefficients, then</p>
<p><span class="math display">\[
\bfx_h(t) = e^{t\bfA} \bfc
\]</span></p>
<p>for a constant vector <span class="math inline">\(\bfc\)</span>. To finish the problem, we need to find <span class="math inline">\(\bfx_p\)</span>.</p>
<p>One option is to turn once again to variation of parameters. If we make the assumption</p>
<p><span class="math display">\[
\bfx_p(t) = e^{t\bfA} \bfc(t),
\]</span></p>
<p>then</p>
<p><span class="math display">\[
\begin{split}
\bfx_p'(t) &amp;= \bfA e^{t\bfA} \bfc(t) + e^{t\bfA} \bfc'(t) \\
&amp;= \bfA \bfx_p(t) + e^{t\bfA} \bfc'(t).
\end{split}
\]</span></p>
<p>Comparing this to the ODE, <span class="math inline">\(\mathbf{x}'=\mathbf{A} \mathbf{x} + \mathbf{f}(t)\)</span>, we will have a particular solution if</p>
<p><span class="math display">\[
e^{t\bfA} \bfc'(t) = \mathbf{f}(t), \qquad \implies \qquad \bfc'(t) = e^{-t\bfA} \,\mathbf{f}(t).
\]</span></p>
<p>In principle, finding the antiderivative of <span class="math inline">\(\bfc'(t)\)</span> is just a bunch of integrations and algebra. In practice, we probably ought to leave it to the computers.</p>
<p>However, one way of writing the full general solution is interesting:</p>
<p><span class="math display">\[
\bfx(t) = e^{t\bfA}\, \bfx(0) + \int_0^t e^{(t-s)\bfA} \, \mathbf{f}(s) \, ds.
\]</span></p>
<p>Parsing this formula, the solution comprises two contributions that simply add together (the hallmark of linearity). The first term is the influence of the initial condition, which is propagated by the matrix exponential just as though the forcing isn’t present. In the second term, we can interpret the integral as the sum of infinitesimals: for every <span class="math inline">\(s\)</span> between <span class="math inline">\(0\)</span> and <span class="math inline">\(t\)</span>, we get a contribution of</p>
<p><span class="math display">\[
e^{(t-s)\bfA}\, \mathbf{f}(s).
\]</span></p>
<p>This is equivalent to the solution of the IVP that starts at time <span class="math inline">\(s\)</span> with initial condition <span class="math inline">\(\bff(s)\)</span> and evolves for an additional time <span class="math inline">\(t-s\)</span> to get to time <span class="math inline">\(t\)</span>. That is, each instant of forcing is propagated as though it resets the initial state of the system. Thus, while the behavior of the matrix exponential can be quite complicated, we can at least intuitively begin to understand how forcing affects the system.</p>
</section>
<section id="linearization" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="linearization"><span class="header-section-number">6.9</span> Linearization</h2>
<p>A pendulum with length <span class="math inline">\(L\)</span> and angle of deflection <span class="math inline">\(\theta(t)\)</span> from the vertical is governed by the nonlinear second-order equation</p>
<p><span class="math display">\[
\ddd{\theta}{t} + \frac{g}{L} \sin(\theta) = 0,
\]</span></p>
<p>where <span class="math inline">\(g\)</span> is gravitational acceleration. It’s standard to argue that as long as <span class="math inline">\(|\theta|\)</span> remains small, a good approximation is the linear problem</p>
<p><span class="math display">\[
\ddd{\theta}{t} + \frac{g}{L} \theta = 0,
\]</span></p>
<p>because <span class="math inline">\(\sin \theta \approx \theta\)</span>. We want to get more systematic with this process.</p>
<p>First note that we can recast the nonlinear second-order problem as a first-order system in two variables, just as we did for linear equations. Define <span class="math inline">\(x=\theta\)</span> and <span class="math inline">\(y=\theta'\)</span>. Then</p>
<p><span class="math display">\[
\begin{split}
    \dd{x}{t} &amp; = y, \\
    \dd{y}{t} &amp; = -\frac{g}{L}\sin(x).
\end{split}
\]</span></p>
<p>This trick works for any nonlinear second-order equation <span class="math inline">\(\theta''=g(t,\theta,\theta')\)</span>. Thus we can focus on problems in the general form</p>
<p><span class="math display">\[
\begin{split}
    \dd{x}{t} &amp; = F(x,y), \\
    \dd{y}{t} &amp; = G(x,y).
\end{split}
\]</span></p>
<p>As we did with single scalar equations, we will pay close attention to steady states or fixed points of these systems. Here this means finding constants <span class="math inline">\((\hat{x},\hat{y})\)</span> such that</p>
<p><span class="math display">\[
F(\hat{x},\hat{y})=G(\hat{x},\hat{y})=0.
\]</span></p>
<p>For the nonlinear pendulum, both <span class="math inline">\((0,0)\)</span> (straight down, at rest) and <span class="math inline">\((\pi,0)\)</span> (straight up, at rest) are steady states.</p>
<p>We are interested in the stability of fixed points, i.e., the dynamics close to them. We will use linear approximations of the functions <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span> near a fixed point:</p>
<p><span class="math display">\[
\begin{split}
    F(x,y) &amp; \approx F(\hat{x},\hat{y}) + \pp{F}{x}\cdot (x-\hat{x}) + \pp{F}{y} \cdot (y-\hat{y}),\\
    G(x,y) &amp; \approx G(\hat{x},\hat{y}) + \pp{G}{x} \cdot (x-\hat{x}) + \pp{G}{y} \cdot (y-\hat{y}),\\
\end{split}
\]</span></p>
<p>where it is understood for brevity that the partial derivatives are all evaluated at <span class="math inline">\((\hat{x},\hat{y})\)</span>. Given that <span class="math inline">\((\hat{x},\hat{y})\)</span> is a fixed point, <span class="math inline">\(F(\hat{x},\hat{y})=G(\hat{x},\hat{y})=0\)</span>.</p>
<p>Now define</p>
<p><span class="math display">\[
u_1(t)=x(t)-\hat{x},\quad u_2(t)=y(t)-\hat{y}.
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
\begin{split}
    \dd{u_1}{t} = \dd{x}{t} &amp; \approx \pp{F}{x} u_1 + \pp{F}{y} u_2, \\
    \dd{u_2}{t} = \dd{y}{t} &amp; \approx \pp{G}{x} u_1 + \pp{G}{y} u_2.
\end{split}
\]</span></p>
<p>This inspires the following definition.</p>
<div id="def-jacobian" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.7 (Jacobian matrix) </strong></span>The <strong>Jacobian matrix</strong> of the system <span class="math inline">\(x'=F(x,y),\, y'=G(x,y)\)</span> is</p>
<p><span id="eq-nl-jacobian"><span class="math display">\[
\mathbf{J}(x,y) = \twomat{\displaystyle \pp{F}{x}}{\displaystyle \pp{F}{y}}{\displaystyle \pp{G}{x}}{\displaystyle \pp{G}{y}}.
\tag{6.22}\]</span></span></p>
</div>
<p>The Jacobian matrix is essentially the derivative of a 2D vector field. As such, it is also a function of the variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<section id="stability-1" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="stability-1"><span class="header-section-number">6.9.1</span> Stability</h3>
<p>Let’s summarize. In the neighborhood of a fixed point <span class="math inline">\((\hat{x},\hat{y})\)</span>, we can define the <em>deviation from equilibrium</em> by the variables <span class="math inline">\(u_1(t)=x(t)-\hat{x}\)</span>, <span class="math inline">\(u_2(t)=y(t)-\hat{y}\)</span>. These variables approximately satisfy <span class="math inline">\(\mathbf{u}'=\mathbf{J}(\hat{x},\hat{y})\mathbf{u}\)</span>, which is a linear, constant-coefficient system in two dimensions. Thus, <strong>near a steady state, dynamics are mostly linear.</strong></p>
<p>We are now right back into the phase plane we studied earlier. In particular:</p>
<div id="thm-" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.11 </strong></span>The stability of a steady state is (usually) determined by the eigenvalues of the Jacobian matrix at the steady state.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.16 </strong></span>Let’s examine the steady states of a pendulum with damping,</p>
<p><span class="math display">\[
\ddd{\theta}{t} + \gamma \theta' + \frac{g}{L} \sin(\theta) = 0,
\]</span></p>
<p>with <span class="math inline">\(\gamma &gt; 0\)</span>. It transforms into the first-order system</p>
<p><span class="math display">\[
\begin{split}
    \dd{x}{t} &amp; = y, \\
    \dd{y}{t} &amp; = -\frac{g}{L}\sin(x) - \gamma y.
\end{split}
\]</span></p>
<p>These define <span class="math inline">\(F(x,y)\)</span> and <span class="math inline">\(G(x,y)\)</span>. From here we note all the first partial derivatives:</p>
<p><span class="math display">\[
\begin{split}
\pp{F}{x} = 0, &amp; \qquad \pp{F}{y} = 1,\\
\pp{G}{x} = - \frac{g}{L}\cos(x), &amp; \qquad \pp{G}{y} = -\gamma.
\end{split}
\]</span></p>
<p>The first steady state we consider is at the origin. Here the Jacobian matrix is</p>
<p><span class="math display">\[
\begin{bmatrix}
0 &amp; 1 \\ -g/L &amp; -\gamma
\end{bmatrix}.
\]</span></p>
<p>The eigenvalues are roots of <span class="math inline">\(\lambda^2 +\gamma \lambda + \frac{g}{L}\)</span>, the same as a linear oscillator with <span class="math inline">\(\omega_0 = \sqrt{g/L}\)</span> and <span class="math inline">\(Z = \gamma/2\omega_0\)</span>. If <span class="math inline">\(Z&lt;1\)</span>, we get a stable spiral. If <span class="math inline">\(Z\ge 1\)</span>, we get a stable node. This all agrees well with our experience with a pendulum hanging straight down.</p>
<p>The other steady state is at <span class="math inline">\((\pi,0)\)</span>. Now the Jacobian is</p>
<p><span class="math display">\[
\begin{bmatrix}
0 &amp; 1 \\ g/L &amp; -\gamma
\end{bmatrix},
\]</span></p>
<p>with characteristic polynomial <span class="math inline">\(\lambda^2 + \gamma \lambda - \frac{g}{L}\)</span>. The eigenvalues are</p>
<p><span class="math display">\[
\lambda_1 = -\gamma + \sqrt{\gamma^2+4\frac{g}{L}}, \quad \lambda_2 = -\gamma - \sqrt{\gamma^2+4\frac{g}{L}}.
\]</span></p>
<p>It’s obvious that <span class="math inline">\(\lambda_2 &lt; 0\)</span>. Since <span class="math inline">\(\gamma^2+\frac{4g}{L} &gt; \gamma^2\)</span>, it follows that <span class="math inline">\(\lambda_1 &gt; 0\)</span>. Hence this equilibrium is a saddle point.</p>
</div>
<p>The caveat on using eigenvalues for stability is when they both have zero real part, which is weakly stable in the linear sense. In such cases the details of the nonlinear terms of the system can swing the stability either way.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.17 </strong></span>The system</p>
<p><span class="math display">\[
\begin{split}
\frac{dx}{dt} &amp;= 3x-\frac{xy}{2}\\
\frac{dy}{dt} &amp;= -y+\frac{xy}{4}\\
\end{split}
\]</span></p>
<p>is called a <em>predator–prey</em> equation. If species <span class="math inline">\(y\)</span> is set to zero, species <span class="math inline">\(x\)</span> would grow exponentially on its own (the prey). Similarly, species <span class="math inline">\(y\)</span> would die off on its own (predator). We assume that encounters between the species are jointly proportional to the population of each, and they subtract from the prey and add to the predators.</p>
<p>We find fixed points when <span class="math inline">\(3x-(x y/2)=(x y/4)-y=0\)</span>, which has two solutions, <span class="math inline">\((0,0)\)</span> and <span class="math inline">\((4,6)\)</span>. The Jacobian matrix of the system is</p>
<p><span class="math display">\[
\mathbf{J}(x,y) = \begin{bmatrix} F_x &amp; F_y  \\ G_x &amp; G_y \end{bmatrix} = \begin{bmatrix} 3-y/2 &amp; -x/2 \\ y/4 &amp; -1+x/4 \end{bmatrix}.
\]</span></p>
<p>At the origin, the Jacobian becomes</p>
<p><span class="math display">\[
\mathbf{J}(0,0) = \begin{bmatrix} 3 &amp; 0 \\ 0 &amp; -1 \end{bmatrix}.
\]</span></p>
<p>The eigenvalues of a diagonal matrix (in fact, any triangular matrix) are the diagonal entries. Hence the origin is a saddle point.</p>
<p>At the other steady state we have</p>
<p><span class="math display">\[
\mathbf{J}(4,6) = \twomat{0}{-2}{3/2}{0}.
\]</span></p>
<p>The characteristic polynomial is <span class="math inline">\(\lambda^2 + 3\)</span>, so the eigenvalues are <span class="math inline">\(\pm i\sqrt{3}\)</span>. Close to the point, the orbits are impossible to tell apart from those of a linear center:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="linearized_center1.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">linear center</figcaption>
</figure>
</div>
<p>However, as we zoom out, the nonlinearity of the system makes its influence felt:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="linearized_center2.svg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">nonlinear center</figcaption>
</figure>
</div>
<p>For a different system, however, the nonlinearity could cause this point to be asymptotically stable or unstable.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eigen.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Eigenvalues</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Math 351 @ UD
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>