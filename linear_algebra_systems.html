<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.315">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notes for Math 351 @ UD - 4&nbsp; Linear algebraic equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./matrix_algebra.html" rel="next">
<link href="./ivp_second_order.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear_algebra_systems.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebraic equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Notes for Math 351 @ UD</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">MATH 351 Notes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_first_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">First-order IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_second_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Second-order linear IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_algebra_systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebraic equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Matrix algebra</span></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright 2023 by Toby Driscoll</p>
</div></div></nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">4.1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#two-variables" id="toc-two-variables" class="nav-link" data-scroll-target="#two-variables"><span class="header-section-number">4.1.1</span> Two variables</a></li>
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case"><span class="header-section-number">4.1.2</span> General case</a></li>
  </ul></li>
  <li><a href="#row-elimintation" id="toc-row-elimintation" class="nav-link" data-scroll-target="#row-elimintation"><span class="header-section-number">4.2</span> Row elimintation</a>
  <ul class="collapse">
  <li><a href="#gauss-jordan-elimination" id="toc-gauss-jordan-elimination" class="nav-link" data-scroll-target="#gauss-jordan-elimination"><span class="header-section-number">4.2.1</span> Gauss-Jordan elimination</a></li>
  <li><a href="#matrix-form" id="toc-matrix-form" class="nav-link" data-scroll-target="#matrix-form"><span class="header-section-number">4.2.2</span> Matrix form</a></li>
  </ul></li>
  <li><a href="#rref" id="toc-rref" class="nav-link" data-scroll-target="#rref"><span class="header-section-number">4.3</span> RREF</a>
  <ul class="collapse">
  <li><a href="#extended-example" id="toc-extended-example" class="nav-link" data-scroll-target="#extended-example"><span class="header-section-number">4.3.1</span> Extended example</a></li>
  <li><a href="#solution-from-the-rre-form" id="toc-solution-from-the-rre-form" class="nav-link" data-scroll-target="#solution-from-the-rre-form"><span class="header-section-number">4.3.2</span> Solution from the RRE form</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">4.3.3</span> Rank</a></li>
  </ul></li>
  <li><a href="#nullspaces" id="toc-nullspaces" class="nav-link" data-scroll-target="#nullspaces"><span class="header-section-number">4.4</span> Nullspaces</a>
  <ul class="collapse">
  <li><a href="#null-space" id="toc-null-space" class="nav-link" data-scroll-target="#null-space"><span class="header-section-number">4.4.1</span> Null space</a></li>
  <li><a href="#spanning-sets" id="toc-spanning-sets" class="nav-link" data-scroll-target="#spanning-sets"><span class="header-section-number">4.4.2</span> Spanning sets</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">4.4.3</span> Independence</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebraic equations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfb}{\mathbf{b}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfB}{\mathbf{B}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\opA}{\mathcal{A}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\cmn}[2]{\mathbb{C}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diagm}[3]{\begin{bmatrix} #1 &amp; &amp; &amp; \\ &amp; #2 &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; #3 \end{bmatrix}}
    \newcommand{\twovec}[2]{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}
    \newcommand{\threevec}[3]{\begin{bmatrix} #1 \\ #2 \\ #3 \end{bmatrix}}
    \newcommand{\twomat}[4]{\begin{bmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{bmatrix}}
    \newcommand{\twodet}[4]{\begin{vmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{vmatrix}}
    \newcommand{\eye}[1]{\mathbf{e}_#1}
    \newcommand{\meye}{\mathbf{I}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\rank}{\operatorname{rank}}
    \newcommand{\span}{\operatorname{span}}
    \newcommand{\nullsp}{\operatorname{nullsp}}
    \newcommand{\nullity}{\operatorname{nullity}}
    \newcommand{\rowsp}{\operatorname{rowsp}}
    \newcommand{\colsp}{\operatorname{colsp}}
    % \newcommand{\dimen}{\operatorname{dim}}
    \newcommand{\augmat}[2]{\left[ #1 \;\middle|\; #2 \right]}
\]</span></p>
</div>
<div id="b4334007" class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span>, <span class="bu">DifferentialEquations</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span>(label<span class="op">=</span><span class="st">""</span>, linewidth<span class="op">=</span><span class="fl">3</span>, markersize<span class="op">=</span><span class="fl">4</span>, size<span class="op">=</span>(<span class="fl">500</span>,<span class="fl">320</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">4.1</span> Overview</h2>
<p>It might feel silly, but let’s review what it means to solve the linear equation</p>
<p><span class="math display">\[ax = b\]</span></p>
<p>for <span class="math inline">\(x\)</span>.</p>
<ul>
<li>If <span class="math inline">\(a\neq 0\)</span>, there is a unique solution, <span class="math inline">\(x=b/a\)</span>.</li>
<li>Otherwise,
<ul>
<li>If also <span class="math inline">\(b=0\)</span>, then every value of <span class="math inline">\(x\)</span> is a valid solution.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<p>It turns out that no matter how many equations and variables we have, the only three possibilites are the ones above: zero, one, or infinitely many solutions. The main difference is that the condition “<span class="math inline">\(a=0\)</span>” has to be generalized.</p>
<div id="def-linsys-consistent" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 (Consistent linear system) </strong></span>A linear system that has at least one solution is called <strong>consistent</strong>. Otherwise, it is <strong>inconsistent</strong>.</p>
</div>
<section id="two-variables" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="two-variables"><span class="header-section-number">4.1.1</span> Two variables</h3>
<p>Going one more baby step to two equations in two variables, we want to solve</p>
<p><span class="math display">\[
\begin{split}
ax + by &amp;= f, \\
cx + dy &amp;= g.
\end{split}
\]</span></p>
<p>There is some easy geometric intuition here. Each equation represents a straight line in the plane, and solving both equations simultaneously means finding an intersection of these lines. Our cases above translate directly into:</p>
<ul>
<li>If the lines are not parallel, there is a unique solution.</li>
<li>Otherwise,
<ul>
<li>If the lines are identical, there are infinitely many solutions.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<p>It’s not hard to turn those statements into algebraic conditions. The slopes of the two lines are (ignoring infinities for a moment) <span class="math inline">\(-a/b\)</span> and <span class="math inline">\(-c/d\)</span>, and we can say the slopes are equal if and only if <span class="math inline">\(ad=bc\)</span>.</p>
<ul>
<li>If <span class="math inline">\(ad \neq bc\)</span>, there is a single solution.</li>
<li>Otherwise,
<ul>
<li>If one equation is a multiple of the other, there are infinitely many solutions.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1 </strong></span>Find all solutions to the equations</p>
<p><span class="math display">\[
\begin{split}
x - 3y &amp; = 1, \\
-2x + 6y &amp; = 2.
\end{split}
\]</span></p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We identify <span class="math inline">\((a,b,c,d)=(1,-3,-2,6)\)</span>, and <span class="math inline">\(ad-bc=6-6=0\)</span>. So we know there is not a unique solution (i.e., the lines are parallel). Dividing the second equation by <span class="math inline">\(-2\)</span> leads to the equivalent system</p>
<p><span class="math display">\[
\begin{split}
x - 3y &amp; = 1, \\
x - 3y &amp; = -1.
\end{split}
\]</span></p>
<p>It’s now clear that there is no way to satisfy both equations simultaneously. The system is inconsistent.</p>
</div>
</div>
</section>
<section id="general-case" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="general-case"><span class="header-section-number">4.1.2</span> General case</h3>
<p>Time to put on our big-kid pants. For <span class="math inline">\(m\)</span> equations in <span class="math inline">\(n\)</span> variables, we need to use subscripts rather than different letters for everything.</p>
<div id="def-linsys-system" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.2 </strong></span>A <strong>linear-algebraic system</strong>, usually just written <strong>linear system</strong>, is the set of simultaneous equations <span id="eq-linsys-def"><span class="math display">\[
\begin{split}
A_{11} x_1 + A_{12} x_2 + \cdots + A_{1n} x_n &amp; = b_1 \\
A_{21} x_1 + A_{22} x_2 + \cdots + A_{2n} x_n &amp; = b_2 \\
&amp; \vdots \\
A_{m1} x_1 + A_{m2} x_2 + \cdots + A_{mn} x_n &amp; = b_m,
\end{split}
\tag{4.1}\]</span></span> where all the <span class="math inline">\(A_{ij}\)</span> and <span class="math inline">\(b_i\)</span> are assumed to be known. A <strong>solution</strong> of the system is a list of values <span class="math inline">\(x_1,\ldots,x_n\)</span> that makes all the equations true.</p>
</div>
<p>We want to gather similar elements in <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>4.1</span></a> into collective mathematical objects.</p>
<div id="def-linsys-vector" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.3 (Vector) </strong></span>A <strong>vector</strong> is a finite collection of numbers known as its <strong>elements</strong>. The set of all vectors with <span class="math inline">\(n\)</span> real-valued elements is denoted <span class="math inline">\(\real^n\)</span>. If the elements are complex numbers, we use the symbol <span class="math inline">\(\complex^n\)</span>.</p>
</div>
<p>I use boldfaced lowercase letters to represent vectors, and a subscript to refer to an individual element within one. For instance, <span class="math inline">\(x_3\)</span> is the third element of a vector <span class="math inline">\(\bfx\)</span>.</p>
<p>Next, we come to the doubly-indexed values <span class="math inline">\(A_{ij}\)</span>. The first index is the equation number, and the second corresponds to the variable number. This implies a 2D table or array of values.</p>
<div id="def-linsys-matrix" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.4 (Matrix) </strong></span>A <strong>matrix</strong> is an <span class="math inline">\(m\times n\)</span> array of numbers known as its <strong>elements</strong>. The set of all <span class="math inline">\(m\times n\)</span> matrices with real elements is denoted <span class="math inline">\(\rmn{m}{n}\)</span>, and with complex elements it’s <span class="math inline">\(\cmn{m}{n}\)</span>.</p>
</div>
<p>I use boldfaced uppercase letters to represent matrices, and a pair of subscripts to refer to an individual element within one. For instance, <span class="math inline">\(A_{23}\)</span> is the element in row 2, column 3 of the matrix <span class="math inline">\(\bfA\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Matrix subscripts are always in the order row first, column second. (This is the opposite of Excel—which is just one of myriad reasons that Excel is evil.)</p>
</div>
</div>
<p>In the context of <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>4.1</span></a>, we call the <span class="math inline">\(m\times n\)</span> matrix <span class="math inline">\(\bfA\)</span> the <strong>coefficient matrix</strong> of the linear system.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The rows of the coefficient matrix correspond to the equations in the linear system, and the columns correspond to the variables of the system.</p>
</div>
</div>
<p>The vector <span class="math inline">\(\bfb\in\real^m\)</span> implied in <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>4.1</span></a> doesn’t have a standard name, but I will call it the <strong>forcing vector</strong> by analogy with linear ODEs. Altogether, <span class="math inline">\(\bfA\)</span> and <span class="math inline">\(\bfb\)</span> are the data of the linear system, and the vector <span class="math inline">\(\bfx \in \real^{n}\)</span> is the solution.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2 </strong></span>Sometimes zeros are needed as placeholders in the coefficient matrix. In the linear system</p>
<p><span class="math display">\[
\begin{split}
  x_1 - x_2 + 3 x_3 &amp;= 4,\\
  2x_2 + 5x_4 &amp;= -1,
\end{split}
\]</span></p>
<p>the coefficient matrix is <span class="math inline">\(2\times 4\)</span>,</p>
<p><span class="math display">\[
\bfA =
\begin{bmatrix}
1 &amp; -1 &amp; 3 &amp; 0 \\ 0 &amp; 2 &amp; 0 &amp; 5
\end{bmatrix},
\]</span></p>
<p>and the right-side vector is <span class="math inline">\(\twovec{4}{-1}\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can regard a vector <span class="math inline">\(\bfx \in \real^n\)</span> as also being a matrix, in two ways: as a member of <span class="math inline">\(\rmn{1}{n}\)</span>, making it a <strong>row vector</strong>, or as a member of <span class="math inline">\(\rmn{n}{1}\)</span>, making it a <strong>column vector</strong>. Our default is that when we want to interpret a named vector as a matrix, it’s a column vector. Note, however, that Python assumes a row vector, MATLAB lets you choose either, and Julia considers it a column vector. It’s a mess that can lead to frustrating errors in computer codes.</p>
</div>
</div>
</section>
</section>
<section id="row-elimintation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="row-elimintation"><span class="header-section-number">4.2</span> Row elimintation</h2>
<p>You’ve probably solved small systems of equations by substitution. In order to solve systems with more equations and variables, we systematize this idea as an <em>elimination algorithm</em>. The goal of elimination is to transform the system to an equivalent one whose solution(s) we can deduce easily. There are three legal moves in this game:</p>
<div id="def-row_elimination-operations" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.5 (Row operations) </strong></span>&nbsp;</p>
<ol type="1">
<li>Swap the positions of two equations.</li>
<li>Multiply an equation by a nonzero constant.</li>
<li>Add a multiple of one equation to another equation.</li>
</ol>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall that the equations of a linear system correspond to rows of the coefficient matrix <span class="math inline">\(\bfA\)</span> and forcing vector <span class="math inline">\(\bfb\)</span>, hence the name “row operations.”</p>
</div>
</div>
<p>All the row operations are reversible. Therefore, <em>solutions of a linear system remain unchanged after a row operation.</em></p>
<div id="exm-gauss-elimination" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3 </strong></span>Use elimination to solve the <span class="math inline">\(3\times 3\)</span> system</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3 &amp; = 2, \\
3x_1 - 2x_2 &amp; = 9, \\
x_1 - 2x_2 - x_3 &amp; = 5.
\end{split}
\]</span> ::::{.solution} The first step is to use the first equation to eliminate <span class="math inline">\(x_1\)</span> from the second and third equations. We therefore add <span class="math inline">\(-3\)</span> times equation 1 to equation 2, and <span class="math inline">\(-1\)</span> times equation 1 to equation 3:</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
(3x_1 - 2x_2) - 3(x_1 - x_2  - x_3) &amp; = 9 - 3(2),\\
(x_1 - 2x_2 - x_3) - 1(x_1 - x_2  - x_3) &amp; = 5 - 1(2) .
\end{split}
\]</span></p>
<p>This takes us to <span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2,  \\
x_2 + 3x_3 &amp;= 3, \\
-x_2 &amp;= 3.
\end{split}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s tempting to grab that last equation above and use it to remove <span class="math inline">\(x_2\)</span> from everything else. That move certainly works out here. But in the context of a fully automatic algorithm that works every time, we will continue as though the last equation still might contain a dependence on <span class="math inline">\(x_3\)</span>.</p>
</div>
</div>
<p>Next, we leave the first equation alone and use the second to eliminate <span class="math inline">\(x_2\)</span> from all the others below it.</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
x_2 + 3x_3 &amp; = 3, \\
(-x_2) + (x_2+3x_3)  &amp; = 3 + 3.
\end{split}
\]</span></p>
<p>We now have a system in <strong>triangular</strong> form,</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
x_2 + 3x_3 &amp; = 3, \\
3x_3  &amp; = 6.
\end{split}
\]</span></p>
<p>We can now deduce that <span class="math inline">\(x_3=2\)</span> from the last equation. Moving up to the second equation, we then find that <span class="math inline">\(x_2=3-3(2)=-3\)</span>. Finally, the first equation yields <span class="math inline">\(x_1=2+(-3)+(2)=1\)</span>.</p>
</div>
<p>:::::</p>
<p>The process in <a href="#exm-gauss-elimination" class="quarto-xref">Example&nbsp;<span>4.3</span></a> leading to triangular system is commonly known as <strong>Gaussian elimination</strong>. (It’s a poor name, as the process was known at least in China thousands of years before Gauss.) Finding the solution from the triangular form is called <strong>backward substitution</strong>.</p>
<section id="gauss-jordan-elimination" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="gauss-jordan-elimination"><span class="header-section-number">4.2.1</span> Gauss-Jordan elimination</h3>
<p>An alternative to backward substitution is to transform the triangular system into something even simpler.</p>
<div id="exm-gauss-jordan" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4 </strong></span>We continue from the end of <a href="#exm-gauss-elimination" class="quarto-xref">Example&nbsp;<span>4.3</span></a>. Having reached the last variable and equation, we turn around and eliminate <em>upwards</em> instead:</p>
<p><span class="math display">\[
\begin{split}
(x_1 - x_2 - x_3) + \frac{1}{3}(3x_3) &amp; = 2  +\frac{1}{3}(6), \\
(x_2 + 3x_3) - (3x_3) &amp; = 3 - (6),\\
3x_3  &amp; = 6.
\end{split}
\]</span></p>
<p>This leaves the system as <span class="math display">\[
\begin{split}
x_1  -x_2 &amp; = 4,\\
x_2 &amp; = -3,\\
3x_3  &amp; = 6.
\end{split}
\]</span></p>
<p>Moving upwards to the second equation, and use it to eliminate within the one above it:</p>
<p><span class="math display">\[
\begin{split}
(x_1 - x_2 ) + (x_2) &amp; = 4  + (-3),\\
x_2 &amp; = -3,\\
3x_3  &amp; = 6.
\end{split}
\]</span> The system is now trivial: <span class="math inline">\(x_1=1\)</span>, <span class="math inline">\(x_2=-3\)</span>, and <span class="math inline">\(x_3=2\)</span>.</p>
</div>
<p>The process above is called <strong>Gauss–Jordan elimination</strong>, or more simply, <strong>row elimination</strong>.</p>
</section>
<section id="matrix-form" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="matrix-form"><span class="header-section-number">4.2.2</span> Matrix form</h3>
<p>Before generalizing the elimination process, we will lighten the notational load by using matrices.</p>
<div id="def-linsys-augmented" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.6 </strong></span>The <strong>augmented matrix</strong> of the linear system <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>4.1</span></a> is the <span class="math inline">\(m\times (n+1)\)</span> matrix <span class="math inline">\(\mathbf{G} = \augmat{\bfA}{\bfb}\)</span>.</p>
</div>
<p>We start with that contains all the equation coefficients and right-side values.</p>
<p>Let’s look at elimination in this form for the system</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2 - x_3 &amp;= 2, \\
3x_1-2x_2 &amp;= 9, \\
x_1-2x_2-x_3 &amp;= 5.
\end{split}
\]</span></p>
<p>This system has the augmented matrix</p>
<p><span class="math display">\[
\mathbf{G} =
\begin{bmatrix}
1 &amp; -1 &amp; -1 &amp; 2 \\
3 &amp; -2 &amp; 0 &amp; 9 \\
1 &amp; -2 &amp; -1 &amp; 5
\end{bmatrix}.
\]</span></p>
<p>To ease the arithmetic, we do the elimination in Julia.</p>
<div id="3e37f260" class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">Rational</span>.([<span class="fl">1</span> <span class="op">-</span><span class="fl">1</span> <span class="op">-</span><span class="fl">1</span> <span class="fl">2</span>; <span class="fl">3</span> <span class="op">-</span><span class="fl">2</span> <span class="fl">0</span> <span class="fl">9</span>; <span class="fl">1</span> <span class="op">-</span><span class="fl">2</span> <span class="op">-</span><span class="fl">1</span> <span class="fl">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  -1//1  2//1
 3//1  -2//1   0//1  9//1
 1//1  -2//1  -1//1  5//1</code></pre>
</div>
</div>
<p>The first elimination step uses multiples of the first row to eliminate below it.</p>
<div id="7d4ce2a4" class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> G[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-</span> <span class="fl">3</span><span class="op">*</span>G[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  -1//1  2//1
 0//1   1//1   3//1  3//1
 1//1  -2//1  -1//1  5//1</code></pre>
</div>
</div>
<div id="30a8291a" class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-</span> <span class="fl">1</span><span class="op">*</span>G[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  -1//1  2//1
 0//1   1//1   3//1  3//1
 0//1  -1//1   0//1  3//1</code></pre>
</div>
</div>
<p>Next we use the second row to eliminate below it.</p>
<div id="85e5e1f8" class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-=</span> (<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>G[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  -1//1  2//1
 0//1   1//1   3//1  3//1
 0//1   0//1   3//1  6//1</code></pre>
</div>
</div>
<p>Having reached the last row, we turn around and use it to eliminate above it in column 3.</p>
<div id="cc32313d" class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-=</span> <span class="fl">1</span><span class="op">*</span>G[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  -1//1   2//1
 0//1   1//1   0//1  -3//1
 0//1   0//1   3//1   6//1</code></pre>
</div>
</div>
<div id="1bf26d0a" class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-=</span> (<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>)<span class="op">*</span>G[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  -1//1  0//1   4//1
 0//1   1//1  0//1  -3//1
 0//1   0//1  3//1   6//1</code></pre>
</div>
</div>
<p>We move up to the second row and eliminate above that in column 2.</p>
<div id="adf99218" class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-=</span> (<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>G[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  0//1  0//1   1//1
 0//1  1//1  0//1  -3//1
 0//1  0//1  3//1   6//1</code></pre>
</div>
</div>
<p>Finally, to be super pedantic, we normalize the last row by its leading nonzero.</p>
<div id="28f485dd" class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> G[<span class="fl">3</span>,<span class="op">:</span>]<span class="op">/</span>G[<span class="fl">3</span>,<span class="fl">3</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>3×4 Matrix{Rational{Int64}}:
 1//1  0//1  0//1   1//1
 0//1  1//1  0//1  -3//1
 0//1  0//1  1//1   2//1</code></pre>
</div>
</div>
<p>The result is the augmented matrix of the system</p>
<p><span class="math display">\[
\begin{matrix}
x_1 &amp; &amp; &amp;= &amp;1 \\
&amp; x_2 &amp; &amp;= &amp;-3 \\
&amp; &amp; x_3 &amp;= &amp;2,
\end{matrix}
\]</span></p>
<p>whose solution is obvious.</p>
<p>Here’s an example that works out differently, starting from the augmented matrix</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 1 &amp; -1 &amp; 4 \\
1 &amp; 2 &amp; 2 &amp; 3 \\
2 &amp; 1 &amp; -5 &amp; 9
\end{bmatrix}.
\]</span></p>
<p>First, we use multiples of the first row to eliminate in the first column below it.</p>
<div id="ff83a168" class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> [ <span class="fl">1</span> <span class="fl">1</span> <span class="op">-</span><span class="fl">1</span> <span class="fl">4</span>; <span class="fl">1</span> <span class="fl">2</span> <span class="fl">2</span> <span class="fl">3</span>; <span class="fl">2</span> <span class="fl">1</span> <span class="op">-</span><span class="fl">5</span> <span class="fl">9</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> G[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-</span> <span class="fl">1</span><span class="op">*</span>G[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-</span> <span class="fl">2</span><span class="op">*</span>G[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>3×4 Matrix{Int64}:
 1   1  -1   4
 0   1   3  -1
 0  -1  -3   1</code></pre>
</div>
</div>
<p>Now use a multiple of the second row to put a zero underneath it in column 2.</p>
<div id="4e2ba4d6" class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-=</span> (<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>G[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>3×4 Matrix{Int64}:
 1  1  -1   4
 0  1   3  -1
 0  0   0   0</code></pre>
</div>
</div>
<p>We have reached the last row, and it’s time to turn around and eliminate upwards. But because the last row is entirely zero, it can’t make changes to the rows above it. So we skip that and move up to the second row, eliminating upwards in the second column.</p>
<div id="3ea37da4" class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>G[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-=</span> <span class="fl">1</span><span class="op">*</span>G[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>3×4 Matrix{Int64}:
 1  0  -4   5
 0  1   3  -1
 0  0   0   0</code></pre>
</div>
</div>
<p>This is as simple as we can get things. The last row is telling us the astounding fact that <span class="math inline">\(0=0\)</span>—i.e., nothing at all. The other two rows imply</p>
<p><span class="math display">\[
\begin{split}
x_1 &amp;= 5 + 4x_3, \\
x_2 &amp;= -1 - 3x_3.
\end{split}
\]</span></p>
<p>Since the third row gave us no information, we take the attitude that <span class="math inline">\(x_3\)</span> is unrestricted. That is, <span class="math display">\[
\begin{split}
x_1 &amp;= 5 + 4s, \\
x_2 &amp;= -1 - 3s, \\
x_3 &amp;= s.
\end{split}
\]</span></p>
<p>is a solution for any value of <span class="math inline">\(s\)</span>, and we have an infinite family of solutions.</p>
</section>
</section>
<section id="rref" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="rref"><span class="header-section-number">4.3</span> RREF</h2>
<p>It’s time to get more formal and precise about row elimination.</p>
<p>We perform elimination on the augmented matrix. Previously we used row operations going top to bottom on the rows, left to right with the columns, to put the matrix into triangular form. We refer to this process now as the <em>downward phase</em> of elimination.</p>
<div id="def-rref-leading" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.7 </strong></span>The <strong>leading nonzero</strong> of a matrix row is the leftmost nonzero element of that row.</p>
</div>
<div id="thm-linalg-phase1" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.1 (Row elimination downward phase) </strong></span>&nbsp;</p>
<ol type="1">
<li>Set <span class="math inline">\(i=1\)</span>.</li>
<li>Find the leftmost leading nonzero in rows <span class="math inline">\(i\)</span> and below. The column of this leading nonzero is known as the <strong>pivot column</strong>. If no such column exists, stop.</li>
<li>As necessary, swap rows and/or multiply a row by a constant to put a 1 in the pivot column of row <span class="math inline">\(i\)</span>.</li>
<li>Add multiples of row <span class="math inline">\(i\)</span> to the rows below it in order to introduce zeros into the pivot column.</li>
<li>Increment <span class="math inline">\(i\)</span> and return to step 2.</li>
</ol>
</div>
<p>At the end of the downward phase, the augmented matrix is triangular, which is enough for solving a single system through backward substitution. However, it’s not the cleanest form to work with theoretically, so we continue.</p>
<div id="thm-linalg-phase2" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.2 (Row elimination upward phase) </strong></span>&nbsp;</p>
<ol type="1">
<li>Set <span class="math inline">\(i=m\)</span> (the number of equations).</li>
<li>Use multiples of row <span class="math inline">\(i\)</span> to put zeros above the leading 1 in that row.</li>
<li>Decrement <span class="math inline">\(i\)</span>. If <span class="math inline">\(i&gt; 1\)</span>, return to step 2.</li>
</ol>
</div>
<p>At the end of the upward phase, the matrix has been put into a form that we define formally here.</p>
<div id="def-linalg-RREF" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.8 (RRE form) </strong></span>A matrix is in <strong>RRE form</strong> (reduced row-echelon form) if it meets all of these requirements:</p>
<ol type="1">
<li>Any rows of all zeros appear below all nonzero rows.</li>
<li>The leading nonzero of any row is a one.</li>
<li>Every leading 1 that is lower than another leading 1 is also to the right of it.</li>
<li>Every leading 1 is the only nonzero in its column.</li>
</ol>
<p>The columns that have leading ones are called <strong>pivot columns</strong>. The other columns are called <strong>free columns</strong>.</p>
</div>
<p>There are two things that make RRE form useful. One is that it makes a unique target we can always reach:</p>
<div id="thm-RREF-unique" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.3 </strong></span>Every matrix is equivalent to a unique matrix in RRE form.</p>
</div>
<p>The other useful fact is that RRE form completely exposes everything we want to know about a linear system. In fact, everything else we will do theoretically with matrices comes back to the RRE form.</p>
<section id="extended-example" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="extended-example"><span class="header-section-number">4.3.1</span> Extended example</h3>
<p>Here is an example of reduction to RRE form for a linear system</p>
<p><span class="math display">\[
\bfA = \begin{bmatrix}
2 &amp; 0 &amp; 4 &amp; 3 \\ -2 &amp; 0 &amp; 2 &amp; -13 \\ -4 &amp; 5 &amp; -7 &amp; -10 \\ 1 &amp; 15 &amp; 2 &amp; -4.5
\end{bmatrix}, \qquad
\bfb = \begin{bmatrix}
4\\40\\9\\29
\end{bmatrix}.
\]</span></p>
<div id="eb5f2ac9" class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>     <span class="fl">2</span>    <span class="fl">0</span>    <span class="fl">4</span>    <span class="fl">3</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">2</span>    <span class="fl">0</span>    <span class="fl">2</span>  <span class="op">-</span><span class="fl">13</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">4</span>    <span class="fl">5</span>   <span class="op">-</span><span class="fl">7</span>  <span class="op">-</span><span class="fl">10</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span>   <span class="fl">15</span>    <span class="fl">2</span>   <span class="op">-</span><span class="fl">4.5</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    ];</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [ <span class="fl">4</span>, <span class="fl">40</span>, <span class="fl">9</span>, <span class="fl">29</span> ];</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> [A b]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>4×5 Matrix{Float64}:
  2.0   0.0   4.0    3.0   4.0
 -2.0   0.0   2.0  -13.0  40.0
 -4.0   5.0  -7.0  -10.0   9.0
  1.0  15.0   2.0   -4.5  29.0</code></pre>
</div>
</div>
<p>We start at the top, working downward and rightward. In the first row, the leading nonzero occurs in column 1, which is the pivot column for this row. We normalize this row so that the leading nonzero is a 1.</p>
<div id="8dcd45ab" class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">1</span>,<span class="op">:</span>]<span class="op">/</span>S[<span class="fl">1</span>,<span class="fl">1</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>4×5 Matrix{Float64}:
  1.0   0.0   2.0    1.5   2.0
 -2.0   0.0   2.0  -13.0  40.0
 -4.0   5.0  -7.0  -10.0   9.0
  1.0  15.0   2.0   -4.5  29.0</code></pre>
</div>
</div>
<p>Now multiples of row 1 are added to the rows below it in order to put zeros in the first column.</p>
<div id="5a8340dc" class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">2</span>,<span class="fl">1</span>]<span class="op">*</span>S[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">3</span>,<span class="fl">1</span>]<span class="op">*</span>S[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">4</span>,<span class="fl">1</span>]<span class="op">*</span>S[<span class="fl">1</span>,<span class="op">:</span>]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>4×5 Matrix{Float64}:
 1.0   0.0  2.0    1.5   2.0
 0.0   0.0  6.0  -10.0  44.0
 0.0   5.0  1.0   -4.0  17.0
 0.0  15.0  0.0   -6.0  27.0</code></pre>
</div>
</div>
<p>Looking at rows 2 to 4, we see that the leftmost nonzero occurs in column 2. Since row 2 has a zero there, we swap rows 2 and 3 to bring a nonzero up.</p>
<div id="2aa97140" class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> S[[<span class="fl">3</span>,<span class="fl">2</span>],<span class="op">:</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>4×5 Matrix{Float64}:
 1.0   0.0  2.0    1.5   2.0
 0.0   5.0  1.0   -4.0  17.0
 0.0   0.0  6.0  -10.0  44.0
 0.0  15.0  0.0   -6.0  27.0</code></pre>
</div>
</div>
<p>Now we normalize row 2 so that the leading nonzero is a 1.</p>
<div id="70c72eee" class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">2</span>,<span class="op">:</span>]<span class="op">/</span>S[<span class="fl">2</span>,<span class="fl">2</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>4×5 Matrix{Float64}:
 1.0   0.0  2.0    1.5   2.0
 0.0   1.0  0.2   -0.8   3.4
 0.0   0.0  6.0  -10.0  44.0
 0.0  15.0  0.0   -6.0  27.0</code></pre>
</div>
</div>
<p>Multiples of row 2 are now used to put zeros below it in the pivot column.</p>
<div id="ed04a025" class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">3</span>,<span class="fl">2</span>]<span class="op">*</span>S[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">4</span>,<span class="fl">2</span>]<span class="op">*</span>S[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0   2.0    1.5    2.0
 0.0  1.0   0.2   -0.8    3.4
 0.0  0.0   6.0  -10.0   44.0
 0.0  0.0  -3.0    6.0  -24.0</code></pre>
</div>
</div>
<p>Rows 3 and 4 have a pivot in column 3, and we only need to normalize row 3 to make it 1. Then we subtract a multiple of row 3 from row 4 to put a zero beneath it.</p>
<div id="7db67ab0" class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">3</span>,<span class="op">:</span>]<span class="op">/</span>S[<span class="fl">3</span>,<span class="fl">3</span>];</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">4</span>,<span class="fl">3</span>]<span class="op">*</span>S[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0  2.0   1.5       2.0
 0.0  1.0  0.2  -0.8       3.4
 0.0  0.0  1.0  -1.66667   7.33333
 0.0  0.0  0.0   1.0      -2.0</code></pre>
</div>
</div>
<p>We complete the downward phase by normalizing row 4 to get a leading 1.</p>
<div id="2535713e" class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">4</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">4</span>,<span class="op">:</span>]<span class="op">/</span>S[<span class="fl">4</span>,<span class="fl">4</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0  2.0   1.5       2.0
 0.0  1.0  0.2  -0.8       3.4
 0.0  0.0  1.0  -1.66667   7.33333
 0.0  0.0  0.0   1.0      -2.0</code></pre>
</div>
</div>
<p>Now we turn around for the upward phase. The leading 1 in row 4 needs to have zeros above it. We accomplish that by subtracting multiples of row 4 from the others.</p>
<div id="836e8adb" class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">3</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">3</span>,<span class="fl">4</span>]<span class="op">*</span>S[<span class="fl">4</span>,<span class="op">:</span>]</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">2</span>,<span class="fl">4</span>]<span class="op">*</span>S[<span class="fl">4</span>,<span class="op">:</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">1</span>,<span class="fl">4</span>]<span class="op">*</span>S[<span class="fl">4</span>,<span class="op">:</span>]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0  2.0  0.0   5.0
 0.0  1.0  0.2  0.0   1.8
 0.0  0.0  1.0  0.0   4.0
 0.0  0.0  0.0  1.0  -2.0</code></pre>
</div>
</div>
<p>We move up to row 3 and use multiples of it to put zeros above its leading 1.</p>
<div id="7131375b" class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">2</span>,<span class="fl">3</span>]<span class="op">*</span>S[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">1</span>,<span class="fl">3</span>]<span class="op">*</span>S[<span class="fl">3</span>,<span class="op">:</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0  0.0  0.0  -3.0
 0.0  1.0  0.0  0.0   1.0
 0.0  0.0  1.0  0.0   4.0
 0.0  0.0  0.0  1.0  -2.0</code></pre>
</div>
</div>
<p>The last move is to use a multiple of row 2 to put a zero above its leading 1. As it has played out in this example, this line of code changes nothing because the position was already zero.</p>
<div id="a250b311" class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">=</span> S[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">-</span> S[<span class="fl">1</span>,<span class="fl">2</span>]<span class="op">*</span>S[<span class="fl">2</span>,<span class="op">:</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>4×5 Matrix{Float64}:
 1.0  0.0  0.0  0.0  -3.0
 0.0  1.0  0.0  0.0   1.0
 0.0  0.0  1.0  0.0   4.0
 0.0  0.0  0.0  1.0  -2.0</code></pre>
</div>
</div>
<p>This matrix is in RREF. We interpret it as the trivial linear system</p>
<p><span class="math display">\[
\begin{split}
x_1 &amp;= -3,\\ x_2 &amp;= 1,\\ x_3 &amp;= 4, \\ x_4 &amp;= -2.
\end{split}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can <a href="&quot;https://www.wolframalpha.com/input/?i=rref {{1%2C2%2C3}%2C{4%2C5%2C6}%2C{7%2C8%2C9}}&quot;">use Wolfram Alpha</a> for finding the RRE form of a matrix.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>While MATLAB has an <code>rref</code> command, it should not be relied on. It isn’t really MATLAB’s fault; the RRE form is a terrible target for numerical computations, because it is infinitely sensitive to rounding errors, and MATLAB calculates using numerical approximations for speed.</p>
</div>
</div>
</section>
<section id="solution-from-the-rre-form" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="solution-from-the-rre-form"><span class="header-section-number">4.3.2</span> Solution from the RRE form</h3>
<p>The RRE form of an augmented matrix represents a linear system that we can solve by inspection:</p>
<ol type="1">
<li>Ignore all zero rows.</li>
<li>If a leading one occurs in the last column, the system is inconsistent.</li>
<li>Otherwise, each variable associated with a free column is assigned to a free parameter (e.g., <span class="math inline">\(s\)</span>, <span class="math inline">\(t\)</span>, etc.).</li>
<li>Use the pivot columns to solve for their corresponding variables in terms of the free parameters.</li>
</ol>
<div id="exm-RREF-multiple" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5 </strong></span>A linear system has an augmented matrix equivalent to the RRE form</p>
<p><span class="math display">\[
\begin{bmatrix}
0 &amp; 1 &amp; -3 &amp; 0 &amp; 2 \\
0 &amp; 0 &amp; 0  &amp; 1 &amp; -4 \\
0 &amp; 0 &amp; 0  &amp; 0 &amp; 0  \\
0 &amp; 0 &amp; 0  &amp; 0 &amp; 0  
\end{bmatrix}.
\]</span></p>
<p>Find all solutions to the linear system.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The last two rows have no information and can be ignored. Columns 2 and 4 are pivot columns. We give variables from the other columns arbitrary values, <span class="math inline">\(x_1=s\)</span> and <span class="math inline">\(x_3=t\)</span>. The pivot variables are solved in terms of these to get <span class="math inline">\(x_2=2+3t\)</span> and <span class="math inline">\(x_4=-4\)</span>. All solutions are expressed as the vector</p>
<p><span class="math display">\[
\bfx = \begin{bmatrix}
s \\ 2+3t \\ t \\ -4
\end{bmatrix}, \qquad s,t\in \real.
\]</span></p>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.6 </strong></span>A linear system has an augmented matrix equivalent to the RRE form</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 0 &amp; -4 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 1  &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0  &amp; 1 &amp; 0  \\
0 &amp; 0 &amp; 0  &amp; 0 &amp; 1
\end{bmatrix}.
\]</span></p>
<p>Find all solutions to the linear system.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Look at the last row of the system. It expresses the equation <span class="math inline">\(0=1\)</span>, which is impossible to satisfy. Thus the system is inconsistent.</p>
</div>
</div>
</section>
<section id="rank" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">4.3.3</span> Rank</h3>
<p>Leaving aside the actual calculation of solutions, a glance at the RRE form tells us instantly whether the system has no solution, a unique solution, or infinitely many solutions. Because of the requirements on leading ones in the RREF definition, the outcomes are constrained simply by how many of those ones there are.</p>
<div id="def-RREF-rank" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.9 (Rank) </strong></span>The <strong>rank</strong> of a matrix is the number of pivot columns in its RRE form, i. e., the number of leading ones.</p>
</div>
<div id="thm-RREF-rank" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.4 </strong></span>If <span class="math inline">\(\bfA\)</span> is an <span class="math inline">\(m\times n\)</span> matrix, then <span class="math inline">\(\rank(\bfA) \le m\)</span> and <span class="math inline">\(\rank(\bfA) \le n\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Each leading one in the RRE form requires a row and column of its own.</p>
</div>
<div id="thm-RREF-deficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.5 </strong></span>Suppose <span class="math inline">\(\bfA\)</span> is <span class="math inline">\(m\times n\)</span>. If <span class="math inline">\(\rank(\bfA)&lt;n\)</span>, then the linear system with augmented matrix <span class="math inline">\(\augmat{\bfA\}{\bfb}\)</span> cannot have a unique solution. It is inconsistent for some choices of <span class="math inline">\(\bfb\)</span> and has infinitely many solutions for other choices of <span class="math inline">\(\bfb\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(r=\rank(\bfA)\)</span>. Then the RRE form of <span class="math inline">\(\bfA\)</span> has all zero elements in rows <span class="math inline">\(r+1\)</span> to <span class="math inline">\(m\)</span>. Now augment <span class="math inline">\(\bfA\)</span> with <span class="math inline">\(\bfb\)</span> and perform the row operations that reduce <span class="math inline">\(\bfA\)</span> to RRE form. If there are any nonzeros in rows <span class="math inline">\(r+1\)</span> to <span class="math inline">\(m\)</span> of the last column, the system is inconsistent. Otherwise, the system has at least one free variable. We can start with either type of outcome and run the row elimination process backward to find a <span class="math inline">\(\bfb\)</span> that led to it.</p>
</div>
<div id="cor-RREF-nonunique" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 4.1 </strong></span>A linear system with more variables than equations cannot have a unique solution.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math inline">\(\rank(\bfA) \le m &lt; n\)</span>.</p>
</div>
</section>
</section>
<section id="nullspaces" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="nullspaces"><span class="header-section-number">4.4</span> Nullspaces</h2>
<p>There are only three possible outcomes for a linear system, all deducible from the RRE form of the augmented matrix:</p>
<ol type="1">
<li>There is a leading 1 in the last column, in which case there are no solutions.</li>
<li>There are fewer pivot columns than variables, in which case there are infinitely many solutions.</li>
<li>There is a unique solution.</li>
</ol>
<p>There is an important situation where we can rule out case 1 above.</p>
<div id="def-nullspace-def" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.10 (Homogeneous linear system) </strong></span>A <strong>homogeneous</strong> linear system is one that has forcing vector <span class="math inline">\(\bfb\)</span> equal to zero.</p>
</div>
<p>As the following theorem points out, we can work with just the RRE form of the coefficient matrix <span class="math inline">\(\bfA\)</span> instead of the augmented matrix of a homogeneous system.</p>
<div id="thm-nullspace-rref" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.6 </strong></span>For a homogeneous linear system, the last column of the RRE form of the augmented matrix is a zero vector.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Row operations can’t change the zeros in that column.</p>
</div>
<section id="null-space" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="null-space"><span class="header-section-number">4.4.1</span> Null space</h3>
<div id="def-nullspace-nullspace" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.11 </strong></span>The <strong>null space</strong> of a matrix <span class="math inline">\(\bfA\)</span>, written <span class="math inline">\(\nullsp(\bfA)\)</span>, is the set of all solutions to the homogeneous linear system with coefficient matrix <span class="math inline">\(\bfA\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sometimes the null space is called the <em>kernel</em> of the matrix.</p>
</div>
</div>
<!-- As the name implies, the null space is our first example of what we will call a *subspace*. We won't worry about that definition just yet. -->
<p>For a homogeneous linear system, the zero vector <span class="math inline">\(\bfx=\bfzero\)</span> is always a solution. The only interesting question is whether zero is the <em>only</em> solution. Thus, we only need to look at case 2 from the beginning of this section.</p>
<p>The following follows immediately from our definitions. (That happens a lot in linear algebra: all the work is in the setup, not the punchline.)</p>
<div id="thm-nullspace-uniquenes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.7 </strong></span>A homogeneous system in <span class="math inline">\(n\)</span> variables with coefficient matrix <span class="math inline">\(\bfA\)</span> has a unique solution if and only if <span class="math inline">\(\rank(\bfA)=n\)</span>.</p>
</div>
<div id="cor-nullspace-uniqueness" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 4.2 </strong></span>A homogeneous linear system with more variables than equations has infinitely many solutions.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math inline">\(\rank(\bfA) \le m &lt; n\)</span>.</p>
</div>
</section>
<section id="spanning-sets" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="spanning-sets"><span class="header-section-number">4.4.2</span> Spanning sets</h3>
<p>When we do have infinitely many solutions in a homogeneous linear system, it’s nice to have a finite description of all of them. This takes us on a considerable side quest.</p>
<div id="def-nullspace-linear-comb" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.12 (Linear combination and span) </strong></span>A <strong>linear combination</strong> of vectors <span class="math inline">\(\bfv_1, \ldots, \bfv_k\)</span> with <strong>coefficients</strong> <span class="math inline">\(c_1,\ldots,c_k\)</span> is the vector</p>
<p><span class="math display">\[
c_1 \bfv_1 + c_2 \bfv_2 + \cdots + c_k \bfv_k.
\]</span></p>
<p>The set of all linear combinations of <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span> is known as the <strong>span</strong> of those vectors. The span of an empty set is the set consisting of only the zero vector.</p>
</div>
<p>Statements about linear combinations can be transformed into statements about linear systems of equations.</p>
<div id="exm-nullspace-combo" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.7 </strong></span>Show that <span class="math inline">\(\bfv=[1,4,3]\)</span> is in the span of <span class="math inline">\(\bfu_1=[1,-2,-1]\)</span> and <span class="math inline">\(\bfu_2=[3,0,1]\)</span>. (That is, <span class="math inline">\(\bfv\)</span> can be written as a linear combination of these two vectors.)</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Suppose that <span class="math inline">\(\bfv = c_1 \bfu_1 + c_2 \bfu_2\)</span>. Looking at each component of this vector equation, we conclude that</p>
<p><span class="math display">\[
\begin{split}
  c_1 + 3c_2 &amp;= 1 \\
  -2c_1 + 0c_2 &amp;= 4 \\
  -c_1 + c_2 &amp;= 3,
\end{split}
\]</span></p>
<p>which is a linear system with augmented matrix</p>
<p><span class="math display">\[
\augmat{
\begin{matrix}
  1 &amp; 3  \\ -2 &amp; 0  \\ -1 &amp; 1
\end{matrix}}{
    \begin{matrix}
   1 \\  4 \\  3
\end{matrix}}
\]</span></p>
<p>The RRE form of this matrix is</p>
<p><span class="math display">\[
\augmat{
\begin{matrix}
  1 &amp; 0  \\ 0 &amp; 1  \\ 0 &amp; 0
\end{matrix}}{
    \begin{matrix}
   -2 \\  1 \\  0
\end{matrix}
}
\]</span></p>
<p>which is consistent. In fact, the unique solution is <span class="math inline">\(c_2=1\)</span>, <span class="math inline">\(c_1=2\)</span>.</p>
</div>
</div>
<p>A nontrivial null space (i. e., containing more than the zero vector) can always be described as the span of finitely many vectors.</p>
<div id="exm-nullspace-span" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.8 </strong></span>Suppose the RRE form of a matrix <span class="math inline">\(\bfA\)</span> is</p>
<p><span class="math display">\[
\mathbf{R} =
\begin{bmatrix}
0 &amp; 1 &amp; 4 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0  &amp; 1 &amp; -3 \\
0 &amp; 0 &amp; 0  &amp; 0 &amp; 0  \\
0 &amp; 0 &amp; 0  &amp; 0 &amp; 0
\end{bmatrix}.
\]</span></p>
<p>Therefore, the RRE form of the augmented matrix <span class="math inline">\(\augmat{\mathbf{A}}{\boldsymbol{0}}\)</span> is <span class="math inline">\(\augmat{\mathbf{R}}{\boldsymbol{0}}\)</span>. The pivot columns are 2 and 4, which makes <span class="math inline">\(x_1=r\)</span>, <span class="math inline">\(x_3=s\)</span>, and <span class="math inline">\(x_5=t\)</span> free variables. The nonzero rows lead to</p>
<p><span class="math display">\[
\begin{split}
x_2 + 4x_3 + x_5 &amp;= 0 &amp;\quad ⇒ \quad x_2 &amp;= -4s-t,\\
x_4 -3x_5 &amp;= 0 &amp; \quad ⇒ \quad x_4 &amp;= 3t.
\end{split}
\]</span></p>
<p>One way to express a generic solution vector in the null space is by a linear combination of constant vectors:</p>
<p><span class="math display">\[
\begin{bmatrix}
  r \\ -4s-t \\ s \\ 3t\\ t
\end{bmatrix}
= r \begin{bmatrix}
  1 \\ 0 \\ 0 \\ 0 \\ 0
\end{bmatrix}
+ s \begin{bmatrix}
  0 \\ -4 \\ 0 \\ 1 \\ 0
\end{bmatrix}
+ t \begin{bmatrix}
  0 \\ -1 \\ 0 \\ 3 \\ 1
\end{bmatrix} = r\bfv_1 + s\bfv_2 + t\bfv_3 .
\]</span></p>
<p>Hence <span class="math inline">\(\nullsp(\bfA)=\span(\bfv_1,\bfv_2,\bfv_3)\)</span>, where the <span class="math inline">\(\bfv_j\)</span> are the constant vectors above.</p>
</div>
</section>
<section id="independence" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="independence"><span class="header-section-number">4.4.3</span> Independence</h3>
<p>Now that we have a finite description of the null space, we want to refine it to make sure that it is as simple as possible. For this, we need a new take on an old friend.</p>
<div id="def-nullspace-indepdendence" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4.13 (Linear independence) </strong></span>Vectors <span class="math inline">\(\bfv_1,\bfv_2,\ldots,\bfv_n\)</span> are <strong>linearly dependent</strong> if there is a way to choose constants <span class="math inline">\(c_1,\ldots,c_n\)</span>, <em>not all zero</em>, such that</p>
<p><span class="math display">\[
c_1\bfv_1 + c_2\bfv_2 + \cdots c_n \bfv_n = 0.
\]</span></p>
<p>If the vectors are not linearly dependent, then they are <strong>linearly independent</strong>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sound familiar? Stay tuned!</p>
</div>
</div>
<p>Because linear combinations are equivalent to linear systems, statements about linear independence are equivalent to statements about homogeneous linear systems, and therefore about null spaces.</p>
<div id="exm-nullspace-dependent" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.9 </strong></span>Determine whether the vectors <span class="math inline">\(\bfv_1=\threevec{1}{0}{-2}\)</span>, <span class="math inline">\(\bfv_2=\threevec{1}{0}{1}\)</span>, and <span class="math inline">\(\bfv_3 = \threevec{0}{0}{-1}\)</span> are linearly independent. :::{.solution} These vectors are dependent if, and only if, we can find <span class="math inline">\(c_1,c_2,c_3\)</span>, not all zero, such that</p>
<p><span class="math display">\[
c_1 \bfv_1 + c_2 \bfv_2 + c_3 \bfv_3 = \bfzero.
\]</span></p>
<p>Equating components on the two sides of this equation leads to the linear system with augmented matrix</p>
<p><span class="math display">\[
\augmat{
    \begin{matrix}
    1 &amp; 1 &amp; 0  \\ 0 &amp; 0 &amp; 0  \\ -2 &amp; 1 &amp; -1
    \end{matrix}}{
\begin{matrix}
    0 \\  0 \\  0
    \end{matrix}
}
\]</span></p>
<p>The RRE form of this system is</p>
<p><span class="math display">\[
\augmat{
    \begin{matrix}
    1 &amp; 0 &amp; \frac{1}{3}  \\ 0 &amp; 1 &amp; -\frac{1}{3}  \\ 0 &amp; 0 &amp; 0
    \end{matrix}}{
\begin{matrix}
    0 \\  0 \\  0
    \end{matrix}
}
\]</span></p>
<p>whose solutions are <span class="math inline">\([-t/3,t/3,t]\)</span> for all <span class="math inline">\(t\)</span>. Since there are nonzero solutions to the linear system, the original set of vectors is linearly dependent.</p>
</div>
<p>::::</p>
<p>The result of the preceding example is worth stating on the record. It’s basically just a fusion of equivalent terminology.</p>
<div id="thm-nullspace-dependence" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4.8 </strong></span>Suppose <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span> are vectors in <span class="math inline">\(\real^n\)</span>, and let <span class="math inline">\(\bfA\)</span> be the matrix whose columns are <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span>. Then these vectors are linearly dependent if and only if <span class="math inline">\(\bfA\)</span> has a null space containing more than the zero vector.</p>
</div>
<p>Dependent vectors can lengthen the description of a spanned space without actually contributing any information.</p>
<div id="exm-nullspace-dependentspan" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.10 </strong></span>The result of <a href="#exm-nullspace-dependent" class="quarto-xref">Example&nbsp;<span>4.9</span></a> is that <span class="math inline">\(\bfv_1=\threevec{1}{0}{-2}\)</span>, <span class="math inline">\(\bfv_2=\threevec{1}{0}{1}\)</span>, and <span class="math inline">\(\bfv_3 = \threevec{0}{0}{-1}\)</span> are linearly dependent. For instance,</p>
<p><span class="math display">\[
\bfv_1 - \bfv_2 + 3 \bfv_3 = \bfzero.
\]</span></p>
<p>Therefore, any vector in <span class="math inline">\(\span(\bfv_1,\bfv_2,\bfv_3)\)</span> can be written as</p>
<p><span class="math display">\[
\begin{split}
c_1 \bfv_1 + c_2 \bfv_2 + c_3 \bfv_3 &amp;= c_1(\bfv_2 - 3 \bfv_3) + c_2 \bfv_2 + c_3 \bfv_3 \\
&amp;= (c_1+c_2) \bfv_2 + (c_3- 3c_1)\bfv_3.
\end{split}
\]</span></p>
<p>Hence <span class="math inline">\(\span(\bfv_1,\bfv_2,\bfv_3) = \span(\bfv_2,\bfv_3)\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <a href="#exm-nullspace-dependentspan" class="quarto-xref">Example&nbsp;<span>4.10</span></a>, we could have removed <span class="math inline">\(\bfv_2\)</span> or <span class="math inline">\(\bfv_3\)</span> from the spanning set instead without changing the spanned result. The only requirement is that the coefficient of the removed vector is not zero in the linear combination of them that makes zero.</p>
</div>
</div>
<p>A set of vectors that both spans the null space and is linearly independent is called a <strong>basis</strong> of the null space. We’ll formalize that idea when we discuss subspaces more generally. For now, just know that a basis is a minimal set of vectors that can get the spanning job done.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ivp_second_order.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Second-order linear IVPs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./matrix_algebra.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Matrix algebra</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Math 351 @ UD
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>