<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notes for Math 351 @ UD - 3&nbsp; Linear algebraic systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./matrix_algebra.html" rel="next">
<link href="./ivp_second_order.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script> 
MathJax = {
  chtml: {
    scale: 0.92,
  }
}
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear_algebra_systems.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear algebraic systems</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Notes for Math 351 @ UD</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_first_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First-order IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp_second_order.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Second-order linear IVPs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_algebra_systems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear algebraic systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matrix algebra</span></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<p>Copyright 2023 by Toby Driscoll</p>
</div></div></nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">3.1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#two-variables" id="toc-two-variables" class="nav-link" data-scroll-target="#two-variables"><span class="header-section-number">3.1.1</span> Two variables</a></li>
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case"><span class="header-section-number">3.1.2</span> General case</a></li>
  </ul></li>
  <li><a href="#row-elimination" id="toc-row-elimination" class="nav-link" data-scroll-target="#row-elimination"><span class="header-section-number">3.2</span> Row elimination</a>
  <ul class="collapse">
  <li><a href="#augmented-matrix" id="toc-augmented-matrix" class="nav-link" data-scroll-target="#augmented-matrix"><span class="header-section-number">3.2.1</span> Augmented matrix</a></li>
  <li><a href="#row-echelon-form" id="toc-row-echelon-form" class="nav-link" data-scroll-target="#row-echelon-form"><span class="header-section-number">3.2.2</span> Row echelon form</a></li>
  </ul></li>
  <li><a href="#rre-form" id="toc-rre-form" class="nav-link" data-scroll-target="#rre-form"><span class="header-section-number">3.3</span> RRE form</a>
  <ul class="collapse">
  <li><a href="#solution-from-the-rre-form" id="toc-solution-from-the-rre-form" class="nav-link" data-scroll-target="#solution-from-the-rre-form"><span class="header-section-number">3.3.1</span> Solution from the RRE form</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">3.3.2</span> Rank</a></li>
  </ul></li>
  <li><a href="#linear-combinations" id="toc-linear-combinations" class="nav-link" data-scroll-target="#linear-combinations"><span class="header-section-number">3.4</span> Linear combinations</a>
  <ul class="collapse">
  <li><a href="#span" id="toc-span" class="nav-link" data-scroll-target="#span"><span class="header-section-number">3.4.1</span> Span</a></li>
  <li><a href="#homogeneous-systems" id="toc-homogeneous-systems" class="nav-link" data-scroll-target="#homogeneous-systems"><span class="header-section-number">3.4.2</span> Homogeneous systems</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">3.4.3</span> Independence</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear algebraic systems</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<div class="hidden">
<p><span class="math display">\[
    \newcommand{\float}{\mathbb{F}}
    \newcommand{\real}{\mathbb{R}}
    \newcommand{\complex}{\mathbb{C}}
    \newcommand{\nat}{\mathbb{N}}
    \newcommand{\integer}{\mathbb{Z}}
    \newcommand{\bfa}{\mathbf{a}}
    \newcommand{\bfb}{\mathbf{b}}
    \newcommand{\bfc}{\mathbf{c}}
    \newcommand{\bfe}{\mathbf{e}}
    \newcommand{\bff}{\mathbf{f}}
    \newcommand{\bfh}{\mathbf{h}}
    \newcommand{\bfp}{\mathbf{p}}
    \newcommand{\bfq}{\mathbf{q}}
    \newcommand{\bfu}{\mathbf{u}}
    \newcommand{\bfv}{\mathbf{v}}
    \newcommand{\bfw}{\mathbf{w}}
    \newcommand{\bfx}{\mathbf{x}}
    \newcommand{\bfy}{\mathbf{y}}
    \newcommand{\bfz}{\mathbf{z}}
    \newcommand{\bfA}{\mathbf{A}}
    \newcommand{\bfB}{\mathbf{B}}
    \newcommand{\bfD}{\mathbf{D}}
    \newcommand{\bfE}{\mathbf{E}}
    \newcommand{\bfV}{\mathbf{V}}
    \newcommand{\bfW}{\mathbf{W}}
    \newcommand{\bfX}{\mathbf{X}}
    \newcommand{\fundm}{\boldsymbol{\Phi}}
    \newcommand{\bfzero}{\boldsymbol{0}}
    \newcommand{\bfmu}{\boldsymbol{\mu}}
    \newcommand{\opA}{\mathcal{A}}
    \newcommand{\rmn}[2]{\mathbb{R}^{#1 \times #2}}
    \newcommand{\cmn}[2]{\mathbb{C}^{#1 \times #2}}
    \newcommand{\dd}[2]{\frac{d #1}{d #2}}
    \newcommand{\ddd}[2]{\frac{d^2 #1}{d #2^2}}
    \newcommand{\pp}[2]{\frac{\partial #1}{\partial #2}}
    \newcommand{\norm}[1]{\left\lVert \mathstrut #1 \right\rVert}
    \newcommand{\abs}[1]{\left\lvert \mathstrut #1 \right\rvert}
    \newcommand{\twonorm}[1]{\norm{#1}_2}
    \newcommand{\onenorm}[1]{\norm{#1}_1}
    \newcommand{\infnorm}[1]{\norm{#1}_\infty}
    \newcommand{\innerprod}[2]{\langle #1,#2 \rangle}
    \newcommand{\pr}[1]{^{(#1)}}
    \newcommand{\diagm}[3]{\begin{bmatrix} #1 &amp; &amp; &amp; \\ &amp; #2 &amp; &amp; \\ &amp; &amp; \ddots &amp; \\ &amp; &amp; &amp; #3 \end{bmatrix}}
    \newcommand{\twovec}[2]{\begin{bmatrix} #1 \\ #2 \end{bmatrix}}
    \newcommand{\threevec}[3]{\begin{bmatrix} #1 \\ #2 \\ #3 \end{bmatrix}}
    \newcommand{\twomat}[4]{\begin{bmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{bmatrix}}
    \newcommand{\twodet}[4]{\begin{vmatrix} #1 &amp; #2 \\ #3 &amp; #4 \end{vmatrix}}
    \newcommand{\eye}[1]{\mathbf{e}_#1}
    \newcommand{\meye}{\mathbf{I}}
    \newcommand{\diag}{\operatorname{diag}}
    \newcommand{\sign}{\operatorname{sign}}
    \newcommand{\dist}{\operatorname{dist}}
    \newcommand{\simil}{\operatorname{sim}}
    \newcommand{\ee}{\times 10^}
    \newcommand{\floor}[1]{\lfloor#1\rfloor}
    \newcommand{\argmin}{\operatorname{argmin}}
    \newcommand{\rank}{\operatorname{rank}}
    \newcommand{\span}{\operatorname{span}}
    \newcommand{\nullsp}{\operatorname{nullsp}}
    \newcommand{\nullity}{\operatorname{nullity}}
    \newcommand{\rowsp}{\operatorname{rowsp}}
    \newcommand{\colsp}{\operatorname{colsp}}
    % \newcommand{\dimen}{\operatorname{dim}}
    \newcommand{\augmat}[2]{\left[ #1 \;\middle|\; #2 \right]}
\]</span></p>
</div>
<section id="overview" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="overview"><span class="header-section-number">3.1</span> Overview</h2>
<p>It might feel silly, but let’s review what it means to solve the linear equation</p>
<p><span class="math display">\[ax = b\]</span></p>
<p>for <span class="math inline">\(x\)</span>.</p>
<ul>
<li>If <span class="math inline">\(a\neq 0\)</span>, there is a unique solution, <span class="math inline">\(x=b/a\)</span>.</li>
<li>Otherwise,
<ul>
<li>If also <span class="math inline">\(b=0\)</span>, then every value of <span class="math inline">\(x\)</span> is a valid solution.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<p>It turns out that no matter how many equations and variables we have, the only three possibilities are the ones above: zero, one, or infinitely many solutions. The main difference is that the condition “<span class="math inline">\(a=0\)</span>” has to be generalized.</p>
<div id="def-linsys-consistent" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.1 (Consistent linear system) </strong></span>A linear system that has at least one solution is called <strong>consistent</strong>. Otherwise, it is <strong>inconsistent</strong>.</p>
</div>
<section id="two-variables" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="two-variables"><span class="header-section-number">3.1.1</span> Two variables</h3>
<p>Going one more baby step to two equations in two variables, we want to solve</p>
<p><span class="math display">\[
\begin{split}
ax + by &amp;= f, \\
cx + dy &amp;= g.
\end{split}
\]</span></p>
<p>There is some easy geometric intuition here. Each equation represents a straight line in the plane, and solving both equations simultaneously means finding an intersection of these lines. Our cases above translate directly into:</p>
<ul>
<li>If the lines are not parallel, there is a unique solution.</li>
<li>Otherwise,
<ul>
<li>If the lines are identical, there are infinitely many solutions.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<p>It’s not hard to turn those statements into algebraic conditions. The slopes of the two lines are (ignoring infinities for a moment) <span class="math inline">\(-a/b\)</span> and <span class="math inline">\(-c/d\)</span>, and we can say the slopes are equal if and only if <span class="math inline">\(ad=bc\)</span>.</p>
<ul>
<li>If <span class="math inline">\(ad \neq bc\)</span>, there is a single solution.</li>
<li>Otherwise,
<ul>
<li>If one equation is a multiple of the other, there are infinitely many solutions.</li>
<li>Otherwise, there are no solutions.</li>
</ul></li>
</ul>
<div id="exm-two-equations" class="theorem example" data-chapter="3" data-description="Two linear equations">
<p><span class="theorem-title"><strong>Example 3.1 </strong></span>Find all solutions to the equations</p>
<p><span class="math display">\[
\begin{split}
x - 3y &amp; = 1, \\
-2x + 6y &amp; = 2.
\end{split}
\]</span></p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We identify <span class="math inline">\((a,b,c,d)=(1,-3,-2,6)\)</span>, and <span class="math inline">\(ad-bc=6-6=0\)</span>. So we know there is not a unique solution (i.e., the lines are parallel). Dividing the second equation by <span class="math inline">\(-2\)</span> leads to the equivalent system</p>
<p><span class="math display">\[
\begin{split}
x - 3y &amp; = 1, \\
x - 3y &amp; = -1.
\end{split}
\]</span></p>
<p>It’s now clear that there is no way to satisfy both equations simultaneously. The system is inconsistent.</p>
</div>
</div>
</section>
<section id="general-case" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="general-case"><span class="header-section-number">3.1.2</span> General case</h3>
<p>Time to put on our big-kid pants. For <span class="math inline">\(m\)</span> equations in <span class="math inline">\(n\)</span> variables, we need to use subscripts rather than different letters for everything.</p>
<div id="def-linsys-system" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.2 </strong></span>A <strong>linear-algebraic system</strong>, usually just written <strong>linear system</strong>, is the set of simultaneous equations <span id="eq-linsys-def"><span class="math display">\[
\begin{split}
A_{11} x_1 + A_{12} x_2 + \cdots + A_{1n} x_n &amp; = b_1 \\
A_{21} x_1 + A_{22} x_2 + \cdots + A_{2n} x_n &amp; = b_2 \\
&amp; \vdots \\
A_{m1} x_1 + A_{m2} x_2 + \cdots + A_{mn} x_n &amp; = b_m,
\end{split}
\tag{3.1}\]</span></span> where all the <span class="math inline">\(A_{ij}\)</span> and <span class="math inline">\(b_i\)</span> are assumed to be known. A <strong>solution</strong> of the system is a list of values <span class="math inline">\(x_1,\ldots,x_n\)</span> that makes all the equations true.</p>
</div>
<p>We want to gather similar elements in <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> into collective mathematical objects.</p>
<div id="def-linsys-vector" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.3 (Vector) </strong></span>A <strong>vector</strong> is a finite collection of numbers known as its <strong>elements</strong>. The set of all vectors with <span class="math inline">\(n\)</span> real-valued elements is denoted <span class="math inline">\(\real^n\)</span>. If the elements are complex numbers, we use the symbol <span class="math inline">\(\complex^n\)</span>.</p>
</div>
<p>I use boldfaced lowercase letters to represent vectors, and a subscript to refer to an individual element within one. For instance, <span class="math inline">\(x_3\)</span> is the third element of a vector <span class="math inline">\(\bfx\)</span>.</p>
<p>Next, we come to the doubly-indexed values <span class="math inline">\(A_{ij}\)</span>. The first index is the equation number, and the second corresponds to the variable number. This implies a 2D table or array of values.</p>
<div id="def-linsys-matrix" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.4 (Matrix) </strong></span>A <strong>matrix</strong> is an <span class="math inline">\(m\times n\)</span> array of numbers known as its <strong>elements</strong>. The set of all <span class="math inline">\(m\times n\)</span> matrices with real elements is denoted <span class="math inline">\(\rmn{m}{n}\)</span>, and with complex elements it’s <span class="math inline">\(\cmn{m}{n}\)</span>.</p>
</div>
<p>I use boldfaced uppercase letters to represent matrices, and a pair of subscripts to refer to an individual element within one. For instance, <span class="math inline">\(A_{23}\)</span> is the element in row 2, column 3 of the matrix <span class="math inline">\(\bfA\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Matrix subscripts are always in the order row first, column second. (This is the opposite of Excel—which is just one of myriad reasons that Excel is evil.)</p>
</div>
</div>
<p>In the context of <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>3.1</span></a>, we call the <span class="math inline">\(m\times n\)</span> matrix <span class="math inline">\(\bfA\)</span> the <strong>coefficient matrix</strong> of the linear system.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The rows of the coefficient matrix correspond to the equations in the linear system, and the columns correspond to the variables of the system.</p>
</div>
</div>
<p>The vector <span class="math inline">\(\bfb\in\real^m\)</span> implied in <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> doesn’t have a standard name, but I will call it the <strong>forcing vector</strong> by analogy with linear ODEs. Altogether, <span class="math inline">\(\bfA\)</span> and <span class="math inline">\(\bfb\)</span> are the data of the linear system, and the vector <span class="math inline">\(\bfx \in \real^{n}\)</span> is the solution.</p>
<div id="exm-coefficient-matrix" class="theorem example" data-chapter="3" data-description="Coefficient matrix">
<p><span class="theorem-title"><strong>Example 3.2 </strong></span>Sometimes zeros are needed as placeholders in the coefficient matrix. In the linear system</p>
<p><span class="math display">\[
\begin{split}
  x_1 - x_2 + 3 x_3 &amp;= 4,\\
  2x_2 + 5x_4 &amp;= -1,
\end{split}
\]</span></p>
<p>the coefficient matrix is <span class="math inline">\(2\times 4\)</span>,</p>
<p><span class="math display">\[
\bfA =
\begin{bmatrix}
1 &amp; -1 &amp; 3 &amp; 0 \\ 0 &amp; 2 &amp; 0 &amp; 5
\end{bmatrix},
\]</span></p>
<p>and the right-side vector is <span class="math inline">\(\twovec{4}{-1}\)</span>.</p>
</div>
</section>
</section>
<section id="row-elimination" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="row-elimination"><span class="header-section-number">3.2</span> Row elimination</h2>
<p>You’ve probably solved small systems of equations by substitution. In order to solve systems with more equations and variables, we systematize this idea as an <em>elimination algorithm</em>. The goal of elimination is to transform the system to an equivalent one whose solution(s) we can deduce easily. There are three legal moves in this game:</p>
<div id="def-row_elimination-operations" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.5 (Row operations) </strong></span>The following operations do not change the solutions of a linear system:</p>
<ol type="1">
<li>Swap the positions of two equations.</li>
<li>Multiply an equation by a nonzero constant.</li>
<li>Add a multiple of one equation to another equation.</li>
</ol>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall that the equations of a linear system correspond to rows of the coefficient matrix <span class="math inline">\(\bfA\)</span> and forcing vector <span class="math inline">\(\bfb\)</span>, hence the name “row operations.”</p>
</div>
</div>
<div id="exm-gauss-elimination" class="theorem example" data-chapter="3" data-description="Row elimination">
<p><span class="theorem-title"><strong>Example 3.3 </strong></span>Let’s use elimination to solve the <span class="math inline">\(3\times 3\)</span> system</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3 &amp; = 2, \\
3x_1 - 2x_2 &amp; = 9, \\
x_1 - 2x_2 - x_3 &amp; = 5.
\end{split}
\]</span></p>
<p>The first step is to use the first equation to eliminate <span class="math inline">\(x_1\)</span> from the second and third equations. We therefore add <span class="math inline">\(-3\)</span> times equation 1 to equation 2, and <span class="math inline">\(-1\)</span> times equation 1 to equation 3:</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
(3x_1 - 2x_2) - 3(x_1 - x_2  - x_3) &amp; = 9 - 3(2),\\
(x_1 - 2x_2 - x_3) - 1(x_1 - x_2  - x_3) &amp; = 5 - 1(2) .
\end{split}
\]</span></p>
<p>This takes us to <span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2,  \\
x_2 + 3x_3 &amp;= 3, \\
-x_2 &amp;= 3.
\end{split}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s tempting to grab that last equation above and use it to remove <span class="math inline">\(x_2\)</span> from everything else. That move certainly works out here. But in the context of a fully automatic algorithm that works every time, we will continue as though the last equation still might contain a dependence on <span class="math inline">\(x_3\)</span>.</p>
</div>
</div>
<p>Next, we leave the first equation alone and use the second to eliminate <span class="math inline">\(x_2\)</span> from all the others below it.</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
x_2 + 3x_3 &amp; = 3, \\
(-x_2) + (x_2+3x_3)  &amp; = 3 + 3.
\end{split}
\]</span></p>
<p>We now have the system, equivalent to the original one, comprising</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2  - x_3  &amp; = 2, \\
x_2 + 3x_3 &amp; = 3, \\
3x_3  &amp; = 6.
\end{split}
\]</span></p>
<p>We can now deduce that <span class="math inline">\(x_3=2\)</span> from the last equation. Moving up to the second equation, we then find that <span class="math inline">\(x_2=3-3(2)=-3\)</span>. Finally, the first equation yields <span class="math inline">\(x_1=2+(-3)+(2)=1\)</span>.</p>
</div>
<p>The process in <a href="#exm-gauss-elimination" class="quarto-xref">Example&nbsp;<span>3.3</span></a> leading to triangular system is commonly known as <strong>Gaussian elimination</strong>. (It’s a poor name, as the process was known at least in China thousands of years before Gauss.) Finding the solution from the triangular form is called <strong>backward substitution</strong>.</p>
<section id="augmented-matrix" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="augmented-matrix"><span class="header-section-number">3.2.1</span> Augmented matrix</h3>
<p>Before looking further into the elimination process, we will lighten the notational load by using matrices.</p>
<div id="def-linsys-augmented" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.6 </strong></span>The <strong>augmented matrix</strong> of the linear system <a href="#eq-linsys-def" class="quarto-xref">Equation&nbsp;<span>3.1</span></a> is the <span class="math inline">\(m\times (n+1)\)</span> matrix <span class="math inline">\(\mathbf{G} = \augmat{\bfA}{\bfb}\)</span>.</p>
</div>
<div id="exm-augmented-matrix" class="theorem example" data-chapter="3" data-description="Augmented matrix">
<p><span class="theorem-title"><strong>Example 3.4 </strong></span>The starting system in <a href="#exm-gauss-elimination" class="quarto-xref">Example&nbsp;<span>3.3</span></a> has augmented matrix</p>
<p><span class="math display">\[
\augmat{\begin{matrix}
1 &amp; -1 &amp; -1  \\
3 &amp;-2 &amp; 0 \\
1 &amp; -2 &amp; -1
\end{matrix}}{
  \begin{matrix}2\\9\\5\end{matrix}
  }.
\]</span></p>
<p>The final system in that example has augmented matrix <span class="math display">\[
\augmat{\begin{matrix}
1 &amp; -1 &amp; -1  \\
0 &amp; 1 &amp; 3 \\
0 &amp; 0 &amp; 3
\end{matrix}}{
  \begin{matrix}2\\3\\6\end{matrix}
  }.
\]</span></p>
</div>
<p>The nonzeros in the final augmented matrix have a triangular shape that is the key to making back substitution work. Next, we will get specific about what this form requires.</p>
</section>
<section id="row-echelon-form" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="row-echelon-form"><span class="header-section-number">3.2.2</span> Row echelon form</h3>
<p>Here is a formal description of the goal of row elimination.</p>
<div id="def-row-echelon" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.7 (Row echelon form (RE form)) </strong></span>A matrix is in RE form if:</p>
<ol type="1">
<li>Any rows that are completely zero are at the bottom.</li>
<li>The leftmost nonzero element in a row, called the <strong>leading element</strong>, is to the left of any other leading elements below it.</li>
</ol>
</div>
<div id="exm-RE-not-REF" class="theorem example" data-chapter="3" data-description="RE form">
<p><span class="theorem-title"><strong>Example 3.5 </strong></span>The following matrices are <strong>not</strong> in RE form:</p>
<p><span class="math display">\[
\begin{bmatrix}
2 &amp; 0 &amp; 1 &amp; -1 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; -4 &amp; 1 &amp; 0
\end{bmatrix}  
\]</span> (leading nonzeros do not move to the right from row 2 to 3)</p>
<p><span class="math display">\[
\begin{bmatrix}
2 &amp; 0 &amp; 1 &amp; -1 \\ 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; -4 &amp; 1 &amp; 0
\end{bmatrix}  
\]</span> (zero row not at the bottom)</p>
</div>
<p>To achieve RE form by row operations on a given starting matrix, we start at the top left and use row operations to introduce zeros under the leading element of the first row. We then move down one row and repeat. It’s easier to understand from more examples than to write out a formal algorithm.</p>
<div id="exm-RE-inconsistent" class="theorem example" data-chapter="3" data-description="Inconsistent system">
<p><span class="theorem-title"><strong>Example 3.6 </strong></span>We start from <span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 2 &amp; 4 &amp; 0 &amp; 2 \\ 2 &amp; 3 &amp; 2 &amp; 5 \\ -1 &amp; 1 &amp; 3 &amp; 5
\end{bmatrix}
\]</span></p>
<p>In the first row, the 1 will be the leading element. We then multiples of the first row to create zeros in the rows underneath it.</p>
<p><span class="math display">\[
\begin{split}
&amp; \stackrel{R_2=R_2 - 2R_1}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 2 &amp; 3 &amp; 2 &amp; 5 \\ -1 &amp; 1 &amp; -8 &amp; 5
\end{bmatrix} \\[1ex]
&amp; \stackrel{R_3=R_3 - 2R_1}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 0 &amp; -1 &amp; 10 &amp; -5 \\ -1 &amp; 1 &amp; -8 &amp; 5
\end{bmatrix} \\[1ex]
&amp; \stackrel{R_4=R_4 + 1R_1}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 0 &amp; -1 &amp; 10 &amp; -5 \\ 0 &amp; 3 &amp; -12 &amp; 10
\end{bmatrix}
\end{split}
\]</span></p>
<p>Now that leading 1 in the first row is all set. From now on, we can safely ignore the first column, as those zeros will remain throughout.</p>
<p>Moving to the second row, we notice that if we designated the 8 to be the leading element, then at least one of the rows underneath it would have a leading element to its left. That’s a violation of RE form. So we can swap either of those rows with the current row 2:</p>
<p><span class="math display">\[
\stackrel{R_2 \leftrightarrow R_3}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; -1 &amp; 10 &amp; -5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 0 &amp; 3 &amp; -12 &amp; 10
\end{bmatrix}
\]</span></p>
<p>We now can select <span class="math inline">\(-1\)</span> as the leading element in row 2, and create zeros underneath it. Of course, we don’t have any work to do in the current row 3.</p>
<p><span class="math display">\[
\stackrel{R_4 = R_4 + 3R_2}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; -1 &amp; 10 &amp; -5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 0 &amp; 0 &amp; 18 &amp; -5
\end{bmatrix}
\]</span></p>
<p>Our first two rows are set. We’re happy choosing <span class="math inline">\(8\)</span> as the leading element in row 3, and one more operation is needed to clear the element below it:</p>
<p><span class="math display">\[
\stackrel{R_4 = R_4 - \frac{18}{8}R_3}{\Longrightarrow}
\begin{bmatrix}
1 &amp; 2 &amp; -4 &amp; 5 \\ 0 &amp; -1 &amp; 10 &amp; -5 \\ 0 &amp; 0 &amp; 8 &amp; -8 \\ 0 &amp; 0 &amp; 0 &amp; 13
\end{bmatrix}
\]</span></p>
<p>The matrix is now in RE form.</p>
<p>If our starting point is the augmented matrix of a linear system, then our new linear system would be</p>
<p><span class="math display">\[
\begin{split}
1x_1 + 2x_2 -4x_3 &amp;= 5  \\
0x_1 - 1x_2 +10x_3 &amp;= -5 \\
0x_1 + 0x_2 +8x_3 &amp;= -8 \\
0x_1 + 0x_2 + 0x_3 &amp;= 13
\end{split}
\]</span></p>
<p>That last equation is a dealbreaker! The system is inconsistent.</p>
</div>
<div id="def-pivot" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.8 (Pivots) </strong></span>The leading elements encountered during row elimination are called <strong>pivots</strong>. The columns they occur in are called <strong>leading variables</strong>, while the other variables (if any) are called <strong>free variables</strong>.</p>
</div>
<div id="exm-elimination-infinite" class="theorem example" data-chapter="3" data-description="Infinitely many solutions">
<p><span class="theorem-title"><strong>Example 3.7 </strong></span>Suppose we begin with the augmented matrix <span class="math display">\[
\augmat{\begin{matrix}
1 &amp; 1 &amp; -1  \\
1 &amp; 2 &amp; 2  \\
2 &amp; 1 &amp; -5
\end{matrix}}{
  {4}\\ {3}\\ {9}
}.
\]</span></p>
<p>The first 1 in the first row is a fine pivot, leading to</p>
<p><span class="math display">\[
\stackrel{R_2 = R_2 - R_1;\; R_3 = R_3 - 2R_1}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; 1 &amp; -1  \\
0 &amp; 1 &amp; 3  \\
0 &amp; -1 &amp; -3
\end{matrix}}{
  \begin{matrix}4\\-1\\1\end{matrix}
}
\]</span></p>
<p>The leading 1 in the second row is the next pivot:</p>
<p><span class="math display">\[
\stackrel{R_3 = R_3 + R_2}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; 1 &amp; -1  \\
0 &amp; 1 &amp; 3  \\
0 &amp; 0 &amp; 0
\end{matrix}}{
  \begin{matrix}4\\-1\\0\end{matrix}
}.
\]</span></p>
<p>Only the first two variables are considered leading variables, and <span class="math inline">\(x_3\)</span> remains free. So we say that <span class="math inline">\(x_3=t\)</span> for any arbitrary value of <span class="math inline">\(t\)</span>. The last row of the final augmented matrix represents the equation <span class="math inline">\(0=0\)</span>, which is true and implies no constraint. The second row implies</p>
<p><span class="math display">\[
x_2 + 3x_3 = -1,
\]</span></p>
<p>which is equivalent to <span class="math inline">\(x_2=-1-3t\)</span>. Finally, the first row says that</p>
<p><span class="math display">\[
x_1 + x_2 - x_3 = 4,
\]</span></p>
<p>so that <span class="math inline">\(x_1 = 4 - (-1-3t) + (t) = 5+4t\)</span>. The system has infinitely many solutions.</p>
</div>
</section>
</section>
<section id="rre-form" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="rre-form"><span class="header-section-number">3.3</span> RRE form</h2>
<p>An alternative to backward substitution is to transform the RE form further into something even simpler.</p>
<div id="def-linalg-RREF" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.9 (RRE form) </strong></span>A matrix is in <strong>RRE form</strong> (reduced row-echelon form) if it meets all of these requirements:</p>
<ol type="1">
<li>Any rows of all zeros appear below all nonzero rows.</li>
<li>The leading element of any row is a one.</li>
<li>Every leading 1 that is lower than another leading 1 is also to the right of it.</li>
<li>Every leading 1 is the only nonzero in its column.</li>
</ol>
<p>The columns that have leading ones are called <strong>pivot columns</strong>. The other columns are called <strong>free columns</strong>.</p>
</div>
<p>There are two things that make RRE form useful. One is that it makes a unique target:</p>
<div id="thm-RREF-unique" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.1 </strong></span>Every matrix is equivalent to a unique matrix in RRE form.</p>
</div>
<p>The other useful fact is that RRE form completely exposes everything we want to know about a linear system. In fact, everything else we will do theoretically with matrices comes back to the RRE form, whether or not it’s an augmented matrix.</p>
<div id="exm-gauss-jordan" class="theorem example" data-chapter="3" data-description="Gauss--Jordan elimination">
<p><span class="theorem-title"><strong>Example 3.8 </strong></span>At the end of <a href="#exm-gauss-elimination" class="quarto-xref">Example&nbsp;<span>3.3</span></a>, we had reached the augmented matrix</p>
<p><span class="math display">\[
\augmat{\begin{matrix}
1 &amp; -1 &amp; -1  \\
0 &amp; 1 &amp; 3 \\
0 &amp; 0 &amp; 3
\end{matrix}}{
  \begin{matrix}2\\3\\6\end{matrix}
  }.
\]</span></p>
<p>Note that the leading element of row 3 is not a 1. We fix that by multiplying it through:</p>
<p><span class="math display">\[
\stackrel{R_3 = \frac{1}{3}R_3}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; -1 &amp; -1  \\
0 &amp; 1 &amp; 3 \\
0 &amp; 0 &amp; 1
\end{matrix}}{
  \begin{matrix}2\\3\\2\end{matrix}
  }.
\]</span></p>
<p>The leading one in row 1 is alone in its column. But the other two leading ones are not. We start at the bottom right and eliminate <em>upwards</em> now:</p>
<p><span class="math display">\[
\begin{split}
&amp; \stackrel{R_2 = R_2 - 3R_3}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; -1 &amp; -1  \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{matrix}}{
  \begin{matrix}2\\-3\\2\end{matrix}
  } \\[1ex]
  &amp; \stackrel{R_1 = R_1 + 1R_3}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; -1 &amp; 0  \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{matrix}}{
  \begin{matrix}4\\-3\\2\end{matrix}
  }.
\end{split}
\]</span></p>
<p>At this point, the leading one of row 3 is ready to go. We have just one more upwards step to perform from row 2:</p>
<p><span class="math display">\[
\stackrel{R_1 = R_1 + 1R_2}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; 0 &amp; 0  \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{matrix}}{
  \begin{matrix}1\\-3\\2\end{matrix}
  }.
\]</span></p>
<p>The system is now trivial: <span class="math inline">\(x_1=1\)</span>, <span class="math inline">\(x_2=-3\)</span>, and <span class="math inline">\(x_3=2\)</span>. Done!</p>
</div>
<p>The process above is called <strong>Gauss–Jordan elimination</strong>, to distinguish it from Gaussian elimination.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can <a href="&quot;https://www.wolframalpha.com/input/?i=rref {{1%2C2%2C3}%2C{4%2C5%2C6}%2C{7%2C8%2C9}}&quot;">use Wolfram Alpha</a> to find the RRE form of a matrix.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>While MATLAB has an <code>rref</code> command, it should not be relied on. It isn’t really MATLAB’s fault; the RRE form is a terrible target for numerical computations, because it is infinitely sensitive to rounding errors, and MATLAB calculates using numerical approximations for speed.</p>
</div>
</div>
<section id="solution-from-the-rre-form" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="solution-from-the-rre-form"><span class="header-section-number">3.3.1</span> Solution from the RRE form</h3>
<p>The RRE form of an augmented matrix represents a linear system that we can solve by inspection.</p>
<div id="thm-RRE-solve" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.2 </strong></span>To solve a system with augmented matrix in RRE form:</p>
<ol type="1">
<li>Ignore all zero rows.</li>
<li>If a leading one occurs in the last column, the system is inconsistent.</li>
<li>Otherwise, each variable associated with a free column is assigned to a free parameter (e.g., <span class="math inline">\(s\)</span>, <span class="math inline">\(t\)</span>, etc.).</li>
<li>Use the leading columns to solve for their corresponding variables in terms of the free parameters.</li>
</ol>
</div>
<div id="exm-rref-infinite" class="theorem example" data-chapter="3" data-description="RE form to RRE form">
<p><span class="theorem-title"><strong>Example 3.9 </strong></span>In <a href="#exm-elimination-infinite" class="quarto-xref">Example&nbsp;<span>3.7</span></a>, we reduced a linear system to the RE augmented matrix</p>
<p><span class="math display">\[
\augmat{\begin{matrix}
1 &amp; 1 &amp; -1  \\
0 &amp; 1 &amp; 3  \\
0 &amp; 0 &amp; 0
\end{matrix}}{
  \begin{matrix}4\\-1\\0\end{matrix}
}.
\]</span></p>
<p>To put this matrix into RRE form, we can use the second row to put a zero above its leading 1:</p>
<p><span class="math display">\[
\stackrel{R_1 = R_1 - R_2}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; 0 &amp; -4  \\
0 &amp; 1 &amp; 3  \\
0 &amp; 0 &amp; 0
\end{matrix}}{
  \begin{matrix}5\\-1\\0\end{matrix}
}.
\]</span></p>
<p>This is the system</p>
<p><span class="math display">\[
\begin{split}
x_1 - 4x_3 &amp;= 5 \\
x_2 + 3x_3 &amp;= -1,
\end{split}
\]</span></p>
<p>in which <span class="math inline">\(x_3=t\)</span> is a free variable. Thus, <span class="math inline">\(x_2=-1-3t\)</span> and <span class="math inline">\(x_1=5+4t\)</span>, which is the same conclusion we reached in <a href="#exm-elimination-infinite" class="quarto-xref">Example&nbsp;<span>3.7</span></a> by backward substitution.</p>
</div>
<div id="exm-RREF-multiple" class="theorem example" data-chapter="3" data-description="Solution from RRE form">
<p><span class="theorem-title"><strong>Example 3.10 </strong></span>A linear system has an augmented matrix equivalent to the RRE matrix</p>
<p><span class="math display">\[
\augmat{
\begin{matrix}
0 &amp; 1 &amp; -3 &amp; 0 \\
0 &amp; 0 &amp; 0  &amp; 1  \\
0 &amp; 0 &amp; 0  &amp; 0   \\
0 &amp; 0 &amp; 0  &amp; 0  
\end{matrix} }{
  \begin{matrix}2 \\ -4 \\ 0 \\ 0 \end{matrix}
}
\]</span></p>
<p>Find all solutions to the linear system.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The last two rows have no information and can be ignored. Columns 2 and 4 are pivot columns. We give variables from the other columns arbitrary values, <span class="math inline">\(x_1=s\)</span> and <span class="math inline">\(x_3=t\)</span>. The pivot variables are solved in terms of these to get <span class="math inline">\(x_2=2+3t\)</span> and <span class="math inline">\(x_4=-4\)</span>. All solutions are expressed as the vector</p>
<p><span class="math display">\[
\bfx = \begin{bmatrix}
s \\ 2+3t \\ t \\ -4
\end{bmatrix}, \qquad s,t\in \real.
\]</span></p>
</div>
</div>
<div id="exm-rre-inconsistent" class="theorem example" data-chapter="3" data-description="RRE form---inconsistent system">
<p><span class="theorem-title"><strong>Example 3.11 </strong></span>A linear system has an augmented matrix equivalent to the RRE form</p>
<p><span class="math display">\[
\augmat{
\begin{matrix}
1 &amp; 0 &amp; -4 &amp; 0  \\
0 &amp; 1 &amp; 1  &amp; 0 \\
0 &amp; 0 &amp; 0  &amp; 1  \\
0 &amp; 0 &amp; 0  &amp; 0
\end{matrix}}{
  \begin{matrix}0 \\ 0 \\ 0 \\ 1 \end{matrix}
}
\]</span></p>
<p>Find all solutions to the linear system.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Look at the last row of the system. It expresses the equation <span class="math inline">\(0=1\)</span>, which is impossible to satisfy. Thus the system is inconsistent.</p>
</div>
</div>
</section>
<section id="rank" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="rank"><span class="header-section-number">3.3.2</span> Rank</h3>
<p>There are only three possible outcomes for a linear system, all deducible from the RRE form of the augmented matrix:</p>
<ol type="1">
<li>There is a leading 1 in the last column, in which case there are no solutions.</li>
<li>There are fewer pivot columns than variables, in which case there are infinitely many solutions.</li>
<li>There is a unique solution.</li>
</ol>
<p>Really, these come down to counting the number of leading ones/pivot columns.</p>
<div id="def-RREF-rank" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.10 (Rank) </strong></span>The <strong>rank</strong> of a matrix is the number of pivot columns in its RRE or any equivalent RE form.</p>
</div>
<div id="thm-RREF-rank" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.3 </strong></span>If <span class="math inline">\(\bfA\)</span> is an <span class="math inline">\(m\times n\)</span> matrix, then <span class="math inline">\(\rank(\bfA) \le m\)</span> and <span class="math inline">\(\rank(\bfA) \le n\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Each leading one in the RRE form requires a row and column of its own.</p>
</div>
<div id="thm-RREF-deficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.4 </strong></span>Suppose <span class="math inline">\(\bfA\)</span> is <span class="math inline">\(m\times n\)</span>. If <span class="math inline">\(\rank(\bfA)&lt;n\)</span>, then the linear system with augmented matrix <span class="math inline">\(\augmat{\bfA}{\bfb}\)</span> cannot have a unique solution. It is inconsistent for some choices of <span class="math inline">\(\bfb\)</span> and has infinitely many solutions for other choices of <span class="math inline">\(\bfb\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">\(r=\rank(\bfA)\)</span>. Then the RRE form of <span class="math inline">\(\bfA\)</span> has all zero elements in rows <span class="math inline">\(r+1\)</span> to <span class="math inline">\(m\)</span>. Now augment <span class="math inline">\(\bfA\)</span> with <span class="math inline">\(\bfb\)</span> and perform the row operations that reduce <span class="math inline">\(\bfA\)</span> to RRE form. If there are any nonzeros in rows <span class="math inline">\(r+1\)</span> to <span class="math inline">\(m\)</span> of the last column, the system is inconsistent. Otherwise, the system has at least one free variable. We can start with either type of outcome and run the row elimination process backward to find a <span class="math inline">\(\bfb\)</span> that led to it.</p>
</div>
<div id="cor-RREF-nonunique" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 3.1 </strong></span>A linear system with more variables than equations cannot have a unique solution.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math inline">\(\rank(\bfA) \le m &lt; n\)</span>.</p>
</div>
</section>
</section>
<section id="linear-combinations" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="linear-combinations"><span class="header-section-number">3.4</span> Linear combinations</h2>
<p>There is a different perspective and terminology that is equivalent to linear systems and statements about them. In fact, we first saw this terminology for solutions of linear ODEs.</p>
<div id="def-linalg-linear-comb" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.11 (Linear combination) </strong></span>A <strong>linear combination</strong> of vectors <span class="math inline">\(\bfv_1, \ldots, \bfv_k\)</span> with <strong>coefficients</strong> <span class="math inline">\(c_1,\ldots,c_k\)</span> is the vector</p>
<p><span class="math display">\[
c_1 \bfv_1 + c_2 \bfv_2 + \cdots + c_k \bfv_k.
\]</span></p>
</div>
<div id="exm-lincomb-system" class="theorem example" data-chapter="3" data-description="Linear combination as a linear system">
<p><span class="theorem-title"><strong>Example 3.12 </strong></span>Is <span class="math inline">\(\threevec{1}{0}{3}\)</span> a linear combination of <span class="math inline">\(\threevec{1}{2}{3}\)</span> and <span class="math inline">\(\threevec{-1}{1}{-3}\)</span>?</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>To rephrase the question: do there exist numbers <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> so that</p>
<p><span class="math display">\[
\threevec{1}{0}{3} \stackrel{?}{=} x_1 \threevec{1}{2}{3} + x_2 \threevec{-1}{1}{-3}.
\]</span></p>
<p>This is the same as</p>
<p><span class="math display">\[
\threevec{1}{0}{3} \stackrel{?}{=}  x_1 \threevec{1x_1 - 1x_2}{2x_1+ 1x_2}{3x_1 - 3x_2}.
\]</span></p>
<p>This is equivalent to the linear system</p>
<p><span class="math display">\[
\begin{split}
x_1 - x_2 &amp;= 1 \\
2x_1 + x_2 &amp;= 0 \\
3x_1 - 3x_2 &amp;= 3,
\end{split}
\]</span></p>
<p>which has the augmented matrix</p>
<p><span class="math display">\[
\augmat{\begin{matrix}
1 &amp; -1  \\
2 &amp; 1  \\
3 &amp; -3
\end{matrix}}{
  \begin{matrix}1\\0\\3\end{matrix}
}.
\]</span></p>
<p>The RRE form of this matrix is<br>
<span class="math display">\[
\stackrel{RRE}{\Longrightarrow}
\augmat{\begin{matrix}
1 &amp; 0  \\
0 &amp; 1  \\
0 &amp; 0
\end{matrix}}{
  \begin{matrix}\frac{1}{3}\\-\frac{2}{3}\\0\end{matrix}
},
\]</span></p>
<p>which implies that the system is consistent and has a unique solution. Therefore, the answer to the original question is yes, and we found out also that is <span class="math inline">\(x_1=\frac{1}{3}\)</span> and <span class="math inline">\(x_2=-\frac{2}{3}\)</span>.</p>
</div>
</div>
<p>The preceding example is summarized as the following.</p>
<div id="thm-linalg-system" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.5 </strong></span>The vector <span class="math inline">\(\bfb\)</span> is a linear combination of <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span> if and only if the system with augmented matrix <span class="math inline">\(\augmat{\bfA}{\bfb}\)</span> is consistent, where <span class="math inline">\(\bfA\)</span> is the matrix whose columns are <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span>.</p>
</div>
<section id="span" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="span"><span class="header-section-number">3.4.1</span> Span</h3>
<div id="def-linalg-span" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.12 </strong></span>The set of all linear combinations of <span class="math inline">\(\bfv_1,\ldots,\bfv_k\)</span> is known as the <strong>span</strong> of those vectors. The span of an empty set is the singleton set <span class="math inline">\(\{\bfzero\}\)</span>.</p>
</div>
<p>We can now restate <a href="#thm-linalg-system" class="quarto-xref">Theorem&nbsp;<span>3.5</span></a> as follows.</p>
<div id="thm-linalg-span" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.6 </strong></span>Let <span class="math inline">\(\bfa_1,\ldots,\bfa_n\)</span> be vectors in <span class="math inline">\(\real^n\)</span>, and let</p>
<p><span class="math display">\[
\bfA = \begin{bmatrix}
\bfa_1 &amp; \bfa_2 &amp; \cdots &amp; \bfa_n
\end{bmatrix} \in \rmn{m}{n}.
\]</span></p>
<p>Then a vector <span class="math inline">\(\bfb \in \real^m\)</span> lies in the span of <span class="math inline">\(\bfa_1,\ldots,\bfa_n\)</span> if and only if the system with augmented matrix <span class="math inline">\(\augmat{\bfA}{\bfb}\)</span> is consistent.</p>
</div>
<div id="exm-nullspace-combo" class="theorem example" data-chapter="3" data-description="Linear dependence">
<p><span class="theorem-title"><strong>Example 3.13 </strong></span>Show that <span class="math inline">\(\threevec{1}{4}{3}\)</span> is in the span of <span class="math inline">\(\bfu_1=\threevec{1}{-2}{-1}\)</span> and <span class="math inline">\(\bfu_2=\threevec{3}{0}{1}\)</span>.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The goal is equivalent to showing that the linear system with augmented matrix</p>
<p><span class="math display">\[
\augmat{\begin{matrix}
1 &amp; 3  \\
-2 &amp; 0  \\
-1 &amp; 1
\end{matrix}}{
  \begin{matrix}1\\4\\3\end{matrix}
}
\]</span></p>
<p>is consistent. The RRE form of this matrix is</p>
<p><span class="math display">\[
\stackrel{RRE}{\Longrightarrow}
\augmat{
\begin{matrix}
  1 &amp; 0  \\ 0 &amp; 1  \\ 0 &amp; 0
\end{matrix}}{
    \begin{matrix}
   -2 \\  1 \\  0
\end{matrix}
}
\]</span></p>
<p>which is consistent, so we are done.</p>
</div>
</div>
</section>
<section id="homogeneous-systems" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="homogeneous-systems"><span class="header-section-number">3.4.2</span> Homogeneous systems</h3>
<p>In linear ODEs, we found that every problem depends on the associated homogeneous problem. The same is true for linear systems.</p>
<div id="def-linalg-def" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.13 (Homogeneous linear system) </strong></span>A <strong>homogeneous</strong> linear system is one that has forcing vector <span class="math inline">\(\bfb\)</span> equal to zero. We say it has a <strong>nontrivial</strong> solution if the zero vector is not the only solution.</p>
</div>
<p>The following conclusions ensue immediately from our definitions and previous results.</p>
<div id="thm-linalg-uniqueness" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.7 </strong></span>A homogeneous system in <span class="math inline">\(n\)</span> variables with coefficient matrix <span class="math inline">\(\bfA\)</span> has a nontrivial solution if and only if <span class="math inline">\(\rank(\bfA)&lt; n\)</span>. In particular, a homogeneous system with more variables than equations has a nontrivial solution.</p>
</div>
</section>
<section id="independence" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="independence"><span class="header-section-number">3.4.3</span> Independence</h3>
<p>The idea behind span is that it allows us to represent an infinite set using a finite number of vectors. We also want to make sure that the representation is as simple as possible. For this, we need to put some fresh paint on an old barn.</p>
<div id="def-linalg-independence" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3.14 (Linear independence) </strong></span>Vectors <span class="math inline">\(\bfv_1,\bfv_2,\ldots,\bfv_n\)</span> are <strong>linearly dependent</strong> if there is a way to choose constants <span class="math inline">\(c_1,\ldots,c_n\)</span>, <em>not all zero</em>, such that</p>
<p><span class="math display">\[
c_1\bfv_1 + c_2\bfv_2 + \cdots c_n \bfv_n = \bfzero.
\]</span></p>
<p>If the vectors are not linearly dependent, then they are <strong>linearly independent</strong>.</p>
</div>
<p>Because linear combinations are equivalent to linear systems, statements about linear independence are equivalent to statements about homogeneous linear systems.</p>
<div id="thm-linalg-independence" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.8 </strong></span>Let <span class="math inline">\(\bfa_1,\ldots,\bfa_n\)</span> be vectors in <span class="math inline">\(\real^n\)</span>, and let</p>
<p><span class="math display">\[
\bfA = \begin{bmatrix}
\bfa_1 &amp; \bfa_2 &amp; \cdots &amp; \bfa_n
\end{bmatrix} \in \rmn{m}{n}.
\]</span></p>
<p>The following statements are equivalent.</p>
<ol type="1">
<li>The vectors <span class="math inline">\(\bfa_1,\ldots,\bfa_n\)</span> are linearly independent.</li>
<li>The system with augmented matrix <span class="math inline">\(\augmat{\bfA}{\bfzero}\)</span> has only zero as a solution. <!-- 3. The null space of $\bfA$ contains only the zero vector. --></li>
<li><span class="math inline">\(\rank(\bfA) = n\)</span>.</li>
</ol>
</div>
<div id="exm-dependence-zerovector" class="theorem example" data-chapter="3" data-description="Zero vector implies dependence">
<p><span class="theorem-title"><strong>Example 3.14 </strong></span>Any set of vectors that contains the zero vector must be dependent. That’s because the zero vector will put a column of zeros in the matrix <span class="math inline">\(\bfA\)</span> in <a href="#thm-linalg-independence" class="quarto-xref">Theorem&nbsp;<span>3.8</span></a>, and since that column can’t possibly have a leading nonzero in it, the rank of <span class="math inline">\(\bfA\)</span> will be less than the number of columns.</p>
</div>
<div id="exm-nullspace-dependent" class="theorem example" data-chapter="3" data-description="Determine independence of vectors">
<p><span class="theorem-title"><strong>Example 3.15 </strong></span>Determine whether the vectors <span class="math inline">\(\bfv_1=\threevec{1}{0}{-2}\)</span>, <span class="math inline">\(\bfv_2=\threevec{1}{0}{1}\)</span>, and <span class="math inline">\(\bfv_3 = \threevec{0}{0}{-1}\)</span> are linearly independent.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>These vectors are dependent if, and only if, we can find <span class="math inline">\(c_1,c_2,c_3\)</span>, not all zero, such that</p>
<p><span class="math display">\[
c_1 \bfv_1 + c_2 \bfv_2 + c_3 \bfv_3 = \bfzero.
\]</span></p>
<p>Equating components on the two sides of this equation leads to the linear system with augmented matrix</p>
<p><span class="math display">\[
\augmat{
    \begin{matrix}
    1 &amp; 1 &amp; 0  \\ 0 &amp; 0 &amp; 0  \\ -2 &amp; 1 &amp; -1
    \end{matrix}}{
\begin{matrix}
    0 \\  0 \\  0
    \end{matrix}
}
\]</span></p>
<p>The RRE form of this system is</p>
<p><span class="math display">\[
\stackrel{RRE}{\Longrightarrow}
\augmat{
    \begin{matrix}
    1 &amp; 0 &amp; \frac{1}{3}  \\ 0 &amp; 1 &amp; -\frac{1}{3}  \\ 0 &amp; 0 &amp; 0
    \end{matrix}}{
\begin{matrix}
    0 \\  0 \\  0
    \end{matrix}
}
\]</span></p>
<p>whose solutions are <span class="math inline">\([-t/3,t/3,t]\)</span> for all <span class="math inline">\(t\)</span>. Since there are nonzero solutions to the linear system, the original set of vectors is linearly dependent.</p>
</div>
</div>
<div id="exm-nullspace-dependent" class="theorem example" data-chapter="3" data-description="Determine independence of vectors">
<p><span class="theorem-title"><strong>Example 3.16 </strong></span>Determine whether the vectors (written in row form for compactness) <span class="math inline">\([2,0,0,-1]\)</span>, <span class="math inline">\([1,1,0,0]\)</span>, and <span class="math inline">\([0,0,-1,1]\)</span> are linearly independent.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We use the given vectors as columns of a coefficient matrix:</p>
<p><span class="math display">\[
\bfA = \begin{bmatrix}
2 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; -1 \\ -1 &amp; 0 &amp; 1
\end{bmatrix}.
\]</span></p>
<p>The linear system with augmented matrix <span class="math inline">\(\augmat{\bfA}{\bfzero}\)</span> has RRE form</p>
<p><span class="math display">\[
\stackrel{RRE}{\Longrightarrow}
\augmat{
    \begin{matrix}
    1 &amp; 0 &amp; 0  \\ 0 &amp; 1 &amp; 0  \\ 0 &amp; 0 &amp; 1  \\ 0 &amp; 0 &amp; 0
    \end{matrix}}{
\begin{matrix}
    0 \\  0 \\  0 \\  0
    \end{matrix}
}.
\]</span></p>
<p>This has rank 3, which is the same as the number of vectors in the question, so the vectors are linearly independent.</p>
</div>
</div>
<p>Besides the presence of a zero vector, there is one easy case for detecting dependence.</p>
<div id="thm-linsys-dependence-too-many" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3.9 </strong></span>Any collection of <span class="math inline">\(n\)</span> vectors in <span class="math inline">\(\real^m\)</span> is dependent if <span class="math inline">\(n &gt; m\)</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The rank of <span class="math inline">\(\bfA\)</span> in <a href="#thm-linalg-independence" class="quarto-xref">Theorem&nbsp;<span>3.8</span></a> is no greater than <span class="math inline">\(m\)</span>, which is less than <span class="math inline">\(n\)</span>.</p>
</div>
<div id="exm-linalg-dependence-too-many" class="theorem example" data-chapter="3" data-description="Too many vectors implies dependence">
<p><span class="theorem-title"><strong>Example 3.17 </strong></span>Determine whether the vectors <span class="math inline">\(\bfv_1=\threevec{1}{0}{-2}\)</span>, <span class="math inline">\(\bfv_2=\threevec{1}{0}{1}\)</span>, <span class="math inline">\(\bfv_3 = \threevec{0}{0}{-1}\)</span>, and <span class="math inline">\(\bfv_4 = \threevec{1}{0}{0}\)</span> are linearly independent.</p>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>There are four vectors in <span class="math inline">\(\real^3\)</span>, so they are dependent by <a href="#thm-linsys-dependence-too-many" class="quarto-xref">Theorem&nbsp;<span>3.9</span></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#thm-linsys-dependence-too-many" class="quarto-xref">Theorem&nbsp;<span>3.9</span></a> says, “if <span class="math inline">\(n &gt; m\)</span>, then dependent,” but the converse statement, “if dependent, then <span class="math inline">\(n &gt; m\)</span>,” is not logically correct. There are examples of dependent sets of vectors with <span class="math inline">\(n &lt; m\)</span>, <span class="math inline">\(n=m\)</span>, <em>and</em> <span class="math inline">\(n&gt;m\)</span>.</p>
</div>
</div>
<!---
 ::::{#exm-nullspace-dependentspan}
The result of @exm-nullspace-dependent is that $\bfv_1=\threevec{1}{0}{-2}$, $\bfv_2=\threevec{1}{0}{1}$, and $\bfv_3 = \threevec{0}{0}{-1}$ are linearly dependent. For instance,

$$
\bfv_1 - \bfv_2 + 3 \bfv_3 = \bfzero.
$$

Therefore, any vector in $\span(\bfv_1,\bfv_2,\bfv_3)$ can be written as

$$
\begin{split}
c_1 \bfv_1 + c_2 \bfv_2 + c_3 \bfv_3 &= c_1(\bfv_2 - 3 \bfv_3) + c_2 \bfv_2 + c_3 \bfv_3 \\
&= (c_1+c_2) \bfv_2 + (c_3- 3c_1)\bfv_3.
\end{split}
$$

Hence $\span(\bfv_1,\bfv_2,\bfv_3) = \span(\bfv_2,\bfv_3)$.
::::

:::{.callout-note}
In @exm-nullspace-dependentspan, we could have removed $\bfv_2$ or $\bfv_3$ from the spanning set instead without changing the spanned result. The only requirement is that the coefficient of the removed vector is not zero in the linear combination of them that makes zero.
:::

A set of vectors that both spans the null space and is linearly independent is called a *basis* of the null space. We'll formalize that idea when we discuss subspaces more generally. For now, just know that a basis is a minimal set of vectors that can get the spanning job done.
 
--->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ivp_second_order.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Second-order linear IVPs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./matrix_algebra.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Matrix algebra</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Math 351 @ UD
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Toby Driscoll
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>